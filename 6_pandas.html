<!DOCTYPE html>
<html lang="en"><head>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="6_pandas_files/libs/clipboard/clipboard.min.js"></script>
<script src="6_pandas_files/libs/quarto-html/tabby.min.js"></script>
<script src="6_pandas_files/libs/quarto-html/popper.min.js"></script>
<script src="6_pandas_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="6_pandas_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="6_pandas_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href="6_pandas_files/libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="6_pandas_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.5.57">

  <meta name="author" content="Yi-Ju Tseng">
  <title>6. Pandas</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="6_pandas_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="6_pandas_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; font-weight: bold; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="6_pandas_files/libs/revealjs/dist/theme/quarto.css">
  <link href="6_pandas_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="6_pandas_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="6_pandas_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="6_pandas_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    padding-bottom: 0.5rem;
    margin-bottom: 0;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
  
  <script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">6. Pandas</h1>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Yi-Ju Tseng 
</div>
</div>
</div>

</section>
<section id="pandas" class="slide level2">
<h2>Pandas</h2>
<ul>
<li>Introduction to Pandas Objects</li>
<li>Data Indexing and Selection in Pandas</li>
<li>Operations in Pandas</li>
<li>Handling Missing Data in Pandas</li>
<li>Hierarchical Indexing in Pandas</li>
<li>Combining Datasets: Concat and Append</li>
<li>Combining Datasets: Merge and Join</li>
<li>Aggregation and Grouping in Pandas</li>
<li>Working with Time Series in Pandas</li>
</ul>
</section>
<section>
<section id="introduction-to-pandas-objects" class="title-slide slide level1 center">
<h1>Introduction to Pandas Objects</h1>

</section>
<section id="introduction-to-pandas-objects-1" class="slide level2">
<h2>Introduction to Pandas Objects</h2>
<ul>
<li>Pandas objects are enhanced versions of NumPy arrays
<ul>
<li>we need more flexibility (e.g., attaching labels to data, working with missing data, etc.)</li>
</ul></li>
<li>Rows and columns identified with <strong>labels</strong> instead of integer indices</li>
<li>Three fundamental data structures:
<ul>
<li>Series</li>
<li>DataFrame</li>
<li>Index</li>
</ul></li>
</ul>
</section>
<section id="pandas-getting-started" class="slide level2">
<h2>Pandas Getting Started</h2>
<p>Install</p>
<div id="f53205ea" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href=""></a><span class="op">!</span>pip3 install numpy pandas <span class="co"># ! for shell script</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Import</p>
<div id="2e1535d6" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href=""></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb2-2"><a href=""></a><span class="im">import</span> pandas <span class="im">as</span> pd</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="the-pandas-series-object" class="slide level2">
<h2>The Pandas Series Object</h2>
<ul>
<li>One-dimensional array of indexed data</li>
<li>Wraps both values and indices</li>
<li><code>pd.Series(np 1D array or list)</code>
<ul>
<li>From list (default integer index)</li>
<li>With custom index</li>
<li>From dictionary</li>
</ul></li>
</ul>
<div id="4765743c" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href=""></a>data <span class="op">=</span> pd.Series([<span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>, <span class="fl">1.0</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="series-data-access" class="slide level2">
<h2>Series: Data Access</h2>
<div id="e2cb4201" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href=""></a>data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="3">
<pre><code>0    0.25
1    0.50
2    0.75
3    1.00
dtype: float64</code></pre>
</div>
</div>
<ul>
<li>Position (index)</li>
<li>Slicing</li>
</ul>
<div id="818c04ab" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href=""></a><span class="co"># Access by position</span></span>
<span id="cb6-2"><a href=""></a>data[<span class="dv">1</span>] </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">
<pre><code>0.5</code></pre>
</div>
</div>
<div id="576a9c6d" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href=""></a><span class="co"># Slicing works too</span></span>
<span id="cb8-2"><a href=""></a>data[<span class="dv">1</span>:<span class="dv">3</span>]    </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<pre><code>1    0.50
2    0.75
dtype: float64</code></pre>
</div>
</div>
</section>
<section id="series-flexible-indices" class="slide level2">
<h2>Series: Flexible Indices</h2>
<ul>
<li>Pandas Series has an <strong>defined index</strong> associated with the values</li>
<li>Can use strings or other types</li>
</ul>
<div id="d4a4ad08" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href=""></a>data <span class="op">=</span> pd.Series([<span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>, <span class="fl">1.0</span>],</span>
<span id="cb10-2"><a href=""></a>                 index<span class="op">=</span>[<span class="st">'a'</span>, <span class="st">'b'</span>, <span class="st">'c'</span>, <span class="st">'d'</span>])</span>
<span id="cb10-3"><a href=""></a><span class="bu">print</span>(data)</span>
<span id="cb10-4"><a href=""></a>data[<span class="st">'b'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>a    0.25
b    0.50
c    0.75
d    1.00
dtype: float64</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="6">
<pre><code>0.5</code></pre>
</div>
</div>
</section>
<section id="series-as-specialized-dictionary" class="slide level2">
<h2>Series as Specialized Dictionary</h2>
<ul>
<li><strong>keys</strong>: index</li>
<li><strong>values</strong>: values</li>
</ul>
<div id="b44feffa" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href=""></a>population_dict <span class="op">=</span> {<span class="st">'California'</span>: <span class="dv">38332521</span>,</span>
<span id="cb13-2"><a href=""></a>                   <span class="st">'Texas'</span>: <span class="dv">26448193</span>,</span>
<span id="cb13-3"><a href=""></a>                   <span class="st">'New York'</span>: <span class="dv">19651127</span>,</span>
<span id="cb13-4"><a href=""></a>                   <span class="st">'Florida'</span>: <span class="dv">19552860</span>,</span>
<span id="cb13-5"><a href=""></a>                   <span class="st">'Illinois'</span>: <span class="dv">12882135</span>}</span>
<span id="cb13-6"><a href=""></a>population <span class="op">=</span> pd.Series(population_dict)</span>
<span id="cb13-7"><a href=""></a><span class="bu">print</span>(population)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>California    38332521
Texas         26448193
New York      19651127
Florida       19552860
Illinois      12882135
dtype: int64</code></pre>
</div>
</div>
</section>
<section id="series-dictionary-like-operations" class="slide level2">
<h2>Series: Dictionary-like Operations</h2>
<div id="33675e7a" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href=""></a>population</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="8">
<pre><code>California    38332521
Texas         26448193
New York      19651127
Florida       19552860
Illinois      12882135
dtype: int64</code></pre>
</div>
</div>
<p>Index (Dictionary-style access)</p>
<div id="5a4373f9" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href=""></a>population[<span class="st">'California'</span>] </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="9">
<pre><code>38332521</code></pre>
</div>
</div>
<p>Slicing! (Array-style operations) <strong>Includes the end point</strong></p>
<div id="3703de10" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href=""></a>population[<span class="st">'California'</span>:<span class="st">'New York'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="10">
<pre><code>California    38332521
Texas         26448193
New York      19651127
dtype: int64</code></pre>
</div>
</div>
</section>
<section id="hands-on---series" class="slide level2">
<h2>Hands-on - Series</h2>
<ul>
<li>Create a Series containing the following student scores (out of 100): 85, 92, 78, 90, 88, and use student names as the index: ‘Alice’, ‘Bob’, ‘Charlie’, ‘David’, ‘Emma’.</li>
<li>Series Operations
<ul>
<li>Find Bob’s score</li>
<li>Find the average score</li>
<li>Find all scores above 85 (<code>Hint</code>: Boolean)</li>
<li>Add 5 points to everyone’s score (<code>Hint</code>: +)</li>
</ul></li>
</ul>
</section>
<section id="the-pandas-dataframe-object" class="slide level2">
<h2>The Pandas DataFrame Object</h2>
<ul>
<li>Two-dimensional data structure
<ul>
<li>with both flexible <strong>row indices</strong> and flexible <strong>column names</strong></li>
</ul></li>
<li>Can be viewed as:
<ul>
<li>Generalized NumPy array</li>
<li>Specialization of Python dictionary</li>
<li>Collection of aligned Series objects</li>
</ul></li>
</ul>
</section>
<section id="dataframe-construction-methods" class="slide level2">
<h2>DataFrame Construction Methods</h2>
<ul>
<li>From a single Series</li>
<li>From a two-dimensional NumPy array</li>
<li>From a dictionary of Series</li>
</ul>
</section>
<section id="dataframe-from-a-single-series" class="slide level2">
<h2>DataFrame: From a Single Series</h2>
<div id="d86a225a" class="cell" data-execution_count="12">
<div class="cell-output cell-output-display" data-execution_count="11">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe caption-top" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header" style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">population</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">California</td>
<td>38332521</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Texas</td>
<td>26448193</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">New York</td>
<td>19651127</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Florida</td>
<td>19552860</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Illinois</td>
<td>12882135</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="dataframe-from-2d-numpy-array" class="slide level2">
<h2>DataFrame: From 2D NumPy Array</h2>
<div id="ad5267fe" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href=""></a>np.random.rand(<span class="dv">3</span>, <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="12">
<pre><code>array([[0.61801271, 0.72444333],
       [0.39797587, 0.64161013],
       [0.73428409, 0.60717593]])</code></pre>
</div>
</div>
<div id="d6173819" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href=""></a>pd.DataFrame(np.random.rand(<span class="dv">3</span>, <span class="dv">2</span>),</span>
<span id="cb23-2"><a href=""></a>             columns<span class="op">=</span>[<span class="st">'foo'</span>, <span class="st">'bar'</span>],</span>
<span id="cb23-3"><a href=""></a>             index<span class="op">=</span>[<span class="st">'a'</span>, <span class="st">'b'</span>, <span class="st">'c'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="13">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe caption-top" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header" style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">foo</th>
<th data-quarto-table-cell-role="th">bar</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">a</td>
<td>0.565221</td>
<td>0.919234</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">b</td>
<td>0.462501</td>
<td>0.232900</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">c</td>
<td>0.462508</td>
<td>0.794315</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="dataframe-from-a-dictionary-of-series" class="slide level2">
<h2>DataFrame: From a Dictionary of Series</h2>
<div id="cbd982b8" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href=""></a><span class="co"># Create area Series</span></span>
<span id="cb24-2"><a href=""></a>area_dict <span class="op">=</span> {<span class="st">'California'</span>: <span class="dv">423967</span>, <span class="st">'Texas'</span>: <span class="dv">695662</span>, </span>
<span id="cb24-3"><a href=""></a>             <span class="st">'New York'</span>: <span class="dv">141297</span>, <span class="st">'Florida'</span>: <span class="dv">170312</span>, </span>
<span id="cb24-4"><a href=""></a>             <span class="st">'Illinois'</span>: <span class="dv">149995</span>}</span>
<span id="cb24-5"><a href=""></a>area <span class="op">=</span> pd.Series(area_dict)</span>
<span id="cb24-6"><a href=""></a><span class="co"># Combine with population Series</span></span>
<span id="cb24-7"><a href=""></a>states <span class="op">=</span> pd.DataFrame({<span class="st">'population'</span>: population,</span>
<span id="cb24-8"><a href=""></a>                       <span class="st">'area'</span>: area})</span>
<span id="cb24-9"><a href=""></a><span class="bu">print</span>(states)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            population    area
California    38332521  423967
Texas         26448193  695662
New York      19651127  141297
Florida       19552860  170312
Illinois      12882135  149995</code></pre>
</div>
</div>
</section>
<section id="dataframe-structure" class="slide level2">
<h2>DataFrame: Structure</h2>
<p>Access index (row labels)</p>
<div id="3ddc7f89" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href=""></a><span class="bu">print</span>(states.index)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Index(['California', 'Texas', 'New York', 'Florida', 'Illinois'], dtype='object')</code></pre>
</div>
</div>
<p>Access columns</p>
<div id="7af23bb7" class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href=""></a><span class="bu">print</span>(states.columns)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Index(['population', 'area'], dtype='object')</code></pre>
</div>
</div>
</section>
<section id="dataframe-as-dictionary-of-series" class="slide level2">
<h2>DataFrame as Dictionary of Series</h2>
<p>Access a column values (returns a Series) with <code>column name</code> and <code>[]</code></p>
<div id="0568c6c2" class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href=""></a>states[<span class="st">'area'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="17">
<pre><code>California    423967
Texas         695662
New York      141297
Florida       170312
Illinois      149995
Name: area, dtype: int64</code></pre>
</div>
</div>
</section>
<section id="the-pandas-index-object" class="slide level2">
<h2>The Pandas Index Object</h2>
<ul>
<li>Used by both Series and DataFrame</li>
<li>Can be viewed as:
<ul>
<li>Immutable array</li>
<li>Ordered set</li>
</ul></li>
</ul>
<div id="12e341d7" class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href=""></a>ind <span class="op">=</span> pd.Index([<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">11</span>])</span>
<span id="cb32-2"><a href=""></a><span class="bu">print</span>(ind)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Index([2, 3, 5, 7, 11], dtype='int64')</code></pre>
</div>
</div>
</section>
<section id="summary" class="slide level2">
<h2>Summary</h2>
<ul>
<li><strong>Series</strong>: 1D array with labeled index</li>
<li><strong>DataFrame</strong>: 2D table with labeled rows and columns</li>
<li><strong>Index</strong>: Immutable array-like structure for labeling</li>
</ul>
</section>
<section id="hands-on---dataframe" class="slide level2">
<h2>Hands-on - DataFrame</h2>
<p>You have information about countries stored in dictionaries. Convert this to a DataFrame <code>countries_df</code>.</p>
<div id="3ac0cd26" class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href=""></a><span class="co"># Midyear Population</span></span>
<span id="cb34-2"><a href=""></a>population_dict <span class="op">=</span> {</span>
<span id="cb34-3"><a href=""></a>    <span class="st">'USA'</span>: <span class="dv">331002651</span>,</span>
<span id="cb34-4"><a href=""></a>    <span class="st">'China'</span>: <span class="dv">1439323776</span>,</span>
<span id="cb34-5"><a href=""></a>    <span class="st">'India'</span>: <span class="dv">1380004385</span>,</span>
<span id="cb34-6"><a href=""></a>    <span class="st">'Brazil'</span>: <span class="dv">212559417</span>,</span>
<span id="cb34-7"><a href=""></a>    <span class="st">'Japan'</span>: <span class="dv">126476461</span></span>
<span id="cb34-8"><a href=""></a>}</span>
<span id="cb34-9"><a href=""></a><span class="co"># Area (square km)</span></span>
<span id="cb34-10"><a href=""></a>area_dict <span class="op">=</span> {</span>
<span id="cb34-11"><a href=""></a>    <span class="st">'USA'</span>: <span class="dv">9833517</span>,</span>
<span id="cb34-12"><a href=""></a>    <span class="st">'China'</span>: <span class="dv">9596960</span>,</span>
<span id="cb34-13"><a href=""></a>    <span class="st">'India'</span>: <span class="dv">3287263</span>,</span>
<span id="cb34-14"><a href=""></a>    <span class="st">'Brazil'</span>: <span class="dv">8515767</span>,</span>
<span id="cb34-15"><a href=""></a>    <span class="st">'Japan'</span>: <span class="dv">377975</span></span>
<span id="cb34-16"><a href=""></a>}</span>
<span id="cb34-17"><a href=""></a><span class="co">#GDP</span></span>
<span id="cb34-18"><a href=""></a>gdp_dict <span class="op">=</span> {</span>
<span id="cb34-19"><a href=""></a>    <span class="st">'USA'</span>: <span class="dv">21433225</span>,</span>
<span id="cb34-20"><a href=""></a>    <span class="st">'China'</span>: <span class="dv">14342903</span>,</span>
<span id="cb34-21"><a href=""></a>    <span class="st">'India'</span>: <span class="dv">2875142</span>,</span>
<span id="cb34-22"><a href=""></a>    <span class="st">'Brazil'</span>: <span class="dv">1839758</span>,</span>
<span id="cb34-23"><a href=""></a>    <span class="st">'Japan'</span>: <span class="dv">5081770</span></span>
<span id="cb34-24"><a href=""></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="hands-on---dataframe-1" class="slide level2">
<h2>Hands-on - DataFrame</h2>
<ul>
<li>Add the following columns to the <code>countries_df</code> (<code>Hint</code>: like numpy 2D array):
<ul>
<li>Population density (population per square km)</li>
<li>GDP per capita (gross domestic product divided by midyear population)</li>
</ul></li>
</ul>
</section></section>
<section>
<section id="data-indexing-and-selection-in-pandas" class="title-slide slide level1 center">
<h1>Data Indexing and Selection in Pandas</h1>

</section>
<section id="series-indexing---12" class="slide level2">
<h2>Series Indexing - 1/2</h2>
<div id="ae65854d" class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href=""></a>data <span class="op">=</span> pd.Series([<span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>, <span class="fl">1.0</span>],</span>
<span id="cb35-2"><a href=""></a>                 index<span class="op">=</span>[<span class="st">'a'</span>, <span class="st">'b'</span>, <span class="st">'c'</span>, <span class="st">'d'</span>])</span>
<span id="cb35-3"><a href=""></a><span class="bu">print</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>a    0.25
b    0.50
c    0.75
d    1.00
dtype: float64</code></pre>
</div>
</div>
<p><strong>Dictionary-style indexing</strong>: Access values by index (labels)</p>
<div id="e44b188a" class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href=""></a>data[<span class="st">'b'</span>]  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="21">
<pre><code>0.5</code></pre>
</div>
</div>
<p><strong>Attribute-style access</strong>: For string index (labels)</p>
<div id="964b83ee" class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href=""></a>data.b  <span class="co"># Same as data['b']</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="22">
<pre><code>0.5</code></pre>
</div>
</div>
</section>
<section id="series-indexing---22" class="slide level2">
<h2>Series Indexing - 2/2</h2>
<p><strong>Slicing with explicit index</strong>: Includes the end point</p>
<div id="5fb8b7d2" class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href=""></a>data[<span class="st">'a'</span>:<span class="st">'c'</span>]  <span class="co"># Includes 'a', 'b', 'c'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="23">
<pre><code>a    0.25
b    0.50
c    0.75
dtype: float64</code></pre>
</div>
</div>
<p><strong>Slicing with implicit integer index</strong>: Excludes the end point</p>
<div id="e275d168" class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href=""></a>data[<span class="dv">0</span>:<span class="dv">2</span>]  <span class="co"># Includes indices 0, 1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="24">
<pre><code>a    0.25
b    0.50
dtype: float64</code></pre>
</div>
</div>
</section>
<section id="boolean-masking" class="slide level2">
<h2>Boolean masking</h2>
<p><strong>Boolean masking</strong>: Filter based on conditions</p>
<div id="247bd32c" class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href=""></a>data[(data <span class="op">&gt;</span> <span class="fl">0.3</span>) <span class="op">&amp;</span> (data <span class="op">&lt;</span> <span class="fl">0.8</span>)]   </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="25">
<pre><code>b    0.50
c    0.75
dtype: float64</code></pre>
</div>
</div>
</section>
<section id="special-indexers---loc" class="slide level2">
<h2>Special Indexers - loc</h2>
<p>Pandas provides special indexers to avoid confusion with integer indices: - <strong>loc</strong>: <strong>Label-based</strong> indexing - <strong>iloc</strong>: Integer-based indexing</p>
<div id="545979a9" class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href=""></a>data_int_index <span class="op">=</span> pd.Series([<span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>, <span class="fl">1.0</span>],</span>
<span id="cb47-2"><a href=""></a>                 index<span class="op">=</span>[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>]) <span class="co">## a bit confusing</span></span>
<span id="cb47-3"><a href=""></a><span class="bu">print</span>(data_int_index)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1    0.25
2    0.50
3    0.75
4    1.00
dtype: float64</code></pre>
</div>
</div>
<p><strong>loc</strong>: <strong>Label-based</strong> indexing</p>
<div id="5d14416b" class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href=""></a>data_int_index.loc[<span class="dv">1</span>]  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="27">
<pre><code>0.25</code></pre>
</div>
</div>
</section>
<section id="special-indexers---iloc" class="slide level2">
<h2>Special Indexers - iloc</h2>
<div id="8adab755" class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href=""></a><span class="bu">print</span>(data_int_index)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1    0.25
2    0.50
3    0.75
4    1.00
dtype: float64</code></pre>
</div>
</div>
<p><strong>iloc</strong>: <strong>Integer</strong>-based indexing</p>
<div id="b09019f3" class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href=""></a>data_int_index.iloc[<span class="dv">1</span>]  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="29">
<pre><code>0.5</code></pre>
</div>
</div>
</section>
<section id="dataframe-indexing" class="slide level2">
<h2>DataFrame Indexing</h2>
<div id="8621678e" class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb55-1"><a href=""></a>area <span class="op">=</span> pd.Series({<span class="st">'California'</span>: <span class="dv">423967</span>, <span class="st">'Texas'</span>: <span class="dv">695662</span>,</span>
<span id="cb55-2"><a href=""></a>                  <span class="st">'New York'</span>: <span class="dv">141297</span>, <span class="st">'Florida'</span>: <span class="dv">170312</span>,</span>
<span id="cb55-3"><a href=""></a>                  <span class="st">'Illinois'</span>: <span class="dv">149995</span>})</span>
<span id="cb55-4"><a href=""></a>pop <span class="op">=</span> pd.Series({<span class="st">'California'</span>: <span class="dv">38332521</span>, <span class="st">'Texas'</span>: <span class="dv">26448193</span>,</span>
<span id="cb55-5"><a href=""></a>                 <span class="st">'New York'</span>: <span class="dv">19651127</span>, <span class="st">'Florida'</span>: <span class="dv">19552860</span>,</span>
<span id="cb55-6"><a href=""></a>                 <span class="st">'Illinois'</span>: <span class="dv">12882135</span>})</span>
<span id="cb55-7"><a href=""></a>df <span class="op">=</span> pd.DataFrame({<span class="st">'area'</span>:area, <span class="st">'pop'</span>:pop})</span>
<span id="cb55-8"><a href=""></a><span class="bu">print</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              area       pop
California  423967  38332521
Texas       695662  26448193
New York    141297  19651127
Florida     170312  19552860
Illinois    149995  12882135</code></pre>
</div>
</div>
</section>
<section id="dataframe-access" class="slide level2">
<h2>DataFrame Access</h2>
<div id="14cc39b4" class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href=""></a><span class="bu">print</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              area       pop
California  423967  38332521
Texas       695662  26448193
New York    141297  19651127
Florida     170312  19552860
Illinois    149995  12882135</code></pre>
</div>
</div>
<p><strong>Column access</strong></p>
<div id="70ea33ab" class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb59-1"><a href=""></a>df[<span class="st">'area'</span>]  <span class="co"># Dictionary-style</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="32">
<pre><code>California    423967
Texas         695662
New York      141297
Florida       170312
Illinois      149995
Name: area, dtype: int64</code></pre>
</div>
</div>
<div id="7b587565" class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb61-1"><a href=""></a>df.area     <span class="co"># Attribute-style</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="33">
<pre><code>California    423967
Texas         695662
New York      141297
Florida       170312
Illinois      149995
Name: area, dtype: int64</code></pre>
</div>
</div>
</section>
<section id="dataframe-access-1" class="slide level2">
<h2>DataFrame Access</h2>
<div id="523a434c" class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb63-1"><a href=""></a><span class="bu">print</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              area       pop
California  423967  38332521
Texas       695662  26448193
New York    141297  19651127
Florida     170312  19552860
Illinois    149995  12882135</code></pre>
</div>
</div>
<p><strong>Adding new columns</strong></p>
<div id="e60ddc8f" class="cell" data-execution_count="36">
<div class="cell-output cell-output-stdout">
<pre><code>              area       pop     density
California  423967  38332521   90.413926
Texas       695662  26448193   38.018740
New York    141297  19651127  139.076746
Florida     170312  19552860  114.806121
Illinois    149995  12882135   85.883763</code></pre>
</div>
</div>
</section>
<section id="special-indexers" class="slide level2">
<h2>Special Indexers</h2>
<div id="a123ba08" class="cell" data-execution_count="37">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb66-1"><a href=""></a><span class="bu">print</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              area       pop     density
California  423967  38332521   90.413926
Texas       695662  26448193   38.018740
New York    141297  19651127  139.076746
Florida     170312  19552860  114.806121
Illinois    149995  12882135   85.883763</code></pre>
</div>
</div>
<p><strong>loc</strong>: Label-based indexing</p>
<div id="71fb2749" class="cell" data-execution_count="38">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb68-1"><a href=""></a><span class="bu">print</span>(df.loc[:<span class="st">'Illinois'</span>,:<span class="st">'pop'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              area       pop
California  423967  38332521
Texas       695662  26448193
New York    141297  19651127
Florida     170312  19552860
Illinois    149995  12882135</code></pre>
</div>
</div>
<p><strong>iloc</strong>: Integer-based indexing</p>
<div id="74edfefd" class="cell" data-execution_count="39">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb70-1"><a href=""></a><span class="bu">print</span>(df.iloc[:<span class="dv">3</span>, :<span class="dv">2</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              area       pop
California  423967  38332521
Texas       695662  26448193
New York    141297  19651127</code></pre>
</div>
</div>
</section>
<section id="additional-indexing-conventions" class="slide level2">
<h2>Additional Indexing Conventions</h2>
<div id="0ff9b356" class="cell" data-execution_count="40">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb72-1"><a href=""></a><span class="bu">print</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              area       pop     density
California  423967  38332521   90.413926
Texas       695662  26448193   38.018740
New York    141297  19651127  139.076746
Florida     170312  19552860  114.806121
Illinois    149995  12882135   85.883763</code></pre>
</div>
</div>
<p>Slicing refers to rows when used directly on a DataFrame:</p>
<div id="a32262e0" class="cell" data-execution_count="41">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb74-1"><a href=""></a><span class="co"># Selects rows with these index (labels)</span></span>
<span id="cb74-2"><a href=""></a><span class="bu">print</span>(df[<span class="st">'Florida'</span>:<span class="st">'Illinois'</span>]  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            area       pop     density
Florida   170312  19552860  114.806121
Illinois  149995  12882135   85.883763</code></pre>
</div>
</div>
<div id="9290b066" class="cell" data-execution_count="42">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb76-1"><a href=""></a><span class="co"># Selects rows by position</span></span>
<span id="cb76-2"><a href=""></a><span class="bu">print</span>(df[<span class="dv">1</span>:<span class="dv">3</span>])                </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            area       pop     density
Texas     695662  26448193   38.018740
New York  141297  19651127  139.076746</code></pre>
</div>
</div>
</section>
<section id="masking" class="slide level2">
<h2>Masking</h2>
<div id="cc422c8c" class="cell" data-execution_count="43">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb78-1"><a href=""></a><span class="bu">print</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              area       pop     density
California  423967  38332521   90.413926
Texas       695662  26448193   38.018740
New York    141297  19651127  139.076746
Florida     170312  19552860  114.806121
Illinois    149995  12882135   85.883763</code></pre>
</div>
</div>
<p>Direct masking is row-wise:</p>
<div id="6090243c" class="cell" data-execution_count="44">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb80-1"><a href=""></a><span class="co"># Selects rows where density &gt; 100</span></span>
<span id="cb80-2"><a href=""></a><span class="bu">print</span>(df[df.density <span class="op">&gt;</span> <span class="dv">100</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            area       pop     density
New York  141297  19651127  139.076746
Florida   170312  19552860  114.806121</code></pre>
</div>
</div>
</section>
<section id="hands-on---index-and-slicing" class="slide level2">
<h2>Hands-on - Index and Slicing</h2>
<div id="954276e1" class="cell" data-execution_count="45">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb82-1"><a href=""></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb82-2"><a href=""></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb82-3"><a href=""></a><span class="co"># Create Series for COVID-19 metrics</span></span>
<span id="cb82-4"><a href=""></a>cases <span class="op">=</span> pd.Series({<span class="st">'United States'</span>: <span class="fl">98.2</span>, <span class="st">'India'</span>: <span class="fl">44.7</span>, <span class="st">'Brazil'</span>: <span class="fl">37.6</span>,<span class="st">'France'</span>: <span class="fl">35.4</span>, <span class="st">'Germany'</span>: <span class="fl">30.2</span>})</span>
<span id="cb82-5"><a href=""></a>deaths <span class="op">=</span> pd.Series({<span class="st">'United States'</span>: <span class="fl">1.1</span>, <span class="st">'India'</span>: <span class="fl">0.53</span>, <span class="st">'Brazil'</span>: <span class="fl">0.69</span>,<span class="st">'France'</span>: <span class="fl">0.16</span>, <span class="st">'Germany'</span>: <span class="fl">0.17</span>})</span>
<span id="cb82-6"><a href=""></a>population <span class="op">=</span> pd.Series({<span class="st">'United States'</span>: <span class="fl">331.9</span>, <span class="st">'India'</span>: <span class="fl">1393.4</span>, <span class="st">'Brazil'</span>: <span class="fl">214.3</span>, <span class="st">'France'</span>: <span class="fl">67.8</span>, <span class="st">'Germany'</span>: <span class="fl">83.2</span>})</span>
<span id="cb82-7"><a href=""></a><span class="co"># Create DataFrame</span></span>
<span id="cb82-8"><a href=""></a>covid_df <span class="op">=</span> pd.DataFrame({<span class="st">'cases_millions'</span>: cases, </span>
<span id="cb82-9"><a href=""></a>                         <span class="st">'deaths_millions'</span>: deaths, </span>
<span id="cb82-10"><a href=""></a>                         <span class="st">'population_millions'</span>: population})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="hands-on---index-and-slicing-1" class="slide level2">
<h2>Hands-on - Index and Slicing</h2>
<div id="c8feceab" class="cell" data-execution_count="46">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb83-1"><a href=""></a><span class="bu">print</span>(<span class="st">"COVID-19 Statistics by Country:"</span>)</span>
<span id="cb83-2"><a href=""></a>covid_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>COVID-19 Statistics by Country:</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="45">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe caption-top" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header" style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">cases_millions</th>
<th data-quarto-table-cell-role="th">deaths_millions</th>
<th data-quarto-table-cell-role="th">population_millions</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">United States</td>
<td>98.2</td>
<td>1.10</td>
<td>331.9</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">India</td>
<td>44.7</td>
<td>0.53</td>
<td>1393.4</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Brazil</td>
<td>37.6</td>
<td>0.69</td>
<td>214.3</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">France</td>
<td>35.4</td>
<td>0.16</td>
<td>67.8</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Germany</td>
<td>30.2</td>
<td>0.17</td>
<td>83.2</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="hands-on---index-and-slicing-2" class="slide level2">
<h2>Hands-on - Index and Slicing</h2>
<ul>
<li>Access the number of cases in Brazil</li>
<li>Add a new column ‘case_fatality_rate’ calculated as <strong>deaths divided by cases (as a percentage)</strong></li>
<li>Use <code>loc</code> to select data for Brazil and France, showing only cases and deaths</li>
<li>Use <code>iloc</code> to select the first 3 countries and all columns</li>
<li>Select countries with <strong>case fatality rate greater than 1.5%</strong></li>
</ul>
</section></section>
<section>
<section id="operations-in-pandas" class="title-slide slide level1 center">
<h1>Operations in Pandas</h1>

</section>
<section id="universal-functions-index-preservation" class="slide level2">
<h2>Universal Functions: Index Preservation</h2>
<p>Pandas inherits NumPy’s ability to perform <strong>quick element-wise operations</strong> while adding two key features:</p>
<ul>
<li><strong>Index and column label preservation</strong> for unary operations</li>
<li><strong>Automatic index alignment</strong> for binary operations</li>
</ul>
</section>
<section id="universal-functions-index-preservation-1" class="slide level2">
<h2>Universal Functions: Index Preservation</h2>
<p>The indices are preserved</p>
<div id="5ca8c213" class="cell" data-execution_count="47">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb85-1"><a href=""></a>rng <span class="op">=</span> np.random.RandomState(<span class="dv">0</span>)</span>
<span id="cb85-2"><a href=""></a>df <span class="op">=</span> pd.DataFrame(rng.randint(<span class="dv">0</span>, <span class="dv">10</span>, (<span class="dv">3</span>, <span class="dv">4</span>)),</span>
<span id="cb85-3"><a href=""></a>                 columns<span class="op">=</span>[<span class="st">'A'</span>, <span class="st">'B'</span>, <span class="st">'C'</span>, <span class="st">'D'</span>])</span>
<span id="cb85-4"><a href=""></a><span class="bu">print</span>(df)                </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   A  B  C  D
0  5  0  3  3
1  7  9  3  5
2  2  4  7  6</code></pre>
</div>
</div>
<div id="7becb875" class="cell" data-execution_count="48">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb87-1"><a href=""></a><span class="bu">print</span>(np.sin(df <span class="op">*</span> np.pi <span class="op">/</span> <span class="dv">4</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          A             B         C         D
0 -0.707107  0.000000e+00  0.707107  0.707107
1 -0.707107  7.071068e-01  0.707107 -0.707107
2  1.000000  1.224647e-16 -0.707107 -1.000000</code></pre>
</div>
</div>
</section>
<section id="index-alignment-in-operations" class="slide level2">
<h2>Index Alignment in Operations</h2>
<p>When operating on two Series, Pandas automatically <strong>aligns indices</strong>.</p>
<div id="4a7271ea" class="cell" data-execution_count="49">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb89-1"><a href=""></a>area <span class="op">=</span> pd.Series({<span class="st">'Alaska'</span>: <span class="dv">1723337</span>, <span class="st">'Texas'</span>: <span class="dv">695662</span>,<span class="st">'California'</span>: <span class="dv">423967</span>}, name<span class="op">=</span><span class="st">'area'</span>)</span>
<span id="cb89-2"><a href=""></a>population <span class="op">=</span> pd.Series({<span class="st">'California'</span>: <span class="dv">38332521</span>, <span class="st">'Texas'</span>: <span class="dv">26448193</span>, <span class="st">'New York'</span>: <span class="dv">19651127</span>}, name<span class="op">=</span><span class="st">'population'</span>)</span>
<span id="cb89-3"><a href=""></a></span>
<span id="cb89-4"><a href=""></a><span class="bu">print</span>(population)</span>
<span id="cb89-5"><a href=""></a><span class="bu">print</span>(area)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>California    38332521
Texas         26448193
New York      19651127
Name: population, dtype: int64
Alaska        1723337
Texas          695662
California     423967
Name: area, dtype: int64</code></pre>
</div>
</div>
</section>
<section id="index-alignment-in-operations-1" class="slide level2">
<h2>Index Alignment in Operations</h2>
<p>Default behavior produces NaN for missing indices</p>
<div id="0a475e27" class="cell" data-execution_count="50">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb91-1"><a href=""></a>population <span class="op">/</span> area</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="49">
<pre><code>Alaska              NaN
California    90.413926
New York            NaN
Texas         38.018740
dtype: float64</code></pre>
</div>
</div>
<p>Using <code>div()</code> method with <code>fill_value</code></p>
<div id="8110406b" class="cell" data-execution_count="51">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb93-1"><a href=""></a>population.div(area, fill_value<span class="op">=</span><span class="dv">1</span>) <span class="co">## just for demo</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="50">
<pre><code>Alaska        5.802696e-07
California    9.041393e+01
New York      1.965113e+07
Texas         3.801874e+01
dtype: float64</code></pre>
</div>
</div>
</section>
<section id="dataframe-alignment" class="slide level2">
<h2>DataFrame Alignment</h2>
<p>For DataFrames, alignment happens on both rows and columns.</p>
<div id="e4a248c4" class="cell" data-execution_count="52">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb95-1"><a href=""></a>A <span class="op">=</span> pd.DataFrame(np.random.randint(<span class="dv">0</span>, <span class="dv">20</span>, (<span class="dv">2</span>, <span class="dv">2</span>)),</span>
<span id="cb95-2"><a href=""></a>                columns<span class="op">=</span><span class="bu">list</span>(<span class="st">'AB'</span>))</span>
<span id="cb95-3"><a href=""></a><span class="bu">print</span>(A)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    A   B
0  15  11
1  12  11</code></pre>
</div>
</div>
<div id="1cf6866b" class="cell" data-execution_count="53">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb97-1"><a href=""></a>B <span class="op">=</span> pd.DataFrame(np.random.randint(<span class="dv">0</span>, <span class="dv">10</span>, (<span class="dv">3</span>, <span class="dv">3</span>)),</span>
<span id="cb97-2"><a href=""></a>                columns<span class="op">=</span><span class="bu">list</span>(<span class="st">'BAC'</span>))</span>
<span id="cb97-3"><a href=""></a><span class="bu">print</span>(B)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   B  A  C
0  7  9  9
1  1  2  4
2  0  1  3</code></pre>
</div>
</div>
</section>
<section id="dataframe-alignment-1" class="slide level2">
<h2>DataFrame Alignment</h2>
<p>Addition with automatic alignment</p>
<div id="00a6ce80" class="cell" data-execution_count="54">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb99-1"><a href=""></a><span class="bu">print</span>(A <span class="op">+</span> B)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      A     B   C
0  24.0  18.0 NaN
1  14.0  12.0 NaN
2   NaN   NaN NaN</code></pre>
</div>
</div>
<p>Fill values can be specified for missing entries.</p>
<div id="f91e5c6d" class="cell" data-execution_count="55">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb101-1"><a href=""></a><span class="bu">print</span>(A.add(B, fill_value<span class="op">=</span><span class="dv">0</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      A     B    C
0  24.0  18.0  9.0
1  14.0  12.0  4.0
2   1.0   0.0  3.0</code></pre>
</div>
</div>
</section>
<section id="pandas-method-equivalents" class="slide level2">
<h2>Pandas Method Equivalents</h2>
<table class="caption-top">
<thead>
<tr class="header">
<th>Python Operator</th>
<th>Pandas Method(s)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>+</code></td>
<td><code>add()</code></td>
</tr>
<tr class="even">
<td><code>-</code></td>
<td><code>sub()</code>, <code>subtract()</code></td>
</tr>
<tr class="odd">
<td><code>*</code></td>
<td><code>mul()</code>, <code>multiply()</code></td>
</tr>
<tr class="even">
<td><code>/</code></td>
<td><code>truediv()</code>, <code>div()</code>, <code>divide()</code></td>
</tr>
<tr class="odd">
<td><code>//</code></td>
<td><code>floordiv()</code></td>
</tr>
<tr class="even">
<td><code>%</code></td>
<td><code>mod()</code></td>
</tr>
<tr class="odd">
<td><code>**</code></td>
<td><code>pow()</code></td>
</tr>
</tbody>
</table>
</section>
<section id="hands-on---ufunc" class="slide level2">
<h2>Hands-on - UFunc</h2>
<div id="e4046a4f" class="cell" data-execution_count="56">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb103-1"><a href=""></a><span class="co"># Create a DataFrame with COVID-19 data for the last 5 days</span></span>
<span id="cb103-2"><a href=""></a>dates <span class="op">=</span> pd.date_range(end<span class="op">=</span><span class="st">'2023-04-30'</span>, periods<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb103-3"><a href=""></a>data <span class="op">=</span> {</span>
<span id="cb103-4"><a href=""></a>    <span class="st">'United States'</span>: [<span class="dv">45000</span>, <span class="dv">42000</span>, <span class="dv">38000</span>, <span class="dv">41000</span>, <span class="dv">39000</span>],</span>
<span id="cb103-5"><a href=""></a>    <span class="st">'India'</span>: [<span class="dv">12000</span>, <span class="dv">13500</span>, <span class="dv">14200</span>, <span class="dv">13800</span>, <span class="dv">12500</span>],</span>
<span id="cb103-6"><a href=""></a>    <span class="st">'Brazil'</span>: [<span class="dv">9800</span>, <span class="dv">9200</span>, <span class="dv">8700</span>, <span class="dv">9100</span>, <span class="dv">9500</span>],</span>
<span id="cb103-7"><a href=""></a>    <span class="st">'France'</span>: [<span class="dv">7500</span>, <span class="dv">7200</span>, <span class="dv">6800</span>, <span class="dv">6500</span>, <span class="dv">6200</span>],</span>
<span id="cb103-8"><a href=""></a>    <span class="st">'Germany'</span>: [<span class="dv">5200</span>, <span class="dv">4800</span>, <span class="dv">4600</span>, <span class="dv">4900</span>, <span class="dv">5100</span>]</span>
<span id="cb103-9"><a href=""></a>}</span>
<span id="cb103-10"><a href=""></a></span>
<span id="cb103-11"><a href=""></a>daily_cases <span class="op">=</span> pd.DataFrame(data, index<span class="op">=</span>dates)</span>
<span id="cb103-12"><a href=""></a>daily_cases.index.name <span class="op">=</span> <span class="st">'Date'</span></span>
<span id="cb103-13"><a href=""></a>daily_cases.columns.name <span class="op">=</span> <span class="st">'Country'</span></span>
<span id="cb103-14"><a href=""></a><span class="bu">print</span>(<span class="st">"Daily New COVID-19 Cases:"</span>)</span>
<span id="cb103-15"><a href=""></a><span class="bu">print</span>(daily_cases)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Daily New COVID-19 Cases:
Country     United States  India  Brazil  France  Germany
Date                                                     
2023-04-26          45000  12000    9800    7500     5200
2023-04-27          42000  13500    9200    7200     4800
2023-04-28          38000  14200    8700    6800     4600
2023-04-29          41000  13800    9100    6500     4900
2023-04-30          39000  12500    9500    6200     5100</code></pre>
</div>
</div>
</section>
<section id="hands-on---ufunc-1" class="slide level2">
<h2>Hands-on - UFunc</h2>
<ul>
<li>Create a DataFrame showing the <strong>percentage change</strong> for all the days from the first day for each country</li>
<li>Subtract the <strong>mean daily cases</strong> for each country from the daily cases</li>
<li>Calculate the <strong>ratio of daily cases</strong> in the United States compared to each other country</li>
</ul>
</section></section>
<section>
<section id="handling-missing-data-in-pandas" class="title-slide slide level1 center">
<h1>Handling Missing Data in Pandas</h1>

</section>
<section id="missing-data-representations-12" class="slide level2">
<h2>Missing Data Representations (1/2)</h2>
<p>Pandas uses two main values to represent missing data:</p>
<ol type="1">
<li><strong>None</strong>: A Python singleton object
<ul>
<li>Operations on arrays with <code>None</code> values are performed at the Python level (<strong>slower</strong>)</li>
<li>Aggregations like <code>sum()</code> or <code>min()</code> will generally result in errors</li>
</ul></li>
</ol>
</section>
<section id="missing-data-representations-22" class="slide level2">
<h2>Missing Data Representations (2/2)</h2>
<p>Pandas uses two main values to represent missing data:</p>
<ol start="2" type="1">
<li><strong>NaN (Not a Number)</strong>: A special floating-point value
<ul>
<li>Part of the IEEE floating-point specification</li>
<li>Arrays with NaN maintain native data types (<strong>faster operations</strong>)</li>
<li>NaN “infects” other values in arithmetic operations</li>
<li>Aggregations return <strong>NaN</strong> unless using special functions like <code>np.nansum()</code></li>
</ul></li>
</ol>
</section>
<section id="detecting-null-values" class="slide level2">
<h2>Detecting Null Values</h2>
<div id="5cd8afbf" class="cell" data-execution_count="57">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb105-1"><a href=""></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb105-2"><a href=""></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb105-3"><a href=""></a><span class="co"># Create Series for COVID-19 metrics</span></span>
<span id="cb105-4"><a href=""></a>cases <span class="op">=</span> pd.Series({<span class="st">'2020-01-01'</span>: <span class="fl">98.2</span>, <span class="st">'2020-01-02'</span>: <span class="dv">99</span>, <span class="st">'2020-01-03'</span>: np.nan,<span class="st">'2020-01-04'</span>: <span class="dv">150</span>, <span class="st">'2020-01-05'</span>: <span class="dv">180</span>})</span>
<span id="cb105-5"><a href=""></a>deaths <span class="op">=</span> pd.Series({<span class="st">'2020-01-01'</span>: np.nan, <span class="st">'2020-01-02'</span>: np.nan, <span class="st">'2020-01-03'</span>: np.nan,<span class="st">'2020-01-04'</span>: np.nan, <span class="st">'2020-01-05'</span>: np.nan})</span>
<span id="cb105-6"><a href=""></a>population <span class="op">=</span> pd.Series({<span class="st">'2020-01-01'</span>: <span class="fl">331.9</span>, <span class="st">'2020-01-02'</span>:<span class="fl">331.9</span>, <span class="st">'2020-01-03'</span>: <span class="fl">331.9</span>, <span class="st">'2020-01-04'</span>: <span class="fl">331.9</span>, <span class="st">'2020-01-05'</span>: <span class="fl">331.9</span>})</span>
<span id="cb105-7"><a href=""></a><span class="co"># Create DataFrame</span></span>
<span id="cb105-8"><a href=""></a>covid_df <span class="op">=</span> pd.DataFrame({<span class="st">'cases_millions'</span>: cases, </span>
<span id="cb105-9"><a href=""></a>                         <span class="st">'deaths_millions'</span>: deaths, </span>
<span id="cb105-10"><a href=""></a>                         <span class="st">'population_millions'</span>: population})</span>
<span id="cb105-11"><a href=""></a><span class="bu">print</span>(<span class="st">"COVID-19 Statistics by Country:"</span>)</span>
<span id="cb105-12"><a href=""></a><span class="bu">print</span>(covid_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>COVID-19 Statistics by Country:
            cases_millions  deaths_millions  population_millions
2020-01-01            98.2              NaN                331.9
2020-01-02            99.0              NaN                331.9
2020-01-03             NaN              NaN                331.9
2020-01-04           150.0              NaN                331.9
2020-01-05           180.0              NaN                331.9</code></pre>
</div>
</div>
</section>
<section id="detecting-null-values-1" class="slide level2">
<h2>Detecting Null Values</h2>
<p><code>df.isnull()</code>: Generate boolean mask of null values</p>
<div id="3ea23440" class="cell" data-execution_count="58">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb107-1"><a href=""></a><span class="bu">print</span>(covid_df.isnull())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            cases_millions  deaths_millions  population_millions
2020-01-01           False             True                False
2020-01-02           False             True                False
2020-01-03            True             True                False
2020-01-04           False             True                False
2020-01-05           False             True                False</code></pre>
</div>
</div>
<p><code>df.notnull()</code>: Opposite of isnull()</p>
<div id="5a3d6462" class="cell" data-execution_count="59">
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb109-1"><a href=""></a><span class="bu">print</span>(covid_df.notnull() )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            cases_millions  deaths_millions  population_millions
2020-01-01            True            False                 True
2020-01-02            True            False                 True
2020-01-03           False            False                 True
2020-01-04            True            False                 True
2020-01-05            True            False                 True</code></pre>
</div>
</div>
</section>
<section id="dropping-null-values" class="slide level2">
<h2>Dropping Null Values</h2>
<div id="00a032ac" class="cell" data-execution_count="60">
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb111-1"><a href=""></a><span class="bu">print</span>(covid_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            cases_millions  deaths_millions  population_millions
2020-01-01            98.2              NaN                331.9
2020-01-02            99.0              NaN                331.9
2020-01-03             NaN              NaN                331.9
2020-01-04           150.0              NaN                331.9
2020-01-05           180.0              NaN                331.9</code></pre>
</div>
</div>
<p><code>df.dropna()</code> default: drop <code>row</code>s</p>
<div id="f5f08bba" class="cell" data-execution_count="61">
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb113-1"><a href=""></a><span class="co"># Drop rows with any null values</span></span>
<span id="cb113-2"><a href=""></a><span class="bu">print</span>(covid_df.dropna())              </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Empty DataFrame
Columns: [cases_millions, deaths_millions, population_millions]
Index: []</code></pre>
</div>
</div>
</section>
<section id="dropping-null-values-1" class="slide level2">
<h2>Dropping Null Values</h2>
<div id="ecb3a5aa" class="cell" data-execution_count="62">
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb115-1"><a href=""></a><span class="bu">print</span>(covid_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            cases_millions  deaths_millions  population_millions
2020-01-01            98.2              NaN                331.9
2020-01-02            99.0              NaN                331.9
2020-01-03             NaN              NaN                331.9
2020-01-04           150.0              NaN                331.9
2020-01-05           180.0              NaN                331.9</code></pre>
</div>
</div>
<p><code>axis='columns'</code>: Drop columns with any null values</p>
<div id="42b462ad" class="cell" data-execution_count="63">
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb117-1"><a href=""></a><span class="bu">print</span>(covid_df.dropna(axis<span class="op">=</span><span class="st">'columns'</span>))  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            population_millions
2020-01-01                331.9
2020-01-02                331.9
2020-01-03                331.9
2020-01-04                331.9
2020-01-05                331.9</code></pre>
</div>
</div>
</section>
<section id="dropping-null-values-2" class="slide level2">
<h2>Dropping Null Values</h2>
<div id="17775cd4" class="cell" data-execution_count="64">
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb119-1"><a href=""></a><span class="bu">print</span>(covid_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            cases_millions  deaths_millions  population_millions
2020-01-01            98.2              NaN                331.9
2020-01-02            99.0              NaN                331.9
2020-01-03             NaN              NaN                331.9
2020-01-04           150.0              NaN                331.9
2020-01-05           180.0              NaN                331.9</code></pre>
</div>
</div>
<p><code>how='all'</code>: Drop <strong>rows</strong> with all null values</p>
<div id="8f026dcc" class="cell" data-execution_count="65">
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb121-1"><a href=""></a><span class="bu">print</span>(covid_df.dropna(how<span class="op">=</span><span class="st">'all'</span>))          </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            cases_millions  deaths_millions  population_millions
2020-01-01            98.2              NaN                331.9
2020-01-02            99.0              NaN                331.9
2020-01-03             NaN              NaN                331.9
2020-01-04           150.0              NaN                331.9
2020-01-05           180.0              NaN                331.9</code></pre>
</div>
</div>
</section>
<section id="dropping-null-values-3" class="slide level2">
<h2>Dropping Null Values</h2>
<div id="3d07e6fb" class="cell" data-execution_count="66">
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb123-1"><a href=""></a><span class="bu">print</span>(covid_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            cases_millions  deaths_millions  population_millions
2020-01-01            98.2              NaN                331.9
2020-01-02            99.0              NaN                331.9
2020-01-03             NaN              NaN                331.9
2020-01-04           150.0              NaN                331.9
2020-01-05           180.0              NaN                331.9</code></pre>
</div>
</div>
<p><code>axis=1, how='all'</code>: Drop <strong>columns</strong> with all null values</p>
<div id="93a5f91a" class="cell" data-execution_count="67">
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb125-1"><a href=""></a><span class="bu">print</span>(covid_df.dropna(axis<span class="op">=</span><span class="dv">1</span>, how<span class="op">=</span><span class="st">'all'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            cases_millions  population_millions
2020-01-01            98.2                331.9
2020-01-02            99.0                331.9
2020-01-03             NaN                331.9
2020-01-04           150.0                331.9
2020-01-05           180.0                331.9</code></pre>
</div>
</div>
</section>
<section id="dropping-null-values-4" class="slide level2">
<h2>Dropping Null Values</h2>
<div id="a0f26040" class="cell" data-execution_count="68">
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb127-1"><a href=""></a><span class="bu">print</span>(covid_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            cases_millions  deaths_millions  population_millions
2020-01-01            98.2              NaN                331.9
2020-01-02            99.0              NaN                331.9
2020-01-03             NaN              NaN                331.9
2020-01-04           150.0              NaN                331.9
2020-01-05           180.0              NaN                331.9</code></pre>
</div>
</div>
<p><code>thresh=3</code>: Keep rows with at least <code>2</code> non-null values</p>
<div id="7a7b99a4" class="cell" data-execution_count="69">
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb129-1"><a href=""></a><span class="bu">print</span>(covid_df.dropna(thresh<span class="op">=</span><span class="dv">2</span>))          </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            cases_millions  deaths_millions  population_millions
2020-01-01            98.2              NaN                331.9
2020-01-02            99.0              NaN                331.9
2020-01-04           150.0              NaN                331.9
2020-01-05           180.0              NaN                331.9</code></pre>
</div>
</div>
</section>
<section id="filling-null-values" class="slide level2">
<h2>Filling Null Values</h2>
<div id="5c73ac60" class="cell" data-execution_count="70">
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb131-1"><a href=""></a><span class="bu">print</span>(covid_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            cases_millions  deaths_millions  population_millions
2020-01-01            98.2              NaN                331.9
2020-01-02            99.0              NaN                331.9
2020-01-03             NaN              NaN                331.9
2020-01-04           150.0              NaN                331.9
2020-01-05           180.0              NaN                331.9</code></pre>
</div>
</div>
<p><code>df.fillna(value)</code>:Fill with a constant value</p>
<div id="1329463f" class="cell" data-execution_count="71">
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb133-1"><a href=""></a><span class="bu">print</span>(covid_df.fillna(<span class="dv">0</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            cases_millions  deaths_millions  population_millions
2020-01-01            98.2              0.0                331.9
2020-01-02            99.0              0.0                331.9
2020-01-03             0.0              0.0                331.9
2020-01-04           150.0              0.0                331.9
2020-01-05           180.0              0.0                331.9</code></pre>
</div>
</div>
</section>
<section id="filling-null-values-1" class="slide level2">
<h2>Filling Null Values</h2>
<div id="dcddb935" class="cell" data-execution_count="72">
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb135-1"><a href=""></a><span class="bu">print</span>(covid_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            cases_millions  deaths_millions  population_millions
2020-01-01            98.2              NaN                331.9
2020-01-02            99.0              NaN                331.9
2020-01-03             NaN              NaN                331.9
2020-01-04           150.0              NaN                331.9
2020-01-05           180.0              NaN                331.9</code></pre>
</div>
</div>
<p><code>df.ffill()</code>: Forward-fill (propagate last valid value)</p>
<div id="0fca1d36" class="cell" data-execution_count="73">
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb137-1"><a href=""></a><span class="bu">print</span>(covid_df.ffill())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            cases_millions  deaths_millions  population_millions
2020-01-01            98.2              NaN                331.9
2020-01-02            99.0              NaN                331.9
2020-01-03            99.0              NaN                331.9
2020-01-04           150.0              NaN                331.9
2020-01-05           180.0              NaN                331.9</code></pre>
</div>
</div>
</section>
<section id="filling-null-values-2" class="slide level2">
<h2>Filling Null Values</h2>
<div id="98941563" class="cell" data-execution_count="74">
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb139-1"><a href=""></a><span class="bu">print</span>(covid_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            cases_millions  deaths_millions  population_millions
2020-01-01            98.2              NaN                331.9
2020-01-02            99.0              NaN                331.9
2020-01-03             NaN              NaN                331.9
2020-01-04           150.0              NaN                331.9
2020-01-05           180.0              NaN                331.9</code></pre>
</div>
</div>
<p><code>df.bfill()</code>: Back-fill (use next valid value)</p>
<div id="c1ad9b12" class="cell" data-execution_count="75">
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb141-1"><a href=""></a><span class="bu">print</span>(covid_df.bfill())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            cases_millions  deaths_millions  population_millions
2020-01-01            98.2              NaN                331.9
2020-01-02            99.0              NaN                331.9
2020-01-03           150.0              NaN                331.9
2020-01-04           150.0              NaN                331.9
2020-01-05           180.0              NaN                331.9</code></pre>
</div>
</div>
</section>
<section id="hands-on---missing-value" class="slide level2">
<h2>Hands-on - Missing Value</h2>
<div id="18d227ef" class="cell" data-execution_count="76">
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb143-1"><a href=""></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb143-2"><a href=""></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb143-3"><a href=""></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb143-4"><a href=""></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb143-5"><a href=""></a></span>
<span id="cb143-6"><a href=""></a><span class="co"># Create a DataFrame with COVID-19 data (with some missing values)</span></span>
<span id="cb143-7"><a href=""></a>data <span class="op">=</span> {</span>
<span id="cb143-8"><a href=""></a>    <span class="st">'Country'</span>: [<span class="st">'USA'</span>, <span class="st">'India'</span>, <span class="st">'Brazil'</span>, <span class="st">'France'</span>, <span class="st">'Germany'</span>, <span class="st">'UK'</span>, <span class="st">'Italy'</span>, <span class="st">'Spain'</span>, <span class="st">'Russia'</span>, <span class="st">'Mexico'</span>],</span>
<span id="cb143-9"><a href=""></a>    <span class="st">'Cases'</span>: [<span class="dv">98200000</span>, <span class="dv">44700000</span>, <span class="dv">37600000</span>, <span class="dv">35400000</span>, <span class="dv">30200000</span>, np.nan, <span class="dv">25000000</span>, <span class="dv">13800000</span>, np.nan, <span class="dv">7300000</span>],</span>
<span id="cb143-10"><a href=""></a>    <span class="st">'Deaths'</span>: [<span class="dv">1100000</span>, <span class="dv">530000</span>, <span class="dv">690000</span>, <span class="dv">160000</span>, <span class="dv">170000</span>, <span class="dv">220000</span>, np.nan, <span class="dv">120000</span>, <span class="dv">400000</span>, np.nan],</span>
<span id="cb143-11"><a href=""></a>    <span class="st">'Recovered'</span>: [<span class="dv">93100000</span>, <span class="dv">43200000</span>, <span class="dv">35900000</span>, <span class="dv">34800000</span>, <span class="dv">29500000</span>, <span class="dv">24100000</span>, <span class="va">None</span>, <span class="dv">13600000</span>, <span class="dv">18200000</span>, <span class="dv">6900000</span>],</span>
<span id="cb143-12"><a href=""></a>    <span class="st">'Tests'</span>: [np.nan, <span class="dv">900000000</span>, <span class="dv">180000000</span>, <span class="dv">271000000</span>, <span class="dv">122000000</span>, <span class="dv">522000000</span>, <span class="dv">265000000</span>, <span class="dv">471000000</span>, np.nan, <span class="dv">18000000</span>]</span>
<span id="cb143-13"><a href=""></a>}</span>
<span id="cb143-14"><a href=""></a></span>
<span id="cb143-15"><a href=""></a>covid_df <span class="op">=</span> pd.DataFrame(data)</span>
<span id="cb143-16"><a href=""></a><span class="bu">print</span>(<span class="st">"COVID-19 Dataset:"</span>)</span>
<span id="cb143-17"><a href=""></a><span class="bu">print</span>(covid_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>COVID-19 Dataset:
   Country       Cases     Deaths   Recovered        Tests
0      USA  98200000.0  1100000.0  93100000.0          NaN
1    India  44700000.0   530000.0  43200000.0  900000000.0
2   Brazil  37600000.0   690000.0  35900000.0  180000000.0
3   France  35400000.0   160000.0  34800000.0  271000000.0
4  Germany  30200000.0   170000.0  29500000.0  122000000.0
5       UK         NaN   220000.0  24100000.0  522000000.0
6    Italy  25000000.0        NaN         NaN  265000000.0
7    Spain  13800000.0   120000.0  13600000.0  471000000.0
8   Russia         NaN   400000.0  18200000.0          NaN
9   Mexico   7300000.0        NaN   6900000.0   18000000.0</code></pre>
</div>
</div>
</section>
<section id="hands-on---missing-value-1" class="slide level2">
<h2>Hands-on - Missing Value</h2>
<ul>
<li>Check for missing values in the dataset using isnull() and calculate the sum for each column</li>
<li>Drop only rows where the ‘Deaths’ column has missing values (<code>Hint</code>: <code>subset</code> parameter in <code>df.dropna()</code>)</li>
<li>Use forward fill (ffill) to propagate the last valid observation forward</li>
<li>Create a new column ‘Case_Fatality_Rate’ calculated as Deaths/Cases, handling any resulting NaN values appropriately</li>
</ul>
</section></section>
<section>
<section id="hierarchical-indexing-in-pandas" class="title-slide slide level1 center">
<h1>Hierarchical Indexing in Pandas</h1>

</section>
<section id="introduction-to-multi-indexinghierarchical-indexing" class="slide level2">
<h2>Introduction to Multi-Indexing/Hierarchical indexing</h2>
<ul>
<li>Represent higher-dimensional data within the familiar 1D <strong>Series</strong> and 2D <strong>DataFrame</strong> objects.</li>
<li>Providing a powerful way to work with complex data structures.</li>
</ul>
</section>
<section id="creating-a-multi-indexed-series" class="slide level2">
<h2>Creating a Multi-Indexed Series</h2>
<p>Create a multi-indexed Series by using <strong>tuples</strong> as keys.</p>
<div id="8c239557" class="cell" data-execution_count="77">
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb145-1"><a href=""></a>index <span class="op">=</span> [(<span class="st">'New York'</span>, <span class="dv">2000</span>), (<span class="st">'New York'</span>, <span class="dv">2010</span>),</span>
<span id="cb145-2"><a href=""></a>          (<span class="st">'California'</span>, <span class="dv">2000</span>), (<span class="st">'California'</span>, <span class="dv">2010</span>),</span>
<span id="cb145-3"><a href=""></a>         (<span class="st">'Texas'</span>, <span class="dv">2000</span>), (<span class="st">'Texas'</span>, <span class="dv">2010</span>)]</span>
<span id="cb145-4"><a href=""></a>populations <span class="op">=</span> [<span class="dv">33871648</span>, <span class="dv">37253956</span>, <span class="dv">18976457</span>, <span class="dv">19378102</span>, <span class="dv">20851820</span>, <span class="dv">25145561</span>]</span>
<span id="cb145-5"><a href=""></a>pop <span class="op">=</span> pd.Series(populations, index<span class="op">=</span>index)</span>
<span id="cb145-6"><a href=""></a><span class="bu">print</span>(pop)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(New York, 2000)      33871648
(New York, 2010)      37253956
(California, 2000)    18976457
(California, 2010)    19378102
(Texas, 2000)         20851820
(Texas, 2010)         25145561
dtype: int64</code></pre>
</div>
</div>
</section>
<section id="the-better-way-multiindex" class="slide level2">
<h2>The Better Way: MultiIndex</h2>
<p>A more efficient approach is to use Pandas’ MultiIndex.</p>
<div id="cf0ffbff" class="cell" data-execution_count="78">
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb147-1"><a href=""></a><span class="co"># Create MultiIndex from tuples</span></span>
<span id="cb147-2"><a href=""></a>index <span class="op">=</span> pd.MultiIndex.from_tuples(index)</span>
<span id="cb147-3"><a href=""></a><span class="bu">print</span>(index)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>MultiIndex([(  'New York', 2000),
            (  'New York', 2010),
            ('California', 2000),
            ('California', 2010),
            (     'Texas', 2000),
            (     'Texas', 2010)],
           )</code></pre>
</div>
</div>
<div id="1a8d1107" class="cell" data-execution_count="79">
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb149-1"><a href=""></a>pop <span class="op">=</span> pop.reindex(index)</span>
<span id="cb149-2"><a href=""></a><span class="bu">print</span>(pop)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>New York    2000    33871648
            2010    37253956
California  2000    18976457
            2010    19378102
Texas       2000    20851820
            2010    25145561
dtype: int64</code></pre>
</div>
</div>
</section>
<section id="the-better-way-multiindex-1" class="slide level2">
<h2>The Better Way: MultiIndex</h2>
<p>We can easily select data using intuitive slicing.</p>
<div id="a8b867d0" class="cell" data-execution_count="80">
<div class="sourceCode cell-code" id="cb151"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb151-1"><a href=""></a><span class="co"># Select all data from 2010</span></span>
<span id="cb151-2"><a href=""></a>pop[:, <span class="dv">2010</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="79">
<pre><code>New York      37253956
California    19378102
Texas         25145561
dtype: int64</code></pre>
</div>
</div>
</section>
<section id="multiindex-construction-methods-12" class="slide level2">
<h2>MultiIndex Construction Methods (1/2)</h2>
<p>There are several ways to create a MultiIndex.</p>
<p>From arrays</p>
<div id="b38df38f" class="cell" data-execution_count="81">
<div class="sourceCode cell-code" id="cb153"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb153-1"><a href=""></a>pd.MultiIndex.from_arrays([[<span class="st">'a'</span>, <span class="st">'a'</span>, <span class="st">'b'</span>, <span class="st">'b'</span>], [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="80">
<pre><code>MultiIndex([('a', 1),
            ('a', 2),
            ('b', 1),
            ('b', 2)],
           )</code></pre>
</div>
</div>
<p>From tuples</p>
<div id="728556ee" class="cell" data-execution_count="82">
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb155-1"><a href=""></a>pd.MultiIndex.from_tuples([(<span class="st">'a'</span>, <span class="dv">1</span>), (<span class="st">'a'</span>, <span class="dv">2</span>), (<span class="st">'b'</span>, <span class="dv">1</span>), (<span class="st">'b'</span>, <span class="dv">2</span>)])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="81">
<pre><code>MultiIndex([('a', 1),
            ('a', 2),
            ('b', 1),
            ('b', 2)],
           )</code></pre>
</div>
</div>
</section>
<section id="multiindex-construction-methods-22" class="slide level2">
<h2>MultiIndex Construction Methods (2/2)</h2>
<p>From Cartesian product</p>
<div id="a3c09460" class="cell" data-execution_count="83">
<div class="sourceCode cell-code" id="cb157"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb157-1"><a href=""></a>pd.MultiIndex.from_product([[<span class="st">'a'</span>, <span class="st">'b'</span>], [<span class="dv">1</span>, <span class="dv">2</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="82">
<pre><code>MultiIndex([('a', 1),
            ('a', 2),
            ('b', 1),
            ('b', 2)],
           )</code></pre>
</div>
</div>
</section>
<section id="naming-levels" class="slide level2">
<h2>Naming Levels</h2>
<p>You can name the levels for better clarity.</p>
<div id="5c583130" class="cell" data-execution_count="84">
<div class="sourceCode cell-code" id="cb159"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb159-1"><a href=""></a>pop.index.names <span class="op">=</span> [<span class="st">'state'</span>, <span class="st">'year'</span>]</span>
<span id="cb159-2"><a href=""></a><span class="bu">print</span>(pop)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>state       year
New York    2000    33871648
            2010    37253956
California  2000    18976457
            2010    19378102
Texas       2000    20851820
            2010    25145561
dtype: int64</code></pre>
</div>
</div>
</section>
<section id="multiindex-for-columns" class="slide level2">
<h2>MultiIndex for Columns</h2>
<p>Original DataFrame:</p>
<div id="5cb38f2b" class="cell" data-execution_count="85">
<div class="sourceCode cell-code" id="cb161"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb161-1"><a href=""></a>HR_Bob <span class="op">=</span> np.array([<span class="dv">130</span>,<span class="dv">120</span>,<span class="dv">155</span>,<span class="dv">168</span>])</span>
<span id="cb161-2"><a href=""></a>HR_Guido <span class="op">=</span> np.array([<span class="dv">100</span>,<span class="dv">90</span>,<span class="dv">60</span>,<span class="dv">80</span>])</span>
<span id="cb161-3"><a href=""></a>HR_Sue <span class="op">=</span> np.array([<span class="dv">60</span>,<span class="dv">70</span>,<span class="dv">80</span>,<span class="dv">70</span>])</span>
<span id="cb161-4"><a href=""></a>Temp_Bob <span class="op">=</span> np.array([<span class="fl">36.7</span>,<span class="fl">38.2</span>,<span class="fl">37.6</span>,<span class="fl">36.2</span>])</span>
<span id="cb161-5"><a href=""></a>Temp_Guido <span class="op">=</span> np.array([<span class="fl">37.5</span>,<span class="dv">38</span>,<span class="fl">36.8</span>,<span class="fl">37.1</span>])</span>
<span id="cb161-6"><a href=""></a>Temp_Sue <span class="op">=</span> np.array([<span class="fl">37.7</span>,<span class="fl">38.2</span>,<span class="fl">36.9</span>,<span class="fl">35.7</span>])</span>
<span id="cb161-7"><a href=""></a>health_data <span class="op">=</span> pd.DataFrame(np.column_stack((HR_Bob,Temp_Bob,HR_Guido,Temp_Guido,HR_Sue,Temp_Sue)))</span>
<span id="cb161-8"><a href=""></a><span class="bu">print</span>(health_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       0     1      2     3     4     5
0  130.0  36.7  100.0  37.5  60.0  37.7
1  120.0  38.2   90.0  38.0  70.0  38.2
2  155.0  37.6   60.0  36.8  80.0  36.9
3  168.0  36.2   80.0  37.1  70.0  35.7</code></pre>
</div>
</div>
</section>
<section id="multiindex-for-columns-1" class="slide level2">
<h2>MultiIndex for Columns</h2>
<p>DataFrames can have multi-indexed columns as well:</p>
<div id="4d5717c6" class="cell" data-execution_count="86">
<div class="sourceCode cell-code" id="cb163"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb163-1"><a href=""></a><span class="co"># Create hierarchical indices and columns</span></span>
<span id="cb163-2"><a href=""></a>index <span class="op">=</span> pd.MultiIndex.from_product([[<span class="dv">2013</span>, <span class="dv">2014</span>], [<span class="dv">1</span>, <span class="dv">2</span>]], names<span class="op">=</span>[<span class="st">'year'</span>, <span class="st">'visit'</span>])</span>
<span id="cb163-3"><a href=""></a>columns <span class="op">=</span> pd.MultiIndex.from_product([[<span class="st">'Bob'</span>, <span class="st">'Guido'</span>, <span class="st">'Sue'</span>], [<span class="st">'HR'</span>, <span class="st">'Temp'</span>]], names<span class="op">=</span>[<span class="st">'subject'</span>, <span class="st">'type'</span>])</span>
<span id="cb163-4"><a href=""></a></span>
<span id="cb163-5"><a href=""></a>health_data <span class="op">=</span> pd.DataFrame(np.column_stack((HR_Bob,Temp_Bob,HR_Guido,Temp_Guido,HR_Sue,Temp_Sue)), </span>
<span id="cb163-6"><a href=""></a>              index<span class="op">=</span>index, columns<span class="op">=</span>columns)</span>
<span id="cb163-7"><a href=""></a><span class="bu">print</span>(health_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>subject       Bob        Guido         Sue      
type           HR  Temp     HR  Temp    HR  Temp
year visit                                      
2013 1      130.0  36.7  100.0  37.5  60.0  37.7
     2      120.0  38.2   90.0  38.0  70.0  38.2
2014 1      155.0  37.6   60.0  36.8  80.0  36.9
     2      168.0  36.2   80.0  37.1  70.0  35.7</code></pre>
</div>
</div>
</section>
<section id="indexing-and-slicing---series" class="slide level2">
<h2>Indexing and Slicing - Series</h2>
<div id="e4428e22" class="cell" data-execution_count="87">
<div class="sourceCode cell-code" id="cb165"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb165-1"><a href=""></a><span class="bu">print</span>(pop)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>state       year
New York    2000    33871648
            2010    37253956
California  2000    18976457
            2010    19378102
Texas       2000    20851820
            2010    25145561
dtype: int64</code></pre>
</div>
</div>
<p>Access single elements</p>
<div id="e5f499fd" class="cell" data-execution_count="88">
<div class="sourceCode cell-code" id="cb167"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb167-1"><a href=""></a>pop[<span class="st">'California'</span>, <span class="dv">2000</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="87">
<pre><code>18976457</code></pre>
</div>
</div>
</section>
<section id="indexing-and-slicing---series-1" class="slide level2">
<h2>Indexing and Slicing - Series</h2>
<div id="ebf0d3a3" class="cell" data-execution_count="89">
<div class="sourceCode cell-code" id="cb169"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb169-1"><a href=""></a><span class="bu">print</span>(pop)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>state       year
New York    2000    33871648
            2010    37253956
California  2000    18976457
            2010    19378102
Texas       2000    20851820
            2010    25145561
dtype: int64</code></pre>
</div>
</div>
<p>Partial indexing (returns a Series)</p>
<div id="c56fe5c2" class="cell" data-execution_count="90">
<div class="sourceCode cell-code" id="cb171"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb171-1"><a href=""></a>pop[<span class="st">'California'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="89">
<pre><code>year
2000    18976457
2010    19378102
dtype: int64</code></pre>
</div>
</div>
</section>
<section id="indexing-and-slicing---series-2" class="slide level2">
<h2>Indexing and Slicing - Series</h2>
<div id="3ca45f45" class="cell" data-execution_count="91">
<div class="sourceCode cell-code" id="cb173"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb173-1"><a href=""></a><span class="bu">print</span>(pop)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>state       year
New York    2000    33871648
            2010    37253956
California  2000    18976457
            2010    19378102
Texas       2000    20851820
            2010    25145561
dtype: int64</code></pre>
</div>
</div>
<p>Selecting specific level</p>
<div id="58ff40eb" class="cell" data-execution_count="92">
<div class="sourceCode cell-code" id="cb175"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb175-1"><a href=""></a>pop[:, <span class="dv">2000</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="91">
<pre><code>state
New York      33871648
California    18976457
Texas         20851820
dtype: int64</code></pre>
</div>
</div>
</section>
<section id="indexing-and-slicing---series-3" class="slide level2">
<h2>Indexing and Slicing - Series</h2>
<div id="7303b0e9" class="cell" data-execution_count="93">
<div class="sourceCode cell-code" id="cb177"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb177-1"><a href=""></a><span class="bu">print</span>(pop)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>state       year
New York    2000    33871648
            2010    37253956
California  2000    18976457
            2010    19378102
Texas       2000    20851820
            2010    25145561
dtype: int64</code></pre>
</div>
</div>
<p>Boolean masking</p>
<div id="f7c34546" class="cell" data-execution_count="94">
<div class="sourceCode cell-code" id="cb179"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb179-1"><a href=""></a>pop[pop <span class="op">&gt;</span> <span class="dv">22000000</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="93">
<pre><code>state     year
New York  2000    33871648
          2010    37253956
Texas     2010    25145561
dtype: int64</code></pre>
</div>
</div>
</section>
<section id="indexing-and-slicing---series-4" class="slide level2">
<h2>Indexing and Slicing - Series</h2>
<p>select multiple index by <code>[[]]</code></p>
<div id="6613f51f" class="cell" data-execution_count="95">
<div class="sourceCode cell-code" id="cb181"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb181-1"><a href=""></a><span class="bu">print</span>(pop)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>state       year
New York    2000    33871648
            2010    37253956
California  2000    18976457
            2010    19378102
Texas       2000    20851820
            2010    25145561
dtype: int64</code></pre>
</div>
</div>
<div id="c430d190" class="cell" data-execution_count="96">
<div class="sourceCode cell-code" id="cb183"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb183-1"><a href=""></a>pop[[<span class="st">'California'</span>, <span class="st">'Texas'</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="95">
<pre><code>state       year
California  2000    18976457
            2010    19378102
Texas       2000    20851820
            2010    25145561
dtype: int64</code></pre>
</div>
</div>
</section>
<section id="indexing-and-slicing---multi-indexed-columns" class="slide level2">
<h2>Indexing and Slicing - multi-indexed columns</h2>
<div id="55dfbb4c" class="cell" data-execution_count="97">
<div class="sourceCode cell-code" id="cb185"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb185-1"><a href=""></a><span class="bu">print</span>(health_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>subject       Bob        Guido         Sue      
type           HR  Temp     HR  Temp    HR  Temp
year visit                                      
2013 1      130.0  36.7  100.0  37.5  60.0  37.7
     2      120.0  38.2   90.0  38.0  70.0  38.2
2014 1      155.0  37.6   60.0  36.8  80.0  36.9
     2      168.0  36.2   80.0  37.1  70.0  35.7</code></pre>
</div>
</div>
<p>Select a specific person’s data</p>
<div id="84752a30" class="cell" data-execution_count="98">
<div class="sourceCode cell-code" id="cb187"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb187-1"><a href=""></a><span class="bu">print</span>(health_data[<span class="st">'Guido'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>type           HR  Temp
year visit             
2013 1      100.0  37.5
     2       90.0  38.0
2014 1       60.0  36.8
     2       80.0  37.1</code></pre>
</div>
</div>
</section>
<section id="indexing-and-slicing---multi-indexed-columns-1" class="slide level2">
<h2>Indexing and Slicing - multi-indexed columns</h2>
<div id="6dfdf643" class="cell" data-execution_count="99">
<div class="sourceCode cell-code" id="cb189"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb189-1"><a href=""></a><span class="bu">print</span>(health_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>subject       Bob        Guido         Sue      
type           HR  Temp     HR  Temp    HR  Temp
year visit                                      
2013 1      130.0  36.7  100.0  37.5  60.0  37.7
     2      120.0  38.2   90.0  38.0  70.0  38.2
2014 1      155.0  37.6   60.0  36.8  80.0  36.9
     2      168.0  36.2   80.0  37.1  70.0  35.7</code></pre>
</div>
</div>
<p>Select specific measurements</p>
<div id="06d48260" class="cell" data-execution_count="100">
<div class="sourceCode cell-code" id="cb191"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb191-1"><a href=""></a><span class="bu">print</span>(health_data[<span class="st">'Guido'</span>, <span class="st">'HR'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>year  visit
2013  1        100.0
      2         90.0
2014  1         60.0
      2         80.0
Name: (Guido, HR), dtype: float64</code></pre>
</div>
</div>
</section>
<section id="sorting-indices" class="slide level2">
<h2>Sorting Indices</h2>
<div id="ce65f900" class="cell" data-execution_count="101">
<div class="sourceCode cell-code" id="cb193"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb193-1"><a href=""></a><span class="bu">print</span>(pop)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>state       year
New York    2000    33871648
            2010    37253956
California  2000    18976457
            2010    19378102
Texas       2000    20851820
            2010    25145561
dtype: int64</code></pre>
</div>
</div>
<p>Sort index for proper slicing</p>
<div id="4e11e4a3" class="cell" data-execution_count="102">
<div class="sourceCode cell-code" id="cb195"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb195-1"><a href=""></a>pop_sort <span class="op">=</span> pop.sort_index()</span>
<span id="cb195-2"><a href=""></a><span class="bu">print</span>(pop_sort)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>state       year
California  2000    18976457
            2010    19378102
New York    2000    33871648
            2010    37253956
Texas       2000    20851820
            2010    25145561
dtype: int64</code></pre>
</div>
</div>
</section>
<section id="stacking-and-unstacking" class="slide level2">
<h2>Stacking and Unstacking</h2>
<div id="bda30f05" class="cell" data-execution_count="103">
<div class="sourceCode cell-code" id="cb197"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb197-1"><a href=""></a><span class="bu">print</span>(pop)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>state       year
New York    2000    33871648
            2010    37253956
California  2000    18976457
            2010    19378102
Texas       2000    20851820
            2010    25145561
dtype: int64</code></pre>
</div>
</div>
<p>Convert Series to DataFrame</p>
<div id="76ba0f93" class="cell" data-execution_count="104">
<div class="sourceCode cell-code" id="cb199"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb199-1"><a href=""></a>pop_df <span class="op">=</span> pop.unstack()</span>
<span id="cb199-2"><a href=""></a><span class="bu">print</span>(<span class="st">"unstack: "</span>)</span>
<span id="cb199-3"><a href=""></a><span class="bu">print</span>(pop_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>unstack: 
year            2000      2010
state                         
California  18976457  19378102
New York    33871648  37253956
Texas       20851820  25145561</code></pre>
</div>
</div>
</section>
<section id="index-manipulation" class="slide level2">
<h2>Index Manipulation</h2>
<div id="81d16592" class="cell" data-execution_count="105">
<div class="sourceCode cell-code" id="cb201"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb201-1"><a href=""></a><span class="bu">print</span>(pop)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>state       year
New York    2000    33871648
            2010    37253956
California  2000    18976457
            2010    19378102
Texas       2000    20851820
            2010    25145561
dtype: int64</code></pre>
</div>
</div>
<p>Convert index to columns</p>
<div id="500142d1" class="cell" data-execution_count="106">
<div class="sourceCode cell-code" id="cb203"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb203-1"><a href=""></a>pop_flat <span class="op">=</span> pop.reset_index(name<span class="op">=</span><span class="st">'population'</span>)</span>
<span id="cb203-2"><a href=""></a><span class="bu">print</span>(pop_flat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        state  year  population
0    New York  2000    33871648
1    New York  2010    37253956
2  California  2000    18976457
3  California  2010    19378102
4       Texas  2000    20851820
5       Texas  2010    25145561</code></pre>
</div>
</div>
</section>
<section id="index-manipulation-1" class="slide level2">
<h2>Index Manipulation</h2>
<div id="e4647f35" class="cell" data-execution_count="107">
<div class="sourceCode cell-code" id="cb205"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb205-1"><a href=""></a><span class="bu">print</span>(pop)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>state       year
New York    2000    33871648
            2010    37253956
California  2000    18976457
            2010    19378102
Texas       2000    20851820
            2010    25145561
dtype: int64</code></pre>
</div>
</div>
<p>Convert columns to index</p>
<div id="de4df42d" class="cell" data-execution_count="108">
<div class="sourceCode cell-code" id="cb207"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb207-1"><a href=""></a><span class="bu">print</span>(pop_flat.set_index([<span class="st">'state'</span>, <span class="st">'year'</span>]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                 population
state      year            
New York   2000    33871648
           2010    37253956
California 2000    18976457
           2010    19378102
Texas      2000    20851820
           2010    25145561</code></pre>
</div>
</div>
</section>
<section id="data-aggregations" class="slide level2">
<h2>Data Aggregations</h2>
<div id="8edb30f2" class="cell" data-execution_count="109">
<div class="sourceCode cell-code" id="cb209"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb209-1"><a href=""></a><span class="bu">print</span>(health_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>subject       Bob        Guido         Sue      
type           HR  Temp     HR  Temp    HR  Temp
year visit                                      
2013 1      130.0  36.7  100.0  37.5  60.0  37.7
     2      120.0  38.2   90.0  38.0  70.0  38.2
2014 1      155.0  37.6   60.0  36.8  80.0  36.9
     2      168.0  36.2   80.0  37.1  70.0  35.7</code></pre>
</div>
</div>
<div id="5d9144ae" class="cell" data-execution_count="110">
<div class="sourceCode cell-code" id="cb211"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb211-1"><a href=""></a>data_mean <span class="op">=</span> health_data.mean()</span>
<span id="cb211-2"><a href=""></a><span class="bu">print</span>(data_mean)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>subject  type
Bob      HR      143.250
         Temp     37.175
Guido    HR       82.500
         Temp     37.350
Sue      HR       70.000
         Temp     37.125
dtype: float64</code></pre>
</div>
</div>
</section>
<section id="data-aggregations-1" class="slide level2">
<h2>Data Aggregations</h2>
<div id="88368ea9" class="cell" data-execution_count="111">
<div class="sourceCode cell-code" id="cb213"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb213-1"><a href=""></a><span class="bu">print</span>(health_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>subject       Bob        Guido         Sue      
type           HR  Temp     HR  Temp    HR  Temp
year visit                                      
2013 1      130.0  36.7  100.0  37.5  60.0  37.7
     2      120.0  38.2   90.0  38.0  70.0  38.2
2014 1      155.0  37.6   60.0  36.8  80.0  36.9
     2      168.0  36.2   80.0  37.1  70.0  35.7</code></pre>
</div>
</div>
<p>Average by year</p>
<div id="8f9d6007" class="cell" data-execution_count="112">
<div class="sourceCode cell-code" id="cb215"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb215-1"><a href=""></a>data_mean <span class="op">=</span> health_data.groupby(<span class="st">'year'</span>).mean()</span>
<span id="cb215-2"><a href=""></a><span class="bu">print</span>(data_mean)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>subject    Bob        Guido          Sue       
type        HR   Temp    HR   Temp    HR   Temp
year                                           
2013     125.0  37.45  95.0  37.75  65.0  37.95
2014     161.5  36.90  70.0  36.95  75.0  36.30</code></pre>
</div>
</div>
</section>
<section id="data-aggregations-2" class="slide level2">
<h2>Data Aggregations</h2>
<div id="b51b0a8e" class="cell" data-execution_count="113">
<div class="sourceCode cell-code" id="cb217"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb217-1"><a href=""></a><span class="bu">print</span>(health_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>subject       Bob        Guido         Sue      
type           HR  Temp     HR  Temp    HR  Temp
year visit                                      
2013 1      130.0  36.7  100.0  37.5  60.0  37.7
     2      120.0  38.2   90.0  38.0  70.0  38.2
2014 1      155.0  37.6   60.0  36.8  80.0  36.9
     2      168.0  36.2   80.0  37.1  70.0  35.7</code></pre>
</div>
</div>
<p>Average by measurement type across columns</p>
<div id="107c864a" class="cell" data-execution_count="114">
<div class="sourceCode cell-code" id="cb219"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb219-1"><a href=""></a>data_mean.T.mean() <span class="co"># just for demo</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="113">
<pre><code>year
2013    66.358333
2014    69.441667
dtype: float64</code></pre>
</div>
</div>
</section>
<section id="data-aggregations-3" class="slide level2">
<h2>Data Aggregations</h2>
<div id="74753da5" class="cell" data-execution_count="115">
<div class="sourceCode cell-code" id="cb221"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb221-1"><a href=""></a><span class="bu">print</span>(health_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>subject       Bob        Guido         Sue      
type           HR  Temp     HR  Temp    HR  Temp
year visit                                      
2013 1      130.0  36.7  100.0  37.5  60.0  37.7
     2      120.0  38.2   90.0  38.0  70.0  38.2
2014 1      155.0  37.6   60.0  36.8  80.0  36.9
     2      168.0  36.2   80.0  37.1  70.0  35.7</code></pre>
</div>
</div>
<p>Average by measurement type across columns</p>
<div id="d22872e0" class="cell" data-execution_count="116">
<div class="sourceCode cell-code" id="cb223"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb223-1"><a href=""></a><span class="bu">print</span>(data_mean.T.groupby(<span class="st">'type'</span>).mean())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>year       2013        2014
type                       
HR    95.000000  102.166667
Temp  37.716667   36.716667</code></pre>
</div>
</div>
</section>
<section id="hands-on---hierarchical-indexing" class="slide level2">
<h2>Hands-on - Hierarchical Indexing</h2>
<div id="ff7f72df" class="cell" data-execution_count="117">
<div class="sourceCode cell-code" id="cb225"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb225-1"><a href=""></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb225-2"><a href=""></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb225-3"><a href=""></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb225-4"><a href=""></a><span class="co"># Create a healthcare dataset with patient information across different hospitals and departments</span></span>
<span id="cb225-5"><a href=""></a><span class="co"># Row index: Hospital, Department, Patient ID</span></span>
<span id="cb225-6"><a href=""></a><span class="co"># Column index: Metric Type, Measurement</span></span>
<span id="cb225-7"><a href=""></a></span>
<span id="cb225-8"><a href=""></a><span class="co"># Create sample data</span></span>
<span id="cb225-9"><a href=""></a>hospitals <span class="op">=</span> [<span class="st">'General Hospital'</span>, <span class="st">'General Hospital'</span>, <span class="st">'Community Clinic'</span>, <span class="st">'Community Clinic'</span>]</span>
<span id="cb225-10"><a href=""></a>departments <span class="op">=</span> [<span class="st">'Cardiology'</span>, <span class="st">'Neurology'</span>] <span class="op">*</span> <span class="dv">2</span></span>
<span id="cb225-11"><a href=""></a>patient_ids <span class="op">=</span> <span class="bu">list</span>(<span class="bu">range</span>(<span class="dv">1001</span>, <span class="dv">1009</span>))  <span class="co"># 8 patients</span></span>
<span id="cb225-12"><a href=""></a></span>
<span id="cb225-13"><a href=""></a><span class="co"># Create row multi-index</span></span>
<span id="cb225-14"><a href=""></a>row_tuples <span class="op">=</span> [(h, d, p) <span class="cf">for</span> h, d <span class="kw">in</span> <span class="bu">zip</span>(hospitals <span class="op">*</span> <span class="dv">2</span>, departments <span class="op">*</span> <span class="dv">2</span>) <span class="cf">for</span> p <span class="kw">in</span> [patient_ids.pop(<span class="dv">0</span>)]]</span>
<span id="cb225-15"><a href=""></a>row_index <span class="op">=</span> pd.MultiIndex.from_tuples(row_tuples, names<span class="op">=</span>[<span class="st">'Hospital'</span>, <span class="st">'Department'</span>, <span class="st">'PatientID'</span>])</span>
<span id="cb225-16"><a href=""></a></span>
<span id="cb225-17"><a href=""></a><span class="co"># Create column multi-index</span></span>
<span id="cb225-18"><a href=""></a>metric_types <span class="op">=</span> [<span class="st">'Vital Signs'</span>, <span class="st">'Vital Signs'</span>, <span class="st">'Lab Results'</span>, <span class="st">'Lab Results'</span>]</span>
<span id="cb225-19"><a href=""></a>measurements <span class="op">=</span> [<span class="st">'Blood Pressure'</span>, <span class="st">'Heart Rate'</span>, <span class="st">'Glucose'</span>, <span class="st">'Cholesterol'</span>]</span>
<span id="cb225-20"><a href=""></a>col_index <span class="op">=</span> pd.MultiIndex.from_arrays([metric_types, measurements], names<span class="op">=</span>[<span class="st">'Type'</span>, <span class="st">'Measurement'</span>])</span>
<span id="cb225-21"><a href=""></a></span>
<span id="cb225-22"><a href=""></a><span class="co"># Generate sample data</span></span>
<span id="cb225-23"><a href=""></a>np.random.seed(<span class="dv">42</span>)</span>
<span id="cb225-24"><a href=""></a>data <span class="op">=</span> np.random.randint(<span class="dv">60</span>, <span class="dv">180</span>, size<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">4</span>))</span>
<span id="cb225-25"><a href=""></a>health_df <span class="op">=</span> pd.DataFrame(data, index<span class="op">=</span>row_index, columns<span class="op">=</span>col_index)</span>
<span id="cb225-26"><a href=""></a><span class="bu">print</span>(<span class="st">"Healthcare Patient Data:"</span>)</span>
<span id="cb225-27"><a href=""></a><span class="bu">print</span>(health_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Healthcare Patient Data:
Type                                     Vital Signs            Lab Results  \
Measurement                           Blood Pressure Heart Rate     Glucose   
Hospital         Department PatientID                                         
General Hospital Cardiology 1001                 162        111         152   
                 Neurology  1002                 166        131         120   
Community Clinic Cardiology 1003                 162        142         146   
                 Neurology  1004                 134        147         176   
General Hospital Cardiology 1005                 163         83          62   
                 Neurology  1006                 112         61         147   
Community Clinic Cardiology 1007                  89         97          61   
                 Neurology  1008                 119         80          92   

Type                                               
Measurement                           Cholesterol  
Hospital         Department PatientID              
General Hospital Cardiology 1001               74  
                 Neurology  1002               80  
Community Clinic Cardiology 1003              134  
                 Neurology  1004              159  
General Hospital Cardiology 1005               81  
                 Neurology  1006              167  
Community Clinic Cardiology 1007              123  
                 Neurology  1008              135  </code></pre>
</div>
</div>
</section>
<section id="hands-on---hierarchical-indexing-1" class="slide level2">
<h2>Hands-on - Hierarchical Indexing</h2>
<ul>
<li>Select all vital signs for patients in the Cardiology department</li>
<li>Calculate the average values for each measurement by hospital</li>
<li>Create a boolean mask to identify patients with heart rate &gt; 100 and glucose &gt; 120</li>
<li>Reset the index to convert the hierarchical index to columns</li>
</ul>
</section></section>
<section>
<section id="combining-datasets-concat-and-append" class="title-slide slide level1 center">
<h1>Combining Datasets: Concat and Append</h1>

</section>
<section id="helper-function" class="slide level2">
<h2>Helper Function</h2>
<div id="9bcef2a5" class="cell" data-execution_count="118">
<div class="sourceCode cell-code" id="cb227"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb227-1"><a href=""></a><span class="kw">def</span> make_df(cols, ind):</span>
<span id="cb227-2"><a href=""></a>    <span class="co">"""Quickly make a DataFrame"""</span></span>
<span id="cb227-3"><a href=""></a>    data <span class="op">=</span> {c: [<span class="bu">str</span>(c) <span class="op">+</span> <span class="bu">str</span>(i) <span class="cf">for</span> i <span class="kw">in</span> ind]</span>
<span id="cb227-4"><a href=""></a>            <span class="cf">for</span> c <span class="kw">in</span> cols}</span>
<span id="cb227-5"><a href=""></a>    <span class="cf">return</span> pd.DataFrame(data, ind)</span>
<span id="cb227-6"><a href=""></a></span>
<span id="cb227-7"><a href=""></a><span class="kw">class</span> display(<span class="bu">object</span>):</span>
<span id="cb227-8"><a href=""></a>    <span class="co">"""Display HTML representation of multiple objects"""</span></span>
<span id="cb227-9"><a href=""></a>    template <span class="op">=</span> <span class="st">"""&lt;div style="float: left; padding: 10px;"&gt;</span></span>
<span id="cb227-10"><a href=""></a><span class="st">    &lt;p style='font-family:"Courier New", Courier, monospace'&gt;</span><span class="sc">{0}</span><span class="st">&lt;/p&gt;</span><span class="sc">{1}</span></span>
<span id="cb227-11"><a href=""></a><span class="st">    &lt;/div&gt;"""</span></span>
<span id="cb227-12"><a href=""></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, <span class="op">*</span>args):</span>
<span id="cb227-13"><a href=""></a>        <span class="va">self</span>.args <span class="op">=</span> args</span>
<span id="cb227-14"><a href=""></a>        </span>
<span id="cb227-15"><a href=""></a>    <span class="kw">def</span> _repr_html_(<span class="va">self</span>):</span>
<span id="cb227-16"><a href=""></a>        <span class="cf">return</span> <span class="st">'</span><span class="ch">\n</span><span class="st">'</span>.join(<span class="va">self</span>.template.<span class="bu">format</span>(a, <span class="bu">eval</span>(a)._repr_html_())</span>
<span id="cb227-17"><a href=""></a>                         <span class="cf">for</span> a <span class="kw">in</span> <span class="va">self</span>.args)</span>
<span id="cb227-18"><a href=""></a>    </span>
<span id="cb227-19"><a href=""></a>    <span class="kw">def</span> <span class="fu">__repr__</span>(<span class="va">self</span>):</span>
<span id="cb227-20"><a href=""></a>        <span class="cf">return</span> <span class="st">'</span><span class="ch">\n\n</span><span class="st">'</span>.join(a <span class="op">+</span> <span class="st">'</span><span class="ch">\n</span><span class="st">'</span> <span class="op">+</span> <span class="bu">repr</span>(<span class="bu">eval</span>(a))</span>
<span id="cb227-21"><a href=""></a>                           <span class="cf">for</span> a <span class="kw">in</span> <span class="va">self</span>.args)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="basic-concatenation---dataframes" class="slide level2">
<h2>Basic Concatenation - DataFrames</h2>
<p><code>pd.concat</code> Default: Concatenate vertically (<code>axis=0</code>)</p>
<div id="2ff2c825" class="cell" data-execution_count="119">
<div class="sourceCode cell-code" id="cb228"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb228-1"><a href=""></a>df1 <span class="op">=</span> make_df(<span class="st">'AB'</span>, [<span class="dv">1</span>, <span class="dv">2</span>]) </span>
<span id="cb228-2"><a href=""></a>df2 <span class="op">=</span> make_df(<span class="st">'AB'</span>, [<span class="dv">3</span>, <span class="dv">4</span>])  </span>
<span id="cb228-3"><a href=""></a>df12 <span class="op">=</span> pd.concat([df1, df2])</span>
<span id="cb228-4"><a href=""></a>display(<span class="st">'df1'</span>, <span class="st">'df2'</span>, <span class="st">'df12'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="118">
<div style="float: left; padding: 10px;">
    <p style="font-family:&quot;Courier New&quot;, Courier, monospace">df1</p><div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe caption-top" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header" style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">A</th>
<th data-quarto-table-cell-role="th">B</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">1</td>
<td>A1</td>
<td>B1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2</td>
<td>A2</td>
<td>B2</td>
</tr>
</tbody>
</table>

</div>
    </div>
<div style="float: left; padding: 10px;">
    <p style="font-family:&quot;Courier New&quot;, Courier, monospace">df2</p><div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe caption-top" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header" style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">A</th>
<th data-quarto-table-cell-role="th">B</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">3</td>
<td>A3</td>
<td>B3</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4</td>
<td>A4</td>
<td>B4</td>
</tr>
</tbody>
</table>

</div>
    </div>
<div style="float: left; padding: 10px;">
    <p style="font-family:&quot;Courier New&quot;, Courier, monospace">df12</p><div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe caption-top" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header" style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">A</th>
<th data-quarto-table-cell-role="th">B</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">1</td>
<td>A1</td>
<td>B1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2</td>
<td>A2</td>
<td>B2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3</td>
<td>A3</td>
<td>B3</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4</td>
<td>A4</td>
<td>B4</td>
</tr>
</tbody>
</table>

</div>
    </div>
</div>
</div>
</section>
<section id="concatenation---axis-selection" class="slide level2">
<h2>Concatenation - Axis Selection</h2>
<p>You can concatenate column-wise by <code>axis=1</code></p>
<div id="046773c0" class="cell" data-execution_count="120">
<div class="sourceCode cell-code" id="cb229"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb229-1"><a href=""></a>df3 <span class="op">=</span> make_df(<span class="st">'AB'</span>, [<span class="dv">0</span>, <span class="dv">1</span>])</span>
<span id="cb229-2"><a href=""></a>df4 <span class="op">=</span> make_df(<span class="st">'CD'</span>, [<span class="dv">0</span>, <span class="dv">1</span>])</span>
<span id="cb229-3"><a href=""></a>df5 <span class="op">=</span> pd.concat([df3, df4], axis<span class="op">=</span><span class="dv">1</span>) </span>
<span id="cb229-4"><a href=""></a>display(<span class="st">'df3'</span>, <span class="st">'df4'</span>, <span class="st">'df5'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="119">
<div style="float: left; padding: 10px;">
    <p style="font-family:&quot;Courier New&quot;, Courier, monospace">df3</p><div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe caption-top" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header" style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">A</th>
<th data-quarto-table-cell-role="th">B</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>A0</td>
<td>B0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>A1</td>
<td>B1</td>
</tr>
</tbody>
</table>

</div>
    </div>
<div style="float: left; padding: 10px;">
    <p style="font-family:&quot;Courier New&quot;, Courier, monospace">df4</p><div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe caption-top" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header" style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">C</th>
<th data-quarto-table-cell-role="th">D</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>C0</td>
<td>D0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>C1</td>
<td>D1</td>
</tr>
</tbody>
</table>

</div>
    </div>
<div style="float: left; padding: 10px;">
    <p style="font-family:&quot;Courier New&quot;, Courier, monospace">df5</p><div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe caption-top" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header" style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">A</th>
<th data-quarto-table-cell-role="th">B</th>
<th data-quarto-table-cell-role="th">C</th>
<th data-quarto-table-cell-role="th">D</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>A0</td>
<td>B0</td>
<td>C0</td>
<td>D0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>A1</td>
<td>B1</td>
<td>C1</td>
<td>D1</td>
</tr>
</tbody>
</table>

</div>
    </div>
</div>
</div>
</section>
<section id="concatenation---duplicate-indices" class="slide level2">
<h2>Concatenation - Duplicate Indices</h2>
<p>Pandas preserves indices during concatenation: can result in duplicate indices</p>
<div id="051ded9f" class="cell" data-execution_count="121">
<div class="sourceCode cell-code" id="cb230"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb230-1"><a href=""></a>x <span class="op">=</span> make_df(<span class="st">'AB'</span>, [<span class="dv">0</span>, <span class="dv">1</span>])</span>
<span id="cb230-2"><a href=""></a>y <span class="op">=</span> make_df(<span class="st">'AB'</span>, [<span class="dv">0</span>, <span class="dv">1</span>])</span>
<span id="cb230-3"><a href=""></a>display(<span class="st">'x'</span>, <span class="st">'y'</span>, <span class="st">'pd.concat([x, y])'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="120">
<div style="float: left; padding: 10px;">
    <p style="font-family:&quot;Courier New&quot;, Courier, monospace">x</p><div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe caption-top" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header" style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">A</th>
<th data-quarto-table-cell-role="th">B</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>A0</td>
<td>B0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>A1</td>
<td>B1</td>
</tr>
</tbody>
</table>

</div>
    </div>
<div style="float: left; padding: 10px;">
    <p style="font-family:&quot;Courier New&quot;, Courier, monospace">y</p><div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe caption-top" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header" style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">A</th>
<th data-quarto-table-cell-role="th">B</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>A0</td>
<td>B0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>A1</td>
<td>B1</td>
</tr>
</tbody>
</table>

</div>
    </div>
<div style="float: left; padding: 10px;">
    <p style="font-family:&quot;Courier New&quot;, Courier, monospace">pd.concat([x, y])</p><div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe caption-top" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header" style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">A</th>
<th data-quarto-table-cell-role="th">B</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>A0</td>
<td>B0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>A1</td>
<td>B1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>A0</td>
<td>B0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>A1</td>
<td>B1</td>
</tr>
</tbody>
</table>

</div>
    </div>
</div>
</div>
</section>
<section id="handling-duplicate-indices" class="slide level2">
<h2>Handling Duplicate Indices</h2>
<ol type="1">
<li><strong>Verify integrity</strong>: Raise an error if duplicates exist <code>verify_integrity=True</code></li>
</ol>
<div id="ac11ad62" class="cell" data-execution_count="122">
<div class="sourceCode cell-code" id="cb231"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb231-1"><a href=""></a><span class="cf">try</span>:</span>
<span id="cb231-2"><a href=""></a>    pd.concat([x, y], verify_integrity<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb231-3"><a href=""></a><span class="cf">except</span> <span class="pp">ValueError</span> <span class="im">as</span> e:</span>
<span id="cb231-4"><a href=""></a>    <span class="bu">print</span>(<span class="st">"ValueError:"</span>, e)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>ValueError: Indexes have overlapping values: Index([0, 1], dtype='int64')</code></pre>
</div>
</div>
</section>
<section id="handling-duplicate-indices-1" class="slide level2">
<h2>Handling Duplicate Indices</h2>
<ol start="2" type="1">
<li><strong>Ignore indices</strong>: Create new integer indices</li>
</ol>
<div id="f29c651c" class="cell" data-execution_count="123">
<div class="sourceCode cell-code" id="cb233"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb233-1"><a href=""></a>index2 <span class="op">=</span> pd.concat([x, y], ignore_index<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb233-2"><a href=""></a>display(<span class="st">'x'</span>, <span class="st">'y'</span>, <span class="st">"index2"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="122">
<div style="float: left; padding: 10px;">
    <p style="font-family:&quot;Courier New&quot;, Courier, monospace">x</p><div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe caption-top" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header" style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">A</th>
<th data-quarto-table-cell-role="th">B</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>A0</td>
<td>B0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>A1</td>
<td>B1</td>
</tr>
</tbody>
</table>

</div>
    </div>
<div style="float: left; padding: 10px;">
    <p style="font-family:&quot;Courier New&quot;, Courier, monospace">y</p><div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe caption-top" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header" style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">A</th>
<th data-quarto-table-cell-role="th">B</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>A0</td>
<td>B0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>A1</td>
<td>B1</td>
</tr>
</tbody>
</table>

</div>
    </div>
<div style="float: left; padding: 10px;">
    <p style="font-family:&quot;Courier New&quot;, Courier, monospace">index2</p><div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe caption-top" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header" style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">A</th>
<th data-quarto-table-cell-role="th">B</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>A0</td>
<td>B0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>A1</td>
<td>B1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>A0</td>
<td>B0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>A1</td>
<td>B1</td>
</tr>
</tbody>
</table>

</div>
    </div>
</div>
</div>
</section>
<section id="handling-duplicate-indices-2" class="slide level2">
<h2>Handling Duplicate Indices</h2>
<ol start="3" type="1">
<li><strong>Add hierarchical keys</strong>: Create a MultiIndex to distinguish sources</li>
</ol>
<div id="d188d37e" class="cell" data-execution_count="124">
<div class="sourceCode cell-code" id="cb234"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb234-1"><a href=""></a>index3 <span class="op">=</span> pd.concat([x, y], keys<span class="op">=</span>[<span class="st">'x'</span>, <span class="st">'y'</span>])</span>
<span id="cb234-2"><a href=""></a>display(<span class="st">'x'</span>, <span class="st">'y'</span>, <span class="st">"index3"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="123">
<div style="float: left; padding: 10px;">
    <p style="font-family:&quot;Courier New&quot;, Courier, monospace">x</p><div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe caption-top" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header" style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">A</th>
<th data-quarto-table-cell-role="th">B</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>A0</td>
<td>B0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>A1</td>
<td>B1</td>
</tr>
</tbody>
</table>

</div>
    </div>
<div style="float: left; padding: 10px;">
    <p style="font-family:&quot;Courier New&quot;, Courier, monospace">y</p><div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe caption-top" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header" style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">A</th>
<th data-quarto-table-cell-role="th">B</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>A0</td>
<td>B0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>A1</td>
<td>B1</td>
</tr>
</tbody>
</table>

</div>
    </div>
<div style="float: left; padding: 10px;">
    <p style="font-family:&quot;Courier New&quot;, Courier, monospace">index3</p><div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe caption-top" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header" style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">A</th>
<th data-quarto-table-cell-role="th">B</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td rowspan="2" data-quarto-table-cell-role="th" data-valign="top">x</td>
<td data-quarto-table-cell-role="th">0</td>
<td>A0</td>
<td>B0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>A1</td>
<td>B1</td>
</tr>
<tr class="odd">
<td rowspan="2" data-quarto-table-cell-role="th" data-valign="top">y</td>
<td data-quarto-table-cell-role="th">0</td>
<td>A0</td>
<td>B0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>A1</td>
<td>B1</td>
</tr>
</tbody>
</table>

</div>
    </div>
</div>
</div>
</section>
<section id="concatenation" class="slide level2">
<h2>Concatenation</h2>
<p>When concatenating DataFrames with shared columns</p>
<div id="b78cc5dd" class="cell" data-execution_count="125">
<div class="sourceCode cell-code" id="cb235"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb235-1"><a href=""></a>df5 <span class="op">=</span> make_df(<span class="st">'AB'</span>, [<span class="dv">1</span>, <span class="dv">2</span>])</span>
<span id="cb235-2"><a href=""></a>df6 <span class="op">=</span> make_df(<span class="st">'BC'</span>, [<span class="dv">2</span>, <span class="dv">3</span>])</span>
<span id="cb235-3"><a href=""></a>display(<span class="st">'df5'</span>, <span class="st">'df6'</span>, <span class="st">'pd.concat([df5, df6])'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="124">
<div style="float: left; padding: 10px;">
    <p style="font-family:&quot;Courier New&quot;, Courier, monospace">df5</p><div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe caption-top" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header" style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">A</th>
<th data-quarto-table-cell-role="th">B</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">1</td>
<td>A1</td>
<td>B1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2</td>
<td>A2</td>
<td>B2</td>
</tr>
</tbody>
</table>

</div>
    </div>
<div style="float: left; padding: 10px;">
    <p style="font-family:&quot;Courier New&quot;, Courier, monospace">df6</p><div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe caption-top" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header" style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">B</th>
<th data-quarto-table-cell-role="th">C</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>B2</td>
<td>C2</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>B3</td>
<td>C3</td>
</tr>
</tbody>
</table>

</div>
    </div>
<div style="float: left; padding: 10px;">
    <p style="font-family:&quot;Courier New&quot;, Courier, monospace">pd.concat([df5, df6])</p><div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe caption-top" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header" style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">A</th>
<th data-quarto-table-cell-role="th">B</th>
<th data-quarto-table-cell-role="th">C</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">1</td>
<td>A1</td>
<td>B1</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2</td>
<td>A2</td>
<td>B2</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>NaN</td>
<td>B2</td>
<td>C2</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>NaN</td>
<td>B3</td>
<td>C3</td>
</tr>
</tbody>
</table>

</div>
    </div>
</div>
</div>
</section>
<section id="hands-on---concat-and-append" class="slide level2">
<h2>Hands-on - Concat and Append</h2>
<p>Here is sales data from different regional offices that need to be combined for company-wide analysis.</p>
<div id="56e66274" class="cell" data-execution_count="126">
<div class="sourceCode cell-code" id="cb236"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb236-1"><a href=""></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb236-2"><a href=""></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb236-3"><a href=""></a></span>
<span id="cb236-4"><a href=""></a><span class="co"># Create sales data for different regions</span></span>
<span id="cb236-5"><a href=""></a><span class="kw">def</span> create_sales_data(region, periods, seed<span class="op">=</span><span class="va">None</span>):</span>
<span id="cb236-6"><a href=""></a>    <span class="cf">if</span> seed <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span>:</span>
<span id="cb236-7"><a href=""></a>        np.random.seed(seed)</span>
<span id="cb236-8"><a href=""></a>    </span>
<span id="cb236-9"><a href=""></a>    dates <span class="op">=</span> pd.date_range(start<span class="op">=</span><span class="st">'2025-01-01'</span>, periods<span class="op">=</span>periods)</span>
<span id="cb236-10"><a href=""></a>    products <span class="op">=</span> [<span class="st">'Laptop'</span>, <span class="st">'Phone'</span>, <span class="st">'Tablet'</span>, <span class="st">'Monitor'</span>]</span>
<span id="cb236-11"><a href=""></a>    </span>
<span id="cb236-12"><a href=""></a>    data <span class="op">=</span> {</span>
<span id="cb236-13"><a href=""></a>        <span class="st">'Date'</span>: np.random.choice(dates, size<span class="op">=</span>periods),</span>
<span id="cb236-14"><a href=""></a>        <span class="st">'Product'</span>: np.random.choice(products, size<span class="op">=</span>periods),</span>
<span id="cb236-15"><a href=""></a>        <span class="st">'Units'</span>: np.random.randint(<span class="dv">1</span>, <span class="dv">50</span>, size<span class="op">=</span>periods),</span>
<span id="cb236-16"><a href=""></a>        <span class="st">'Price'</span>: np.random.uniform(<span class="dv">100</span>, <span class="dv">1500</span>, size<span class="op">=</span>periods).<span class="bu">round</span>(<span class="dv">2</span>),</span>
<span id="cb236-17"><a href=""></a>        <span class="st">'Region'</span>: region</span>
<span id="cb236-18"><a href=""></a>    }</span>
<span id="cb236-19"><a href=""></a>    </span>
<span id="cb236-20"><a href=""></a>    df <span class="op">=</span> pd.DataFrame(data)</span>
<span id="cb236-21"><a href=""></a>    df[<span class="st">'Revenue'</span>] <span class="op">=</span> df[<span class="st">'Units'</span>] <span class="op">*</span> df[<span class="st">'Price'</span>]</span>
<span id="cb236-22"><a href=""></a>    <span class="cf">return</span> df</span>
<span id="cb236-23"><a href=""></a></span>
<span id="cb236-24"><a href=""></a><span class="co"># Create regional datasets</span></span>
<span id="cb236-25"><a href=""></a>north_sales <span class="op">=</span> create_sales_data(<span class="st">'North'</span>, <span class="dv">20</span>, seed<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb236-26"><a href=""></a>south_sales <span class="op">=</span> create_sales_data(<span class="st">'South'</span>, <span class="dv">15</span>, seed<span class="op">=</span><span class="dv">43</span>)</span>
<span id="cb236-27"><a href=""></a>east_sales <span class="op">=</span> create_sales_data(<span class="st">'East'</span>, <span class="dv">25</span>, seed<span class="op">=</span><span class="dv">44</span>)</span>
<span id="cb236-28"><a href=""></a>west_sales <span class="op">=</span> create_sales_data(<span class="st">'West'</span>, <span class="dv">18</span>, seed<span class="op">=</span><span class="dv">45</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="hands-on---concat-and-append-1" class="slide level2">
<h2>Hands-on - Concat and Append</h2>
<div id="0509794e" class="cell" data-execution_count="127">
<div class="sourceCode cell-code" id="cb237"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb237-1"><a href=""></a><span class="co"># Display the first few rows of each dataset</span></span>
<span id="cb237-2"><a href=""></a><span class="bu">print</span>(<span class="st">"North Region Sales:"</span>)</span>
<span id="cb237-3"><a href=""></a><span class="bu">print</span>(north_sales.head(<span class="dv">3</span>))</span>
<span id="cb237-4"><a href=""></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">South Region Sales:"</span>)</span>
<span id="cb237-5"><a href=""></a><span class="bu">print</span>(south_sales.head(<span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>North Region Sales:
        Date Product  Units    Price Region   Revenue
0 2025-01-07  Tablet     37  1373.05  North  50802.85
1 2025-01-20  Tablet      7   462.29  North   3236.03
2 2025-01-15  Tablet     21  1027.53  North  21578.13

South Region Sales:
        Date  Product  Units    Price Region   Revenue
0 2025-01-05  Monitor     49   215.50  South  10559.50
1 2025-01-01  Monitor     13  1355.94  South  17627.22
2 2025-01-02   Tablet     25   517.20  South  12930.00</code></pre>
</div>
</div>
</section>
<section id="hands-on---concat-and-append-2" class="slide level2">
<h2>Hands-on - Concat and Append</h2>
<ul>
<li>Combine all regional sales data into a single DataFrame</li>
<li>Reset indices as ‘Date’ in original DataFrames, then perfrom default concatenation (preserves original indices)</li>
<li>When perform concatenation, adding hierarchical keys to track source</li>
</ul>
</section></section>
<section>
<section id="combining-datasets-merge-and-join" class="title-slide slide level1 center">
<h1>Combining Datasets: Merge and Join</h1>

</section>
<section id="relational-algebra-in-pandas" class="slide level2">
<h2>Relational Algebra in Pandas</h2>
<p>Pandas provides high-performance, in-memory join and merge operations through the <code>pd.merge</code> function</p>
<ol type="1">
<li><strong>One-to-one joins</strong>: Combine datasets with unique keys in both DataFrames</li>
<li><strong>Many-to-one joins</strong>: Join when one DataFrame has duplicate keys</li>
<li><strong>Many-to-many joins</strong>: Join when both DataFrames have duplicate keys -&gt; <strong>should be avoided</strong></li>
</ol>
</section>
<section id="basic-join-example" class="slide level2">
<h2>Basic Join Example</h2>
<p>Using the common column as the key.</p>
<div id="f934969c" class="cell" data-execution_count="128">
<div class="sourceCode cell-code" id="cb239"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb239-1"><a href=""></a>df1 <span class="op">=</span> pd.DataFrame({<span class="st">'employee'</span>: [<span class="st">'Bob'</span>, <span class="st">'Jake'</span>, <span class="st">'Lisa'</span>, <span class="st">'Sue'</span>],<span class="st">'group'</span>: [<span class="st">'Accounting'</span>, <span class="st">'Engineering'</span>, <span class="st">'Engineering'</span>, <span class="st">'HR'</span>]})</span>
<span id="cb239-2"><a href=""></a>df2 <span class="op">=</span> pd.DataFrame({<span class="st">'employee'</span>: [<span class="st">'Lisa'</span>, <span class="st">'Bob'</span>, <span class="st">'Jake'</span>, <span class="st">'Sue'</span>],<span class="st">'hire_date'</span>: [<span class="dv">2004</span>, <span class="dv">2008</span>, <span class="dv">2012</span>, <span class="dv">2014</span>]})</span>
<span id="cb239-3"><a href=""></a>dfmerge <span class="op">=</span> pd.merge(df1, df2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="basic-join-example-1" class="slide level2">
<h2>Basic Join Example</h2>
<div id="c0709e0a" class="cell" data-execution_count="129">
<div class="cell-output cell-output-display" data-execution_count="128">
<div style="float: left; padding: 10px;">
    <p style="font-family:&quot;Courier New&quot;, Courier, monospace">df1</p><div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe caption-top" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header" style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">employee</th>
<th data-quarto-table-cell-role="th">group</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Bob</td>
<td>Accounting</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Jake</td>
<td>Engineering</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Lisa</td>
<td>Engineering</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>Sue</td>
<td>HR</td>
</tr>
</tbody>
</table>

</div>
    </div>
<div style="float: left; padding: 10px;">
    <p style="font-family:&quot;Courier New&quot;, Courier, monospace">df2</p><div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe caption-top" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header" style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">employee</th>
<th data-quarto-table-cell-role="th">hire_date</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Lisa</td>
<td>2004</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Bob</td>
<td>2008</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Jake</td>
<td>2012</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>Sue</td>
<td>2014</td>
</tr>
</tbody>
</table>

</div>
    </div>
</div>
</div>
</section>
<section id="basic-join-example-2" class="slide level2">
<h2>Basic Join Example</h2>
<div id="4e73c8cc" class="cell" data-execution_count="130">
<div class="cell-output cell-output-display" data-execution_count="129">
<div style="float: left; padding: 10px;">
    <p style="font-family:&quot;Courier New&quot;, Courier, monospace">dfmerge</p><div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe caption-top" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header" style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">employee</th>
<th data-quarto-table-cell-role="th">group</th>
<th data-quarto-table-cell-role="th">hire_date</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Bob</td>
<td>Accounting</td>
<td>2008</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Jake</td>
<td>Engineering</td>
<td>2012</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Lisa</td>
<td>Engineering</td>
<td>2004</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>Sue</td>
<td>HR</td>
<td>2014</td>
</tr>
</tbody>
</table>

</div>
    </div>
</div>
</div>
</section>
<section id="specifying-merge-keys" class="slide level2">
<h2>Specifying Merge Keys</h2>
<p>Using the <code>on</code> Parameter</p>
<div id="aa3ab87f" class="cell" data-execution_count="131">
<div class="sourceCode cell-code" id="cb240"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb240-1"><a href=""></a>pd.merge(df1, df2, on<span class="op">=</span><span class="st">'employee'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="130">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe caption-top" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header" style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">employee</th>
<th data-quarto-table-cell-role="th">group</th>
<th data-quarto-table-cell-role="th">hire_date</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Bob</td>
<td>Accounting</td>
<td>2008</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Jake</td>
<td>Engineering</td>
<td>2012</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Lisa</td>
<td>Engineering</td>
<td>2004</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>Sue</td>
<td>HR</td>
<td>2014</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="different-column-names" class="slide level2">
<h2>Different Column Names</h2>
<p><code>left_on</code> and <code>right_on</code> Parameter</p>
<div id="bb733e4c" class="cell" data-execution_count="132">
<div class="sourceCode cell-code" id="cb241"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb241-1"><a href=""></a>df3 <span class="op">=</span> pd.DataFrame({<span class="st">'name'</span>: [<span class="st">'Bob'</span>, <span class="st">'Jake'</span>, <span class="st">'Lisa'</span>, <span class="st">'Sue'</span>],</span>
<span id="cb241-2"><a href=""></a>                    <span class="st">'salary'</span>: [<span class="dv">70000</span>, <span class="dv">80000</span>, <span class="dv">120000</span>, <span class="dv">90000</span>]})</span>
<span id="cb241-3"><a href=""></a><span class="bu">print</span>(df1)</span>
<span id="cb241-4"><a href=""></a><span class="bu">print</span>(df3)</span>
<span id="cb241-5"><a href=""></a><span class="bu">print</span>(pd.merge(df1, df3, left_on<span class="op">=</span><span class="st">"employee"</span>, right_on<span class="op">=</span><span class="st">"name"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  employee        group
0      Bob   Accounting
1     Jake  Engineering
2     Lisa  Engineering
3      Sue           HR
   name  salary
0   Bob   70000
1  Jake   80000
2  Lisa  120000
3   Sue   90000
  employee        group  name  salary
0      Bob   Accounting   Bob   70000
1     Jake  Engineering  Jake   80000
2     Lisa  Engineering  Lisa  120000
3      Sue           HR   Sue   90000</code></pre>
</div>
</div>
</section>
<section id="merging-on-index" class="slide level2">
<h2>Merging on Index</h2>
<div id="c816d228" class="cell" data-execution_count="133">
<div class="sourceCode cell-code" id="cb243"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb243-1"><a href=""></a>df1a <span class="op">=</span> df1.set_index(<span class="st">'employee'</span>)</span>
<span id="cb243-2"><a href=""></a>df2a <span class="op">=</span> df2.set_index(<span class="st">'employee'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The DataFrame <code>.join()</code> method provides a shortcut for index-based merges:</p>
<div id="2f4b602a" class="cell" data-execution_count="134">
<div class="sourceCode cell-code" id="cb244"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb244-1"><a href=""></a><span class="bu">print</span>(df1a.join(df2a))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                group  hire_date
employee                        
Bob        Accounting       2008
Jake      Engineering       2012
Lisa      Engineering       2004
Sue                HR       2014</code></pre>
</div>
</div>
</section>
<section id="join-types-inner-join" class="slide level2">
<h2>Join Types: Inner join</h2>
<p><code>how</code> Parameter: <strong>Inner join</strong> (default): Returns only matching rows</p>
<div id="c310e514" class="cell" data-execution_count="135">
<div class="sourceCode cell-code" id="cb246"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb246-1"><a href=""></a>df7 <span class="op">=</span> pd.DataFrame({<span class="st">'name'</span>: [<span class="st">'Peter'</span>, <span class="st">'Paul'</span>, <span class="st">'Mary'</span>],</span>
<span id="cb246-2"><a href=""></a>                    <span class="st">'food'</span>: [<span class="st">'fish'</span>, <span class="st">'beans'</span>, <span class="st">'bread'</span>]},</span>
<span id="cb246-3"><a href=""></a>                   columns<span class="op">=</span>[<span class="st">'name'</span>, <span class="st">'food'</span>])</span>
<span id="cb246-4"><a href=""></a>df8 <span class="op">=</span> pd.DataFrame({<span class="st">'name'</span>: [<span class="st">'Mary'</span>, <span class="st">'Joseph'</span>],</span>
<span id="cb246-5"><a href=""></a>                    <span class="st">'drink'</span>: [<span class="st">'wine'</span>, <span class="st">'beer'</span>]},</span>
<span id="cb246-6"><a href=""></a>                   columns<span class="op">=</span>[<span class="st">'name'</span>, <span class="st">'drink'</span>])</span>
<span id="cb246-7"><a href=""></a>innerpd <span class="op">=</span> pd.merge(df7, df8, how<span class="op">=</span><span class="st">'inner'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="columns">
<div class="column">
<div id="10086605" class="cell" data-execution_count="136">
<div class="cell-output cell-output-stdout">
<pre><code>df7
    name   food
0  Peter   fish
1   Paul  beans
2   Mary  bread</code></pre>
</div>
</div>
</div><div class="column">
<div id="af7eb2f0" class="cell" data-execution_count="137">
<div class="cell-output cell-output-stdout">
<pre><code>df8
     name drink
0    Mary  wine
1  Joseph  beer</code></pre>
</div>
</div>
</div></div>
<div id="3e9b8b67" class="cell" data-execution_count="138">
<div class="cell-output cell-output-stdout">
<pre><code>innerpd
   name   food drink
0  Mary  bread  wine</code></pre>
</div>
</div>
</section>
<section id="join-types-outer-join" class="slide level2">
<h2>Join Types: Outer join</h2>
<p><code>how</code> Parameter: <strong>Outer join</strong>: Returns all rows from both DataFrames, filling missing values with NaN</p>
<div id="46c433ea" class="cell" data-execution_count="139">
<div class="sourceCode cell-code" id="cb250"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb250-1"><a href=""></a>outerpd <span class="op">=</span> pd.merge(df7, df8, how<span class="op">=</span><span class="st">'outer'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="columns">
<div class="column">
<div id="b94a5a69" class="cell" data-execution_count="140">
<div class="cell-output cell-output-stdout">
<pre><code>df7
    name   food
0  Peter   fish
1   Paul  beans
2   Mary  bread</code></pre>
</div>
</div>
</div><div class="column">
<div id="9a45fa5f" class="cell" data-execution_count="141">
<div class="cell-output cell-output-stdout">
<pre><code>df8
     name drink
0    Mary  wine
1  Joseph  beer</code></pre>
</div>
</div>
</div></div>
<div id="f8b8c3eb" class="cell" data-execution_count="142">
<div class="cell-output cell-output-stdout">
<pre><code>outerpd
     name   food drink
0  Joseph    NaN  beer
1    Mary  bread  wine
2    Paul  beans   NaN
3   Peter   fish   NaN</code></pre>
</div>
</div>
</section>
<section id="join-types-left-join" class="slide level2">
<h2>Join Types: Left join</h2>
<p><code>how</code> Parameter: <strong>Left join</strong>: Returns all rows from the left DataFrame</p>
<div id="a9966726" class="cell" data-execution_count="143">
<div class="sourceCode cell-code" id="cb254"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb254-1"><a href=""></a>leftpd <span class="op">=</span> pd.merge(df7, df8, how<span class="op">=</span><span class="st">'left'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="columns">
<div class="column">
<div id="5ce82740" class="cell" data-execution_count="144">
<div class="cell-output cell-output-stdout">
<pre><code>df7
    name   food
0  Peter   fish
1   Paul  beans
2   Mary  bread</code></pre>
</div>
</div>
</div><div class="column">
<div id="744b0226" class="cell" data-execution_count="145">
<div class="cell-output cell-output-stdout">
<pre><code>df8
     name drink
0    Mary  wine
1  Joseph  beer</code></pre>
</div>
</div>
</div></div>
<div id="47115226" class="cell" data-execution_count="146">
<div class="cell-output cell-output-stdout">
<pre><code>leftpd
    name   food drink
0  Peter   fish   NaN
1   Paul  beans   NaN
2   Mary  bread  wine</code></pre>
</div>
</div>
</section>
<section id="join-types-right-join" class="slide level2">
<h2>Join Types: Right join</h2>
<p><code>how</code> Parameter: <strong>Right join</strong>: Returns all rows from the right DataFrame</p>
<div id="9109e68f" class="cell" data-execution_count="147">
<div class="sourceCode cell-code" id="cb258"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb258-1"><a href=""></a>rightpd <span class="op">=</span> pd.merge(df7, df8, how<span class="op">=</span><span class="st">'right'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="columns">
<div class="column">
<div id="e9b8ee03" class="cell" data-execution_count="148">
<div class="cell-output cell-output-stdout">
<pre><code>df7
    name   food
0  Peter   fish
1   Paul  beans
2   Mary  bread</code></pre>
</div>
</div>
</div><div class="column">
<div id="2563ff73" class="cell" data-execution_count="149">
<div class="cell-output cell-output-stdout">
<pre><code>df8
     name drink
0    Mary  wine
1  Joseph  beer</code></pre>
</div>
</div>
</div></div>
<div id="32aa4d89" class="cell" data-execution_count="150">
<div class="cell-output cell-output-stdout">
<pre><code>rightpd
     name   food drink
0    Mary  bread  wine
1  Joseph    NaN  beer</code></pre>
</div>
</div>
</section>
<section id="handling-duplicate-column-names" class="slide level2">
<h2>Handling Duplicate Column Names</h2>
<p>When DataFrames have conflicting column names, Pandas adds suffixes:</p>
<div id="12dd372f" class="cell" data-execution_count="151">
<div class="sourceCode cell-code" id="cb262"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb262-1"><a href=""></a><span class="co"># Default suffixes (_x and _y)</span></span>
<span id="cb262-2"><a href=""></a>df9 <span class="op">=</span> pd.DataFrame({<span class="st">'name'</span>: [<span class="st">'Bob'</span>, <span class="st">'Jake'</span>, <span class="st">'Lisa'</span>, <span class="st">'Sue'</span>],</span>
<span id="cb262-3"><a href=""></a>                    <span class="st">'rank'</span>: [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>]})</span>
<span id="cb262-4"><a href=""></a>df10 <span class="op">=</span> pd.DataFrame({<span class="st">'name'</span>: [<span class="st">'Bob'</span>, <span class="st">'Jake'</span>, <span class="st">'Lisa'</span>, <span class="st">'Sue'</span>],</span>
<span id="cb262-5"><a href=""></a>                    <span class="st">'rank'</span>: [<span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">2</span>]})</span>
<span id="cb262-6"><a href=""></a>pd.merge(df9, df10, on<span class="op">=</span><span class="st">"name"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="150">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe caption-top" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header" style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">name</th>
<th data-quarto-table-cell-role="th">rank_x</th>
<th data-quarto-table-cell-role="th">rank_y</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Bob</td>
<td>1</td>
<td>3</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Jake</td>
<td>2</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Lisa</td>
<td>3</td>
<td>4</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>Sue</td>
<td>4</td>
<td>2</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="handling-duplicate-column-names-1" class="slide level2">
<h2>Handling Duplicate Column Names</h2>
<p>Custom suffixes with <code>suffixes</code> parameter</p>
<div id="d6577777" class="cell" data-execution_count="152">
<div class="sourceCode cell-code" id="cb263"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb263-1"><a href=""></a><span class="co"># Custom suffixes</span></span>
<span id="cb263-2"><a href=""></a>pd.merge(df9, df10, on<span class="op">=</span><span class="st">"name"</span>, suffixes<span class="op">=</span>[<span class="st">"_L"</span>, <span class="st">"_R"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="151">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe caption-top" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header" style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">name</th>
<th data-quarto-table-cell-role="th">rank_L</th>
<th data-quarto-table-cell-role="th">rank_R</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Bob</td>
<td>1</td>
<td>3</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Jake</td>
<td>2</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Lisa</td>
<td>3</td>
<td>4</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>Sue</td>
<td>4</td>
<td>2</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="hands-on-us-states-data" class="slide level2">
<h2>Hands-on: US States Data</h2>
<div id="1d8c73c7" class="cell" data-execution_count="153">
<div class="sourceCode cell-code" id="cb264"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb264-1"><a href=""></a><span class="im">import</span> ssl</span>
<span id="cb264-2"><a href=""></a>ssl._create_default_https_context <span class="op">=</span> ssl._create_unverified_context</span>
<span id="cb264-3"><a href=""></a>pop_url <span class="op">=</span> <span class="st">"https://raw.githubusercontent.com/jakevdp/data-USstates/master/state-population.csv"</span></span>
<span id="cb264-4"><a href=""></a>area_url <span class="op">=</span> <span class="st">"https://raw.githubusercontent.com/jakevdp/data-USstates/master/state-areas.csv"</span></span>
<span id="cb264-5"><a href=""></a>abb_url <span class="op">=</span> <span class="st">"https://raw.githubusercontent.com/jakevdp/data-USstates/master/state-abbrevs.csv"</span></span>
<span id="cb264-6"><a href=""></a>pop <span class="op">=</span> pd.read_csv(pop_url)</span>
<span id="cb264-7"><a href=""></a>areas <span class="op">=</span> pd.read_csv(area_url)</span>
<span id="cb264-8"><a href=""></a>abbrevs <span class="op">=</span> pd.read_csv(abb_url)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="hands-on-us-states-data-1" class="slide level2">
<h2>Hands-on: US States Data</h2>
<div class="columns">
<div class="column">
<div id="a12272a1" class="cell" data-execution_count="154">
<div class="cell-output cell-output-stdout">
<pre><code>pop.head()
  state/region     ages  year  population
0           AL  under18  2012   1117489.0
1           AL    total  2012   4817528.0
2           AL  under18  2010   1130966.0
3           AL    total  2010   4785570.0
4           AL  under18  2011   1125763.0</code></pre>
</div>
</div>
</div><div class="column">
<div id="8eed0029" class="cell" data-execution_count="155">
<div class="cell-output cell-output-stdout">
<pre><code>areas.head()
        state  area (sq. mi)
0     Alabama          52423
1      Alaska         656425
2     Arizona         114006
3    Arkansas          53182
4  California         163707</code></pre>
</div>
</div>
</div><div class="column">
<div id="c97ac866" class="cell" data-execution_count="156">
<div class="cell-output cell-output-stdout">
<pre><code>abbrevs.head()
        state abbreviation
0     Alabama           AL
1      Alaska           AK
2     Arizona           AZ
3    Arkansas           AR
4  California           CA</code></pre>
</div>
</div>
</div></div>
</section>
<section id="hands-on-us-states-data-2" class="slide level2">
<h2>Hands-on: US States Data</h2>
<p>Merge multiple datasets to calculate population density:</p>
<ol type="1">
<li>Merge population data <code>pop</code> with state abbreviations <code>abbrevs</code></li>
<li>Handle missing values and mismatches (?)</li>
<li>Merge with area data <code>areas</code></li>
<li>Calculate and rank US states and territories by their 2010 population density</li>
</ol>
</section>
<section id="hint-q2-pr" class="slide level2">
<h2>Hint Q2 PR</h2>
<div id="4002e380" class="cell" data-execution_count="157">
<div class="sourceCode cell-code" id="cb268"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb268-1"><a href=""></a><span class="bu">print</span>(pop.query(<span class="st">"`state/region`  == 'PR'"</span>).head())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     state/region     ages  year  population
2448           PR  under18  1990         NaN
2449           PR    total  1990         NaN
2450           PR    total  1991         NaN
2451           PR  under18  1991         NaN
2452           PR    total  1993         NaN</code></pre>
</div>
</div>
<p>Do we have PR in <code>abbrevs</code> table?</p>
<div id="d657db29" class="cell" data-execution_count="158">
<div class="sourceCode cell-code" id="cb270"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb270-1"><a href=""></a>abbrevs.query(<span class="st">"abbreviation == 'PR'"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="157">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe caption-top" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header" style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">state</th>
<th data-quarto-table-cell-role="th">abbreviation</th>
</tr>
</thead>
<tbody>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="hint-for-q4-.query" class="slide level2">
<h2>Hint for Q4 <code>.query()</code></h2>
<div id="821c9361" class="cell" data-execution_count="159">
<div class="sourceCode cell-code" id="cb271"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb271-1"><a href=""></a>pop2010 <span class="op">=</span> pop.query(<span class="st">"year == 2010 &amp; ages == 'total'"</span>)</span>
<span id="cb271-2"><a href=""></a>pop2010.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="158">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe caption-top" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header" style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">state/region</th>
<th data-quarto-table-cell-role="th">ages</th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">population</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">3</td>
<td>AL</td>
<td>total</td>
<td>2010</td>
<td>4785570.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">91</td>
<td>AK</td>
<td>total</td>
<td>2010</td>
<td>713868.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">101</td>
<td>AZ</td>
<td>total</td>
<td>2010</td>
<td>6408790.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">189</td>
<td>AR</td>
<td>total</td>
<td>2010</td>
<td>2922280.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">197</td>
<td>CA</td>
<td>total</td>
<td>2010</td>
<td>37333601.0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="hint-for-q4-sort" class="slide level2">
<h2>Hint for Q4 Sort</h2>
<p><code>df.sort_values(by='column name', ascending=False)</code></p>
<div id="a549ca32" class="cell" data-execution_count="160">
<div class="sourceCode cell-code" id="cb272"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb272-1"><a href=""></a>pop2010.sort_values(by<span class="op">=</span><span class="st">'population'</span>,ascending<span class="op">=</span><span class="va">False</span>).head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="159">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe caption-top" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header" style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">state/region</th>
<th data-quarto-table-cell-role="th">ages</th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">population</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">2539</td>
<td>USA</td>
<td>total</td>
<td>2010</td>
<td>309326295.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">197</td>
<td>CA</td>
<td>total</td>
<td>2010</td>
<td>37333601.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2106</td>
<td>TX</td>
<td>total</td>
<td>2010</td>
<td>25245178.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1541</td>
<td>NY</td>
<td>total</td>
<td>2010</td>
<td>19398228.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">475</td>
<td>FL</td>
<td>total</td>
<td>2010</td>
<td>18846054.0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section></section>
<section>
<section id="aggregation-and-grouping-in-pandas" class="title-slide slide level1 center">
<h1>Aggregation and Grouping in Pandas</h1>

</section>
<section id="basic-aggregation" class="slide level2">
<h2>Basic Aggregation</h2>
<p>For DataFrames, aggregations operate on each column (collapse rows)</p>
<div id="e5197205" class="cell" data-execution_count="161">
<div class="sourceCode cell-code" id="cb273"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb273-1"><a href=""></a>df <span class="op">=</span> pd.DataFrame({<span class="st">'A'</span>: [<span class="fl">0.16</span>, <span class="fl">0.06</span>, <span class="fl">0.87</span>, <span class="fl">0.60</span>, <span class="fl">0.71</span>],</span>
<span id="cb273-2"><a href=""></a>                   <span class="st">'B'</span>: [<span class="fl">0.02</span>, <span class="fl">0.97</span>, <span class="fl">0.83</span>, <span class="fl">0.21</span>, <span class="fl">0.18</span>]})</span>
<span id="cb273-3"><a href=""></a><span class="bu">print</span>(df)</span>
<span id="cb273-4"><a href=""></a>df.mean()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      A     B
0  0.16  0.02
1  0.06  0.97
2  0.87  0.83
3  0.60  0.21
4  0.71  0.18</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="160">
<pre><code>A    0.480
B    0.442
dtype: float64</code></pre>
</div>
</div>
<p>Use axis parameter to aggregate across rows instead (collapse columns)</p>
<div id="bade4ab3" class="cell" data-execution_count="162">
<div class="sourceCode cell-code" id="cb276"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb276-1"><a href=""></a>df.mean(axis<span class="op">=</span><span class="st">'columns'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="161">
<pre><code>0    0.090
1    0.515
2    0.850
3    0.405
4    0.445
dtype: float64</code></pre>
</div>
</div>
</section>
<section id="basic-aggregation-describe" class="slide level2">
<h2>Basic Aggregation <code>describe()</code></h2>
<p>quick statistical summary of your data: <code>describe()</code></p>
<div id="fc0e1787" class="cell" data-execution_count="163">
<div class="sourceCode cell-code" id="cb278"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb278-1"><a href=""></a>planets <span class="op">=</span> sns.load_dataset(<span class="st">'planets'</span>)</span>
<span id="cb278-2"><a href=""></a><span class="bu">print</span>(planets.dropna().describe())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          number  orbital_period        mass    distance         year
count  498.00000      498.000000  498.000000  498.000000   498.000000
mean     1.73494      835.778671    2.509320   52.068213  2007.377510
std      1.17572     1469.128259    3.636274   46.596041     4.167284
min      1.00000        1.328300    0.003600    1.350000  1989.000000
25%      1.00000       38.272250    0.212500   24.497500  2005.000000
50%      1.00000      357.000000    1.245000   39.940000  2009.000000
75%      2.00000      999.600000    2.867500   59.332500  2011.000000
max      6.00000    17337.500000   25.000000  354.000000  2014.000000</code></pre>
</div>
</div>
</section>
<section id="groupby-split-apply-combine" class="slide level2">
<h2>GroupBy: Split, Apply, Combine</h2>
<p><code>.groupby()</code> for more sophisticated data analysis by:</p>
<ol type="1">
<li><p><strong>Splitting</strong> data into groups based on some criteria</p></li>
<li><p><strong>Applying</strong> a function to each group independently</p></li>
<li><p><strong>Combining</strong> the results into a data structure</p></li>
</ol>
</section>
<section id="groupby-split-apply-combine-1" class="slide level2">
<h2>GroupBy: Split, Apply, Combine</h2>
<p><img data-src="https://jakevdp.github.io/PythonDataScienceHandbook/figures/03.08-split-apply-combine.png"> <a href="https://jakevdp.github.io/PythonDataScienceHandbook/">Source</a></p>
</section>
<section id="groupby-split-apply-combine-2" class="slide level2">
<h2>GroupBy: Split, Apply, Combine</h2>
<div id="45ea624b" class="cell" data-execution_count="164">
<div class="sourceCode cell-code" id="cb280"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb280-1"><a href=""></a>df <span class="op">=</span> pd.DataFrame({<span class="st">'key'</span>: [<span class="st">'A'</span>, <span class="st">'B'</span>, <span class="st">'C'</span>, <span class="st">'A'</span>, <span class="st">'B'</span>, <span class="st">'C'</span>],</span>
<span id="cb280-2"><a href=""></a>                   <span class="st">'data'</span>: <span class="bu">range</span>(<span class="dv">6</span>)})</span>
<span id="cb280-3"><a href=""></a><span class="bu">print</span>(df)</span>
<span id="cb280-4"><a href=""></a><span class="bu">print</span>(df.groupby(<span class="st">'key'</span>).<span class="bu">sum</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  key  data
0   A     0
1   B     1
2   C     2
3   A     3
4   B     4
5   C     5
     data
key      
A       3
B       5
C       7</code></pre>
</div>
</div>
</section>
<section id="working-with-groupby-objects" class="slide level2">
<h2>Working with GroupBy Objects</h2>
<p><strong>Dispatch Methods</strong>: Apply DataFrame methods to each group</p>
<div id="1438d785" class="cell" data-execution_count="165">
<div class="sourceCode cell-code" id="cb282"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb282-1"><a href=""></a>df <span class="op">=</span> planets.groupby(<span class="st">'method'</span>)[<span class="st">'year'</span>].describe()</span>
<span id="cb282-2"><a href=""></a><span class="bu">print</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                               count         mean       std     min      25%  \
method                                                                         
Astrometry                       2.0  2011.500000  2.121320  2010.0  2010.75   
Eclipse Timing Variations        9.0  2010.000000  1.414214  2008.0  2009.00   
Imaging                         38.0  2009.131579  2.781901  2004.0  2008.00   
Microlensing                    23.0  2009.782609  2.859697  2004.0  2008.00   
Orbital Brightness Modulation    3.0  2011.666667  1.154701  2011.0  2011.00   
Pulsar Timing                    5.0  1998.400000  8.384510  1992.0  1992.00   
Pulsation Timing Variations      1.0  2007.000000       NaN  2007.0  2007.00   
Radial Velocity                553.0  2007.518987  4.249052  1989.0  2005.00   
Transit                        397.0  2011.236776  2.077867  2002.0  2010.00   
Transit Timing Variations        4.0  2012.500000  1.290994  2011.0  2011.75   

                                  50%      75%     max  
method                                                  
Astrometry                     2011.5  2012.25  2013.0  
Eclipse Timing Variations      2010.0  2011.00  2012.0  
Imaging                        2009.0  2011.00  2013.0  
Microlensing                   2010.0  2012.00  2013.0  
Orbital Brightness Modulation  2011.0  2012.00  2013.0  
Pulsar Timing                  1994.0  2003.00  2011.0  
Pulsation Timing Variations    2007.0  2007.00  2007.0  
Radial Velocity                2009.0  2011.00  2014.0  
Transit                        2012.0  2013.00  2014.0  
Transit Timing Variations      2012.5  2013.25  2014.0  </code></pre>
</div>
</div>
</section>
<section id="advanced-groupby-operations" class="slide level2">
<h2>Advanced GroupBy Operations</h2>
<div id="14c2b9eb" class="cell" data-execution_count="166">
<div class="sourceCode cell-code" id="cb284"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb284-1"><a href=""></a>df <span class="op">=</span> pd.DataFrame({<span class="st">'key'</span>: [<span class="st">'A'</span>, <span class="st">'B'</span>, <span class="st">'C'</span>, <span class="st">'A'</span>, <span class="st">'B'</span>, <span class="st">'C'</span>],</span>
<span id="cb284-2"><a href=""></a>                   <span class="st">'data1'</span>: <span class="bu">range</span>(<span class="dv">6</span>),</span>
<span id="cb284-3"><a href=""></a>                   <span class="st">'data2'</span>: rng.randint(<span class="dv">0</span>, <span class="dv">10</span>, <span class="dv">6</span>)},</span>
<span id="cb284-4"><a href=""></a>                   columns <span class="op">=</span> [<span class="st">'key'</span>, <span class="st">'data1'</span>, <span class="st">'data2'</span>])</span>
<span id="cb284-5"><a href=""></a><span class="bu">print</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  key  data1  data2
0   A      0      8
1   B      1      8
2   C      2      1
3   A      3      6
4   B      4      7
5   C      5      7</code></pre>
</div>
</div>
</section>
<section id="groupby-operations---aggregation" class="slide level2">
<h2>GroupBy Operations - Aggregation</h2>
<p><strong>Aggregation</strong>: Multiple aggregations at once.</p>
<div id="9376a878" class="cell" data-execution_count="167">
<div class="sourceCode cell-code" id="cb286"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb286-1"><a href=""></a>df.groupby(<span class="st">'key'</span>).aggregate([<span class="st">'min'</span>, <span class="st">'median'</span>, <span class="st">'max'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="166">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>

<table class="dataframe caption-top" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th colspan="3" data-quarto-table-cell-role="th" data-halign="left">data1</th>
<th colspan="3" data-quarto-table-cell-role="th" data-halign="left">data2</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">min</th>
<th data-quarto-table-cell-role="th">median</th>
<th data-quarto-table-cell-role="th">max</th>
<th data-quarto-table-cell-role="th">min</th>
<th data-quarto-table-cell-role="th">median</th>
<th data-quarto-table-cell-role="th">max</th>
</tr>
<tr class="header">
<th data-quarto-table-cell-role="th">key</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">A</td>
<td>0</td>
<td>1.5</td>
<td>3</td>
<td>6</td>
<td>7.0</td>
<td>8</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">B</td>
<td>1</td>
<td>2.5</td>
<td>4</td>
<td>7</td>
<td>7.5</td>
<td>8</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">C</td>
<td>2</td>
<td>3.5</td>
<td>5</td>
<td>1</td>
<td>4.0</td>
<td>7</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="groupby-operations---aggregation-1" class="slide level2">
<h2>GroupBy Operations - Aggregation</h2>
<p>Different aggregations per column</p>
<div id="3397e5da" class="cell" data-execution_count="168">
<div class="sourceCode cell-code" id="cb287"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb287-1"><a href=""></a>df.groupby(<span class="st">'key'</span>).aggregate({<span class="st">'data1'</span>: <span class="st">'min'</span>, <span class="st">'data2'</span>: <span class="st">'max'</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="167">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe caption-top" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header" style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">data1</th>
<th data-quarto-table-cell-role="th">data2</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">key</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">A</td>
<td>0</td>
<td>8</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">B</td>
<td>1</td>
<td>8</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">C</td>
<td>2</td>
<td>7</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="groupby-operations---filtering" class="slide level2">
<h2>GroupBy Operations - Filtering</h2>
<p><strong>Filtering</strong>: Keep only groups that satisfy a condition</p>
<div id="ee194d28" class="cell" data-execution_count="169">
<div class="sourceCode cell-code" id="cb288"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb288-1"><a href=""></a><span class="kw">def</span> filter_func(x):</span>
<span id="cb288-2"><a href=""></a>    <span class="cf">return</span> x[<span class="st">'data2'</span>].std() <span class="op">&gt;</span> <span class="dv">4</span></span>
<span id="cb288-3"><a href=""></a>agg_df <span class="op">=</span> df.groupby(<span class="st">'key'</span>).<span class="bu">filter</span>(filter_func)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="columns">
<div class="column">
<div id="92445bc8" class="cell" data-execution_count="170">
<div class="cell-output cell-output-stdout">
<pre><code>df
  key  data1  data2
0   A      0      8
1   B      1      8
2   C      2      1
3   A      3      6
4   B      4      7
5   C      5      7
None</code></pre>
</div>
</div>
</div><div class="column">
<div id="511bc71c" class="cell" data-execution_count="171">
<div class="cell-output cell-output-stdout">
<pre><code>agg_df
  key  data1  data2
2   C      2      1
5   C      5      7
None</code></pre>
</div>
</div>
</div></div>
</section>
<section id="groupby-operations---transformation" class="slide level2">
<h2>GroupBy Operations - Transformation</h2>
<p><strong>Transformation</strong>: Apply a transformation that preserves the input shape</p>
<div id="2384446c" class="cell" data-execution_count="172">
<div class="sourceCode cell-code" id="cb291"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb291-1"><a href=""></a>trans_df <span class="op">=</span> df.groupby(<span class="st">'key'</span>).transform(<span class="kw">lambda</span> x: x <span class="op">-</span> x.mean())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="columns">
<div class="column">
<div id="42fdd632" class="cell" data-execution_count="173">
<div class="cell-output cell-output-stdout">
<pre><code>df
  key  data1  data2
0   A      0      8
1   B      1      8
2   C      2      1
3   A      3      6
4   B      4      7
5   C      5      7
None</code></pre>
</div>
</div>
</div><div class="column">
<div id="8a0511e1" class="cell" data-execution_count="174">
<div class="cell-output cell-output-stdout">
<pre><code>trans_df
   data1  data2
0   -1.5    1.0
1   -1.5    0.5
2   -1.5   -3.0
3    1.5   -1.0
4    1.5   -0.5
5    1.5    3.0
None</code></pre>
</div>
</div>
</div></div>
</section>
<section id="groupby-operations---apply" class="slide level2">
<h2>GroupBy Operations - Apply</h2>
<p><strong>Apply</strong>: Apply arbitrary functions to each group</p>
<div id="49b3ffcc" class="cell" data-execution_count="175">
<div class="sourceCode cell-code" id="cb294"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb294-1"><a href=""></a><span class="kw">def</span> norm_by_data2(x):</span>
<span id="cb294-2"><a href=""></a>    <span class="co"># x is a DataFrame of group values</span></span>
<span id="cb294-3"><a href=""></a>    x[<span class="st">'data1'</span>] <span class="op">/=</span> x[<span class="st">'data2'</span>].<span class="bu">sum</span>()</span>
<span id="cb294-4"><a href=""></a>    <span class="cf">return</span> x</span>
<span id="cb294-5"><a href=""></a>app_df <span class="op">=</span> df.groupby(<span class="st">'key'</span>).<span class="bu">apply</span>(norm_by_data2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="columns">
<div class="column">
<div id="bd7b400e" class="cell" data-execution_count="176">
<div class="cell-output cell-output-stdout">
<pre><code>df
  key  data1  data2
0   A      0      8
1   B      1      8
2   C      2      1
3   A      3      6
4   B      4      7
5   C      5      7
None</code></pre>
</div>
</div>
</div><div class="column">
<div id="66b2a3ec" class="cell" data-execution_count="177">
<div class="cell-output cell-output-stdout">
<pre><code>app_df
      key     data1  data2
key                       
A   0   A  0.000000      8
    3   A  0.214286      6
B   1   B  0.066667      8
    4   B  0.266667      7
C   2   C  0.250000      1
    5   C  0.625000      7
None</code></pre>
</div>
</div>
</div></div>
</section>
<section id="practical-example---groupby" class="slide level2">
<h2>Practical Example - Groupby</h2>
<p>Analyzing planet discovery methods by decade</p>
<div id="6c27f2a6" class="cell" data-execution_count="178">
<div class="sourceCode cell-code" id="cb297"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb297-1"><a href=""></a>decade <span class="op">=</span> <span class="dv">10</span> <span class="op">*</span> (planets[<span class="st">'year'</span>] <span class="op">//</span> <span class="dv">10</span>)</span>
<span id="cb297-2"><a href=""></a>decade <span class="op">=</span> decade.astype(<span class="bu">str</span>) <span class="op">+</span> <span class="st">'s'</span></span>
<span id="cb297-3"><a href=""></a>planets[<span class="st">'decade'</span>] <span class="op">=</span> decade</span>
<span id="cb297-4"><a href=""></a><span class="bu">print</span>(planets)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>               method  number  orbital_period   mass  distance  year decade
0     Radial Velocity       1      269.300000   7.10     77.40  2006  2000s
1     Radial Velocity       1      874.774000   2.21     56.95  2008  2000s
2     Radial Velocity       1      763.000000   2.60     19.84  2011  2010s
3     Radial Velocity       1      326.030000  19.40    110.62  2007  2000s
4     Radial Velocity       1      516.220000  10.50    119.47  2009  2000s
...               ...     ...             ...    ...       ...   ...    ...
1030          Transit       1        3.941507    NaN    172.00  2006  2000s
1031          Transit       1        2.615864    NaN    148.00  2007  2000s
1032          Transit       1        3.191524    NaN    174.00  2007  2000s
1033          Transit       1        4.125083    NaN    293.00  2008  2000s
1034          Transit       1        4.187757    NaN    260.00  2008  2000s

[1035 rows x 7 columns]</code></pre>
</div>
</div>
</section>
<section id="practical-example---groupby-1" class="slide level2">
<h2>Practical Example - Groupby</h2>
<div id="ea3f9746" class="cell" data-execution_count="179">
<div class="sourceCode cell-code" id="cb299"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb299-1"><a href=""></a>planets.groupby([<span class="st">'method'</span>, <span class="st">'decade'</span>])[<span class="st">'number'</span>].<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="178">
<pre><code>method                         decade
Astrometry                     2010s       2
Eclipse Timing Variations      2000s       5
                               2010s      10
Imaging                        2000s      29
                               2010s      21
Microlensing                   2000s      12
                               2010s      15
Orbital Brightness Modulation  2010s       5
Pulsar Timing                  1990s       9
                               2000s       1
                               2010s       1
Pulsation Timing Variations    2000s       1
Radial Velocity                1980s       1
                               1990s      52
                               2000s     475
                               2010s     424
Transit                        2000s      64
                               2010s     712
Transit Timing Variations      2010s       9
Name: number, dtype: int64</code></pre>
</div>
</div>
</section>
<section id="practical-example---groupby-2" class="slide level2">
<h2>Practical Example - Groupby</h2>
<p><code>.unstack()</code></p>
<div id="0a2b3d58" class="cell" data-execution_count="180">
<div class="sourceCode cell-code" id="cb301"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb301-1"><a href=""></a>unstack_df <span class="op">=</span> planets.groupby([<span class="st">'method'</span>, <span class="st">'decade'</span>])[<span class="st">'number'</span>].<span class="bu">sum</span>().unstack().fillna(<span class="dv">0</span>)</span>
<span id="cb301-2"><a href=""></a><span class="bu">print</span>(unstack_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>decade                         1980s  1990s  2000s  2010s
method                                                   
Astrometry                       0.0    0.0    0.0    2.0
Eclipse Timing Variations        0.0    0.0    5.0   10.0
Imaging                          0.0    0.0   29.0   21.0
Microlensing                     0.0    0.0   12.0   15.0
Orbital Brightness Modulation    0.0    0.0    0.0    5.0
Pulsar Timing                    0.0    9.0    1.0    1.0
Pulsation Timing Variations      0.0    0.0    1.0    0.0
Radial Velocity                  1.0   52.0  475.0  424.0
Transit                          0.0    0.0   64.0  712.0
Transit Timing Variations        0.0    0.0    0.0    9.0</code></pre>
</div>
</div>
</section>
<section id="pivot-tables-in-pandas" class="slide level2">
<h2>Pivot Tables in Pandas</h2>
<p>Pivot tables are a powerful data analysis tool that provide multidimensional summarization of data. They can be thought of as a <strong>multidimensional version</strong> of GroupBy aggregation.</p>
<ul>
<li>Transforms column-wise data into a two-dimensional table</li>
<li>Allows for multiple levels of indices and columns</li>
<li>Supports various aggregation functions</li>
</ul>
</section>
<section id="example-titanic-dataset" class="slide level2">
<h2>Example: Titanic Dataset</h2>
<div id="6b7b1065" class="cell" data-execution_count="181">
<div class="sourceCode cell-code" id="cb303"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb303-1"><a href=""></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb303-2"><a href=""></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb303-3"><a href=""></a>titanic <span class="op">=</span> sns.load_dataset(<span class="st">'titanic'</span>)</span>
<span id="cb303-4"><a href=""></a><span class="bu">print</span>(titanic)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     survived  pclass     sex   age  sibsp  parch     fare embarked   class  \
0           0       3    male  22.0      1      0   7.2500        S   Third   
1           1       1  female  38.0      1      0  71.2833        C   First   
2           1       3  female  26.0      0      0   7.9250        S   Third   
3           1       1  female  35.0      1      0  53.1000        S   First   
4           0       3    male  35.0      0      0   8.0500        S   Third   
..        ...     ...     ...   ...    ...    ...      ...      ...     ...   
886         0       2    male  27.0      0      0  13.0000        S  Second   
887         1       1  female  19.0      0      0  30.0000        S   First   
888         0       3  female   NaN      1      2  23.4500        S   Third   
889         1       1    male  26.0      0      0  30.0000        C   First   
890         0       3    male  32.0      0      0   7.7500        Q   Third   

       who  adult_male deck  embark_town alive  alone  
0      man        True  NaN  Southampton    no  False  
1    woman       False    C    Cherbourg   yes  False  
2    woman       False  NaN  Southampton   yes   True  
3    woman       False    C  Southampton   yes  False  
4      man        True  NaN  Southampton    no   True  
..     ...         ...  ...          ...   ...    ...  
886    man        True  NaN  Southampton    no   True  
887  woman       False    B  Southampton   yes   True  
888  woman       False  NaN  Southampton    no  False  
889    man        True    C    Cherbourg   yes   True  
890    man        True  NaN   Queenstown    no   True  

[891 rows x 15 columns]</code></pre>
</div>
</div>
</section>
<section id="titanic-dataset---basic-pivot-table" class="slide level2">
<h2>Titanic Dataset - Basic pivot table</h2>
<p>Default: <code>aggfunc='mean'</code></p>
<div id="9187ccc1" class="cell" data-execution_count="182">
<div class="sourceCode cell-code" id="cb305"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb305-1"><a href=""></a>survival_by_class <span class="op">=</span> titanic.pivot_table(<span class="st">'survived'</span>, index<span class="op">=</span><span class="st">'sex'</span>, columns<span class="op">=</span><span class="st">'class'</span>)</span>
<span id="cb305-2"><a href=""></a><span class="bu">print</span>(survival_by_class)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>class      First    Second     Third
sex                                 
female  0.968085  0.921053  0.500000
male    0.368852  0.157407  0.135447</code></pre>
</div>
</div>
</section>
<section id="titanic-dataset---multi-level" class="slide level2">
<h2>Titanic Dataset - Multi-level</h2>
<div id="9b00033b" class="cell" data-execution_count="183">
<div class="sourceCode cell-code" id="cb307"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb307-1"><a href=""></a>age_groups <span class="op">=</span> pd.cut(titanic[<span class="st">'age'</span>], [<span class="dv">0</span>, <span class="dv">18</span>, <span class="dv">80</span>])</span>
<span id="cb307-2"><a href=""></a>survival_by_age_class <span class="op">=</span> titanic.pivot_table(<span class="st">'survived'</span>, [<span class="st">'sex'</span>, age_groups], <span class="st">'class'</span>)</span>
<span id="cb307-3"><a href=""></a><span class="bu">print</span>(survival_by_age_class)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>class               First    Second     Third
sex    age                                   
female (0, 18]   0.909091  1.000000  0.511628
       (18, 80]  0.972973  0.900000  0.423729
male   (0, 18]   0.800000  0.600000  0.215686
       (18, 80]  0.375000  0.071429  0.133663</code></pre>
</div>
</div>
</section>
<section id="additional-options" class="slide level2">
<h2>Additional Options</h2>
<ul>
<li><code>aggfunc</code>: Specify aggregation function (e.g., ‘sum’, ‘mean’, ‘count’)</li>
<li><code>fill_value</code>: Replace missing values</li>
<li><code>margins</code>: Add row/column totals</li>
<li><code>dropna</code>: Remove rows with missing values</li>
</ul>
</section>
<section id="practical-application-us-birth-data" class="slide level2">
<h2>Practical Application: US Birth Data</h2>
<div id="3b4fdeb5" class="cell" data-execution_count="184">
<div class="sourceCode cell-code" id="cb309"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb309-1"><a href=""></a>births <span class="op">=</span> pd.read_csv(<span class="st">'https://raw.githubusercontent.com/jakevdp/data-CDCbirths/master/births.csv'</span>)</span>
<span id="cb309-2"><a href=""></a>births[<span class="st">'decade'</span>] <span class="op">=</span> <span class="dv">10</span> <span class="op">*</span> (births[<span class="st">'year'</span>] <span class="op">//</span> <span class="dv">10</span>)</span>
<span id="cb309-3"><a href=""></a><span class="bu">print</span>(births)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       year  month  day gender  births  decade
0      1969      1  1.0      F    4046    1960
1      1969      1  1.0      M    4440    1960
2      1969      1  2.0      F    4454    1960
3      1969      1  2.0      M    4548    1960
4      1969      1  3.0      F    4548    1960
...     ...    ...  ...    ...     ...     ...
15542  2008     10  NaN      M  183219    2000
15543  2008     11  NaN      F  158939    2000
15544  2008     11  NaN      M  165468    2000
15545  2008     12  NaN      F  173215    2000
15546  2008     12  NaN      M  181235    2000

[15547 rows x 6 columns]</code></pre>
</div>
</div>
</section>
<section id="practical-application-us-birth-data-1" class="slide level2">
<h2>Practical Application: US Birth Data</h2>
<p>Analyze births by decade and gender</p>
<div id="8dd1876b" class="cell" data-execution_count="185">
<div class="sourceCode cell-code" id="cb311"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb311-1"><a href=""></a>births_by_decade <span class="op">=</span> births.pivot_table(<span class="st">'births'</span>, index<span class="op">=</span><span class="st">'decade'</span>, </span>
<span id="cb311-2"><a href=""></a>                              columns<span class="op">=</span><span class="st">'gender'</span>, aggfunc<span class="op">=</span><span class="st">'sum'</span>)</span>
<span id="cb311-3"><a href=""></a><span class="bu">print</span>(births_by_decade)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>gender         F         M
decade                    
1960     1753634   1846572
1970    16263075  17121550
1980    18310351  19243452
1990    19479454  20420553
2000    18229309  19106428</code></pre>
</div>
</div>
</section>
<section id="practical-application-us-birth-data-2" class="slide level2">
<h2>Practical Application: US Birth Data</h2>
<p>Visualize trends</p>
<div id="839a2b1a" class="cell" data-execution_count="186">
<div class="sourceCode cell-code" id="cb313"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb313-1"><a href=""></a>births_by_decade.plot()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src="6_pandas_files/figure-revealjs/cell-187-output-1.png" width="802" height="443"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="hands-on-aggregation" class="slide level2">
<h2>Hands-on: Aggregation</h2>
<div id="dd0684e7" class="cell" data-execution_count="187">
<div class="sourceCode cell-code" id="cb314"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb314-1"><a href=""></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb314-2"><a href=""></a><span class="co"># Download the data</span></span>
<span id="cb314-3"><a href=""></a>births <span class="op">=</span> pd.read_csv(<span class="st">'https://raw.githubusercontent.com/jakevdp/data-CDCbirths/master/births.csv'</span>)</span>
<span id="cb314-4"><a href=""></a>births[<span class="st">'decade'</span>] <span class="op">=</span> <span class="dv">10</span> <span class="op">*</span> (births[<span class="st">'year'</span>] <span class="op">//</span> <span class="dv">10</span>)</span>
<span id="cb314-5"><a href=""></a><span class="bu">print</span>(births.head())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   year  month  day gender  births  decade
0  1969      1  1.0      F    4046    1960
1  1969      1  1.0      M    4440    1960
2  1969      1  2.0      F    4454    1960
3  1969      1  2.0      M    4548    1960
4  1969      1  3.0      F    4548    1960</code></pre>
</div>
</div>
</section>
<section id="hands-on-aggregation-1" class="slide level2">
<h2>Hands-on: Aggregation</h2>
<ul>
<li>Group the data by gender and calculate the total number of births for each gender.</li>
<li>Group by both year and gender, then sum the births.</li>
<li>Filter out years where the total number of births (all genders combined) was less than 3 million.</li>
<li>Create a pivot table with decade as rows, gender as columns, and the sum of births as values.</li>
<li>Create a pivot table showing the average number of births per month for each gender.</li>
</ul>
</section></section>
<section>
<section id="working-with-time-series-in-pandas" class="title-slide slide level1 center">
<h1>Working with Time Series in Pandas</h1>

</section>
<section id="types-of-time-data" class="slide level2">
<h2>Types of Time Data</h2>
<p>Pandas provides extensive tools for working with time-based data, reflecting its origins in financial modeling:</p>
<ul>
<li><strong>Time stamps</strong>: Reference specific moments (e.g., July 4th, 2015 at 7:00am)</li>
<li><strong>Time intervals/periods</strong>: Reference lengths of time between points (e.g., the year 2015)</li>
<li><strong>Time deltas/durations</strong>: Reference exact time lengths (e.g., 22.56 seconds)</li>
</ul>
</section>
<section id="native-python-datetime" class="slide level2">
<h2>Native Python (datetime)</h2>
<div id="c8b64de5" class="cell" data-execution_count="188">
<div class="sourceCode cell-code" id="cb316"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb316-1"><a href=""></a><span class="im">from</span> datetime <span class="im">import</span> datetime</span>
<span id="cb316-2"><a href=""></a>datetime(year<span class="op">=</span><span class="dv">2015</span>, month<span class="op">=</span><span class="dv">7</span>, day<span class="op">=</span><span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="187">
<pre><code>datetime.datetime(2015, 7, 4, 0, 0)</code></pre>
</div>
</div>
</section>
<section id="numpys-datetime64" class="slide level2">
<h2>NumPy’s datetime64</h2>
<div id="42424ee6" class="cell" data-execution_count="189">
<div class="sourceCode cell-code" id="cb318"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb318-1"><a href=""></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb318-2"><a href=""></a>date <span class="op">=</span> np.array(<span class="st">'2015-07-04'</span>, dtype<span class="op">=</span>np.datetime64)</span>
<span id="cb318-3"><a href=""></a>date <span class="op">+</span> np.arange(<span class="dv">12</span>)  <span class="co"># Array of consecutive dates</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="188">
<pre><code>array(['2015-07-04', '2015-07-05', '2015-07-06', '2015-07-07',
       '2015-07-08', '2015-07-09', '2015-07-10', '2015-07-11',
       '2015-07-12', '2015-07-13', '2015-07-14', '2015-07-15'],
      dtype='datetime64[D]')</code></pre>
</div>
</div>
</section>
<section id="pandas-time-objects" class="slide level2">
<h2>Pandas Time Objects</h2>
<p>Pandas combines the ease-of-use of datetime with the efficiency of numpy.datetime64:</p>
<div id="1cb8e9f4" class="cell" data-execution_count="190">
<div class="sourceCode cell-code" id="cb320"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb320-1"><a href=""></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb320-2"><a href=""></a>date <span class="op">=</span> pd.to_datetime(<span class="st">"4th of July, 2015"</span>)</span>
<span id="cb320-3"><a href=""></a>date.strftime(<span class="st">'%A'</span>)  <span class="co"># 'Saturday'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="189">
<pre><code>'Saturday'</code></pre>
</div>
</div>
</section>
<section id="parameters-for-date.strftime" class="slide level2">
<h2>Parameters for date.strftime</h2>
<p><a href="https://strftime.org/">Ref</a></p>
<table class="caption-top">
<colgroup>
<col style="width: 8%">
<col style="width: 68%">
<col style="width: 23%">
</colgroup>
<thead>
<tr class="header">
<th>Code</th>
<th>Description</th>
<th>Example</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>%a</code></td>
<td>Abbreviated weekday name</td>
<td>Sun, Mon, …</td>
</tr>
<tr class="even">
<td><code>%A</code></td>
<td>Full weekday name</td>
<td>Sunday, Monday, …</td>
</tr>
<tr class="odd">
<td><code>%w</code></td>
<td>Weekday as a decimal number (0=Sunday, 6=Saturday)</td>
<td>0, 1, …, 6</td>
</tr>
<tr class="even">
<td><code>%d</code></td>
<td>Day of the month (zero-padded)</td>
<td>01, 02, …, 31</td>
</tr>
<tr class="odd">
<td><code>%b</code></td>
<td>Abbreviated month name</td>
<td>Jan, Feb, …, Dec</td>
</tr>
<tr class="even">
<td><code>%B</code></td>
<td>Full month name</td>
<td>January, February, …</td>
</tr>
<tr class="odd">
<td><code>%m</code></td>
<td>Month as a zero-padded decimal number</td>
<td>01, 02, …, 12</td>
</tr>
</tbody>
</table>
</section>
<section id="pandas-time-series-data-structures" class="slide level2">
<h2>Pandas Time Series Data Structures</h2>
<ul>
<li><strong>Timestamp</strong>: Replacement for Python’s datetime</li>
<li><strong>DatetimeIndex</strong>: Index structure for timestamps</li>
<li><strong>Period/PeriodIndex</strong>: For fixed-frequency time intervals</li>
<li><strong>Timedelta/TimedeltaIndex</strong>: For time durations</li>
</ul>
</section>
<section id="creating-date-ranges" class="slide level2">
<h2>Creating Date Ranges</h2>
<p>Daily frequency (default)</p>
<div id="44fb04a5" class="cell" data-execution_count="191">
<div class="sourceCode cell-code" id="cb322"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb322-1"><a href=""></a>pd.date_range(<span class="st">'2015-07-03'</span>, <span class="st">'2015-07-10'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="190">
<pre><code>DatetimeIndex(['2015-07-03', '2015-07-04', '2015-07-05', '2015-07-06',
               '2015-07-07', '2015-07-08', '2015-07-09', '2015-07-10'],
              dtype='datetime64[ns]', freq='D')</code></pre>
</div>
</div>
<p>Hourly frequency</p>
<div id="e6cc2d78" class="cell" data-execution_count="192">
<div class="sourceCode cell-code" id="cb324"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb324-1"><a href=""></a>pd.date_range(<span class="st">'2015-07-03'</span>, periods<span class="op">=</span><span class="dv">8</span>, freq<span class="op">=</span><span class="st">'h'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="191">
<pre><code>DatetimeIndex(['2015-07-03 00:00:00', '2015-07-03 01:00:00',
               '2015-07-03 02:00:00', '2015-07-03 03:00:00',
               '2015-07-03 04:00:00', '2015-07-03 05:00:00',
               '2015-07-03 06:00:00', '2015-07-03 07:00:00'],
              dtype='datetime64[ns]', freq='h')</code></pre>
</div>
</div>
</section>
<section id="creating-date-ranges-1" class="slide level2">
<h2>Creating Date Ranges</h2>
<p>Monthly periods</p>
<div id="0b8d98de" class="cell" data-execution_count="193">
<div class="sourceCode cell-code" id="cb326"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb326-1"><a href=""></a>pd.period_range(<span class="st">'2015-07'</span>, periods<span class="op">=</span><span class="dv">8</span>, freq<span class="op">=</span><span class="st">'M'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="192">
<pre><code>PeriodIndex(['2015-07', '2015-08', '2015-09', '2015-10', '2015-11', '2015-12',
             '2016-01', '2016-02'],
            dtype='period[M]')</code></pre>
</div>
</div>
</section>
<section id="time-series-indexing" class="slide level2">
<h2>Time Series Indexing</h2>
<div id="2806b67d" class="cell" data-execution_count="194">
<div class="sourceCode cell-code" id="cb328"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb328-1"><a href=""></a>index <span class="op">=</span> pd.DatetimeIndex([<span class="st">'2014-07-04'</span>, <span class="st">'2014-08-04'</span>, </span>
<span id="cb328-2"><a href=""></a>                          <span class="st">'2015-07-04'</span>, <span class="st">'2015-08-04'</span>])</span>
<span id="cb328-3"><a href=""></a>data <span class="op">=</span> pd.Series([<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>], index<span class="op">=</span>index)</span>
<span id="cb328-4"><a href=""></a><span class="bu">print</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>2014-07-04    0
2014-08-04    1
2015-07-04    2
2015-08-04    3
dtype: int64</code></pre>
</div>
</div>
</section>
<section id="time-series-indexing-1" class="slide level2">
<h2>Time Series Indexing</h2>
<p>Slice by date range</p>
<div id="3519084b" class="cell" data-execution_count="195">
<div class="sourceCode cell-code" id="cb330"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb330-1"><a href=""></a>data[<span class="st">'2014-07-04'</span>:<span class="st">'2015-07-04'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="194">
<pre><code>2014-07-04    0
2014-08-04    1
2015-07-04    2
dtype: int64</code></pre>
</div>
</div>
<p>Slice by year</p>
<div id="0804e036" class="cell" data-execution_count="196">
<div class="sourceCode cell-code" id="cb332"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb332-1"><a href=""></a>data[<span class="st">'2015'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="195">
<pre><code>2015-07-04    2
2015-08-04    3
dtype: int64</code></pre>
</div>
</div>
</section>
<section id="sample-dataset" class="slide level2">
<h2>Sample dataset</h2>
<div id="7c27db28" class="cell" data-execution_count="197">
<div class="sourceCode cell-code" id="cb334"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb334-1"><a href=""></a><span class="co">#!pip3 install yfinance</span></span>
<span id="cb334-2"><a href=""></a><span class="im">import</span> yfinance <span class="im">as</span> yf</span>
<span id="cb334-3"><a href=""></a>dat <span class="op">=</span> yf.Ticker(<span class="st">"MSFT"</span>)</span>
<span id="cb334-4"><a href=""></a>MSFT <span class="op">=</span> dat.history(period<span class="op">=</span><span class="st">'1y'</span>)</span>
<span id="cb334-5"><a href=""></a><span class="bu">print</span>(MSFT.head())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                 Open        High         Low       Close  \
Date                                                                        
2024-04-18 00:00:00-04:00  407.518767  408.769230  400.889387  401.206940   
2024-04-19 00:00:00-04:00  400.968749  402.407775  394.756170  396.095947   
2024-04-22 00:00:00-04:00  397.048690  399.797722  392.751511  397.922028   
2024-04-23 00:00:00-04:00  401.177147  405.107165  400.006095  404.481934   
2024-04-24 00:00:00-04:00  406.456844  409.344799  403.697909  405.960632   

                             Volume  Dividends  Stock Splits  
Date                                                          
2024-04-18 00:00:00-04:00  21029900        0.0           0.0  
2024-04-19 00:00:00-04:00  30276500        0.0           0.0  
2024-04-22 00:00:00-04:00  20286900        0.0           0.0  
2024-04-23 00:00:00-04:00  15734500        0.0           0.0  
2024-04-24 00:00:00-04:00  15065300        0.0           0.0  </code></pre>
</div>
</div>
</section>
<section id="frequency-and-offset-codes" class="slide level2">
<h2>Frequency and Offset Codes</h2>
<p>Common frequency codes:</p>
<div class="columns">
<div class="column">
<ul>
<li><code>D</code>: Calendar day</li>
<li><code>B</code>: Business day</li>
<li><code>W</code>: Weekly</li>
<li><code>ME</code>: Month end</li>
</ul>
</div><div class="column">
<ul>
<li><code>QE</code>: Quarter end</li>
<li><code>YE</code>: Year end</li>
<li><code>h</code>: Hours</li>
<li><code>min</code>: Minutes</li>
</ul>
</div></div>
</section>
<section id="time-series-operations---resampling" class="slide level2">
<h2>Time Series Operations - Resampling</h2>
<p>Mean for each year</p>
<div id="464cf084" class="cell" data-execution_count="198">
<div class="sourceCode cell-code" id="cb336"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb336-1"><a href=""></a>year_m <span class="op">=</span> MSFT.resample(<span class="st">'YE'</span>).mean()  </span>
<span id="cb336-2"><a href=""></a><span class="bu">print</span>(year_m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                 Open        High         Low       Close  \
Date                                                                        
2024-12-31 00:00:00-05:00  423.652237  427.011666  419.834055  423.567488   
2025-12-31 00:00:00-05:00  401.307662  405.918905  396.764436  401.620719   

                                 Volume  Dividends  Stock Splits  
Date                                                              
2024-12-31 00:00:00-05:00  2.005319e+07    0.01309           0.0  
2025-12-31 00:00:00-05:00  2.437956e+07    0.01137           0.0  </code></pre>
</div>
</div>
</section>
<section id="time-series-operations---resampling-1" class="slide level2">
<h2>Time Series Operations - Resampling</h2>
<p>Mean for each Quarter/bussiness day</p>
<div id="7247031f" class="cell" data-execution_count="199">
<div class="sourceCode cell-code" id="cb338"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb338-1"><a href=""></a>qua_m <span class="op">=</span> MSFT.resample(<span class="st">'BQE'</span>).mean()  </span>
<span id="cb338-2"><a href=""></a><span class="bu">print</span>(qua_m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                 Open        High         Low       Close  \
Date                                                                        
2024-06-28 00:00:00-04:00  419.559026  422.749021  416.104721  419.923304   
2024-09-30 00:00:00-04:00  426.013002  429.233255  421.579908  425.369853   
2024-12-31 00:00:00-05:00  424.489294  428.120269  421.001744  424.612142   
2025-03-31 00:00:00-04:00  407.206487  410.963002  403.117229  407.256542   
2025-06-30 00:00:00-04:00  374.082313  382.638461  367.443850  375.609229   

                                 Volume  Dividends  Stock Splits  
Date                                                              
2024-06-28 00:00:00-04:00  1.954418e+07   0.015000           0.0  
2024-09-30 00:00:00-04:00  1.983265e+07   0.011719           0.0  
2024-12-31 00:00:00-05:00  2.067139e+07   0.012969           0.0  
2025-03-31 00:00:00-04:00  2.311330e+07   0.013833           0.0  
2025-06-30 00:00:00-04:00  3.022383e+07   0.000000           0.0  </code></pre>
</div>
</div>
</section>
<section id="time-series-operations---resampling-2" class="slide level2">
<h2>Time Series Operations - Resampling</h2>
<p>Value at end of each year</p>
<div id="ff962367" class="cell" data-execution_count="200">
<div class="sourceCode cell-code" id="cb340"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb340-1"><a href=""></a>year_v <span class="op">=</span> MSFT.asfreq(<span class="st">'YE'</span>)  </span>
<span id="cb340-2"><a href=""></a><span class="bu">print</span>(year_v)</span>
<span id="cb340-3"><a href=""></a>year_c <span class="op">=</span> MSFT.resample(<span class="st">'YE'</span>).count()  </span>
<span id="cb340-4"><a href=""></a><span class="bu">print</span>(year_c)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                 Open       High         Low       Close  \
Date                                                                       
2024-12-31 00:00:00-05:00  425.247326  425.87607  419.818209  420.656525   

                             Volume  Dividends  Stock Splits  
Date                                                          
2024-12-31 00:00:00-05:00  13246500        0.0           0.0  
                           Open  High  Low  Close  Volume  Dividends  \
Date                                                                   
2024-12-31 00:00:00-05:00   178   178  178    178     178        178   
2025-12-31 00:00:00-05:00    73    73   73     73      73         73   

                           Stock Splits  
Date                                     
2024-12-31 00:00:00-05:00           178  
2025-12-31 00:00:00-05:00            73  </code></pre>
</div>
</div>
</section>
<section id="time-series-operations---time-shifting" class="slide level2">
<h2>Time Series Operations - Time-shifting</h2>
<div id="fd10f256" class="cell" data-execution_count="201">
<div class="sourceCode cell-code" id="cb342"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb342-1"><a href=""></a><span class="co"># Shift data values</span></span>
<span id="cb342-2"><a href=""></a><span class="bu">print</span>(MSFT.head())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                 Open        High         Low       Close  \
Date                                                                        
2024-04-18 00:00:00-04:00  407.518767  408.769230  400.889387  401.206940   
2024-04-19 00:00:00-04:00  400.968749  402.407775  394.756170  396.095947   
2024-04-22 00:00:00-04:00  397.048690  399.797722  392.751511  397.922028   
2024-04-23 00:00:00-04:00  401.177147  405.107165  400.006095  404.481934   
2024-04-24 00:00:00-04:00  406.456844  409.344799  403.697909  405.960632   

                             Volume  Dividends  Stock Splits  
Date                                                          
2024-04-18 00:00:00-04:00  21029900        0.0           0.0  
2024-04-19 00:00:00-04:00  30276500        0.0           0.0  
2024-04-22 00:00:00-04:00  20286900        0.0           0.0  
2024-04-23 00:00:00-04:00  15734500        0.0           0.0  
2024-04-24 00:00:00-04:00  15065300        0.0           0.0  </code></pre>
</div>
</div>
</section>
<section id="time-series-operations---time-shifting-1" class="slide level2">
<h2>Time Series Operations - Time-shifting</h2>
<div id="ae99d84d" class="cell" data-execution_count="202">
<div class="sourceCode cell-code" id="cb344"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb344-1"><a href=""></a><span class="co"># Shift data values</span></span>
<span id="cb344-2"><a href=""></a><span class="bu">print</span>(MSFT.shift(<span class="dv">3</span>).head())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                 Open        High         Low       Close  \
Date                                                                        
2024-04-18 00:00:00-04:00         NaN         NaN         NaN         NaN   
2024-04-19 00:00:00-04:00         NaN         NaN         NaN         NaN   
2024-04-22 00:00:00-04:00         NaN         NaN         NaN         NaN   
2024-04-23 00:00:00-04:00  407.518767  408.769230  400.889387  401.206940   
2024-04-24 00:00:00-04:00  400.968749  402.407775  394.756170  396.095947   

                               Volume  Dividends  Stock Splits  
Date                                                            
2024-04-18 00:00:00-04:00         NaN        NaN           NaN  
2024-04-19 00:00:00-04:00         NaN        NaN           NaN  
2024-04-22 00:00:00-04:00         NaN        NaN           NaN  
2024-04-23 00:00:00-04:00  21029900.0        0.0           0.0  
2024-04-24 00:00:00-04:00  30276500.0        0.0           0.0  </code></pre>
</div>
</div>
</section>
<section id="time-series-operations---rolling-windows" class="slide level2">
<h2>Time Series Operations - Rolling Windows</h2>
<p>monthly Rolling mean</p>
<div id="06959630" class="cell" data-execution_count="203">
<div class="sourceCode cell-code" id="cb346"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb346-1"><a href=""></a>y_rolling <span class="op">=</span> MSFT.rolling(<span class="dv">30</span>)</span>
<span id="cb346-2"><a href=""></a>y_r_mean <span class="op">=</span> y_rolling.mean().tail()</span>
<span id="cb346-3"><a href=""></a><span class="bu">print</span>(y_r_mean)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                 Open        High         Low       Close  \
Date                                                                        
2025-04-11 00:00:00-04:00  381.971336  388.460665  377.236003  383.687998   
2025-04-14 00:00:00-04:00  381.784669  388.321664  377.171002  383.665332   
2025-04-15 00:00:00-04:00  381.955003  388.298665  377.276336  383.569333   
2025-04-16 00:00:00-04:00  381.666003  387.629998  376.582669  382.588999   
2025-04-17 00:00:00-04:00  380.981670  386.702332  375.723003  381.618666   

                                 Volume  Dividends  Stock Splits  
Date                                                              
2025-04-11 00:00:00-04:00  2.684446e+07        0.0           0.0  
2025-04-14 00:00:00-04:00  2.671924e+07        0.0           0.0  
2025-04-15 00:00:00-04:00  2.631448e+07        0.0           0.0  
2025-04-16 00:00:00-04:00  2.626563e+07        0.0           0.0  
2025-04-17 00:00:00-04:00  2.618694e+07        0.0           0.0  </code></pre>
</div>
</div>
</section>
<section id="time-series-operations---rolling-windows-1" class="slide level2">
<h2>Time Series Operations - Rolling Windows</h2>
<p>weekly Rolling mean</p>
<div id="7e7dbb2f" class="cell" data-execution_count="204">
<div class="sourceCode cell-code" id="cb348"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb348-1"><a href=""></a>w_rolling <span class="op">=</span> MSFT.rolling(<span class="dv">7</span>)</span>
<span id="cb348-2"><a href=""></a>w_r_mean <span class="op">=</span> w_rolling.mean().tail()  <span class="co"># </span></span>
<span id="cb348-3"><a href=""></a><span class="bu">print</span>(w_r_mean)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                 Open        High         Low       Close  \
Date                                                                        
2025-04-11 00:00:00-04:00  367.757150  380.557142  360.522862  372.237139   
2025-04-14 00:00:00-04:00  370.390006  383.009997  362.645717  374.337141   
2025-04-15 00:00:00-04:00  373.872864  385.481428  366.171430  378.035714   
2025-04-16 00:00:00-04:00  378.128579  386.997140  369.487143  380.000000   
2025-04-17 00:00:00-04:00  378.912864  387.092856  371.864288  381.888572   

                                 Volume  Dividends  Stock Splits  
Date                                                              
2025-04-11 00:00:00-04:00  3.968073e+07        0.0           0.0  
2025-04-14 00:00:00-04:00  3.811690e+07        0.0           0.0  
2025-04-15 00:00:00-04:00  3.354404e+07        0.0           0.0  
2025-04-16 00:00:00-04:00  2.947873e+07        0.0           0.0  
2025-04-17 00:00:00-04:00  2.734656e+07        0.0           0.0  </code></pre>
</div>
</div>
</section>
<section id="hands-on---time-and-pandas" class="slide level2">
<h2>Hands-on - Time and Pandas</h2>
<div id="78cc5a88" class="cell" data-execution_count="205">
<div class="sourceCode cell-code" id="cb350"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb350-1"><a href=""></a><span class="co"># Create a DataFrame with COVID-19 data for the last 5 days</span></span>
<span id="cb350-2"><a href=""></a>dates <span class="op">=</span> pd.date_range(end<span class="op">=</span><span class="st">'2023-04-30'</span>, periods<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb350-3"><a href=""></a>data <span class="op">=</span> {</span>
<span id="cb350-4"><a href=""></a>    <span class="st">'United States'</span>: [<span class="dv">45000</span>, <span class="dv">42000</span>, <span class="dv">38000</span>, <span class="dv">41000</span>, <span class="dv">39000</span>],</span>
<span id="cb350-5"><a href=""></a>    <span class="st">'India'</span>: [<span class="dv">12000</span>, <span class="dv">13500</span>, <span class="dv">14200</span>, <span class="dv">13800</span>, <span class="dv">12500</span>],</span>
<span id="cb350-6"><a href=""></a>    <span class="st">'Brazil'</span>: [<span class="dv">9800</span>, <span class="dv">9200</span>, <span class="dv">8700</span>, <span class="dv">9100</span>, <span class="dv">9500</span>],</span>
<span id="cb350-7"><a href=""></a>    <span class="st">'France'</span>: [<span class="dv">7500</span>, <span class="dv">7200</span>, <span class="dv">6800</span>, <span class="dv">6500</span>, <span class="dv">6200</span>],</span>
<span id="cb350-8"><a href=""></a>    <span class="st">'Germany'</span>: [<span class="dv">5200</span>, <span class="dv">4800</span>, <span class="dv">4600</span>, <span class="dv">4900</span>, <span class="dv">5100</span>]</span>
<span id="cb350-9"><a href=""></a>}</span>
<span id="cb350-10"><a href=""></a></span>
<span id="cb350-11"><a href=""></a>daily_cases <span class="op">=</span> pd.DataFrame(data, index<span class="op">=</span>dates)</span>
<span id="cb350-12"><a href=""></a>daily_cases.index.name <span class="op">=</span> <span class="st">'Date'</span></span>
<span id="cb350-13"><a href=""></a>daily_cases.columns.name <span class="op">=</span> <span class="st">'Country'</span></span>
<span id="cb350-14"><a href=""></a><span class="bu">print</span>(<span class="st">"Daily New COVID-19 Cases:"</span>)</span>
<span id="cb350-15"><a href=""></a><span class="bu">print</span>(daily_cases)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Daily New COVID-19 Cases:
Country     United States  India  Brazil  France  Germany
Date                                                     
2023-04-26          45000  12000    9800    7500     5200
2023-04-27          42000  13500    9200    7200     4800
2023-04-28          38000  14200    8700    6800     4600
2023-04-29          41000  13800    9100    6500     4900
2023-04-30          39000  12500    9500    6200     5100</code></pre>
</div>
</div>
</section>
<section id="hands-on---time-and-pandas-1" class="slide level2">
<h2>Hands-on - Time and Pandas</h2>
<ul>
<li>Select and print the case numbers for India between ‘2023-04-27’ and ‘2023-04-29’ (inclusive).</li>
<li>Calculate the daily change (difference) in cases for Brazil.</li>
<li>Resample the data to a weekly frequency and calculate the mean for each country. (Hint: <code>.resample('W').mean()</code>)</li>
<li>Showing the 3-day moving average of cases for each country</li>
<li>For each country, identify the date with the highest number of new cases.</li>
</ul>
<div class="quarto-auto-generated-content">
<div class="footer footer-default">

</div>
</div>
</section></section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="6_pandas_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="6_pandas_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="6_pandas_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="6_pandas_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="6_pandas_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="6_pandas_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="6_pandas_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="6_pandas_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="6_pandas_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="6_pandas_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const onCopySuccess = function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      }
      const getTextToCopy = function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
        text: getTextToCopy
      });
      clipboard.on('success', onCopySuccess);
      if (window.document.getElementById('quarto-embedded-source-code-modal')) {
        // For code content inside modals, clipBoardJS needs to be initialized with a container option
        // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
        const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
          text: getTextToCopy,
          container: window.document.getElementById('quarto-embedded-source-code-modal')
        });
        clipboardModal.on('success', onCopySuccess);
      }
        var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
        var mailtoRegex = new RegExp(/^mailto:/);
          var filterRegex = new RegExp('/' + window.location.host + '/');
        var isInternal = (href) => {
            return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
        }
        // Inspect non-navigation links and adorn them if external
     	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
        for (var i=0; i<links.length; i++) {
          const link = links[i];
          if (!isInternal(link.href)) {
            // undo the damage that might have been done by quarto-nav.js in the case of
            // links that we want to consider external
            if (link.dataset.originalHref !== undefined) {
              link.href = link.dataset.originalHref;
            }
          }
        }
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note) {
            return note.innerHTML;
          } else {
            return "";
          }
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>