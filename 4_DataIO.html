<!DOCTYPE html>
<html lang="en"><head>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="4_DataIO_files/libs/clipboard/clipboard.min.js"></script>
<script src="4_DataIO_files/libs/quarto-html/tabby.min.js"></script>
<script src="4_DataIO_files/libs/quarto-html/popper.min.js"></script>
<script src="4_DataIO_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="4_DataIO_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="4_DataIO_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href="4_DataIO_files/libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="4_DataIO_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.5.57">

  <meta name="author" content="Yi-Ju Tseng">
  <title>4. Data I/O</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="4_DataIO_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="4_DataIO_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; font-weight: bold; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="4_DataIO_files/libs/revealjs/dist/theme/quarto.css">
  <link href="4_DataIO_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="4_DataIO_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="4_DataIO_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="4_DataIO_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    padding-bottom: 0.5rem;
    margin-bottom: 0;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
  
  <script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">4. Data I/O</h1>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Yi-Ju Tseng 
</div>
</div>
</div>

</section>
<section id="data-input-and-output" class="slide level2">
<h2>Data input and output</h2>
<ul>
<li>Data input
<ul>
<li>From file</li>
<li>From google drive</li>
<li>From API</li>
<li>Webscrapping</li>
</ul></li>
<li>Data output</li>
</ul>
</section>
<section id="前置作業" class="slide level2">
<h2>前置作業</h2>
<p>為了成功從https (加密封包傳輸)下載資料，首先取消證書驗證</p>
<div id="ac880797" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href=""></a><span class="im">import</span> ssl</span>
<span id="cb1-2"><a href=""></a>ssl._create_default_https_context <span class="op">=</span> ssl._create_unverified_context</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="data-input-and-output-1" class="slide level2">
<h2>Data input and output</h2>
<ul>
<li><strong>Data input</strong>
<ul>
<li><strong>From file</strong></li>
<li>From google drive</li>
<li>From API</li>
<li>Webscrapping</li>
</ul></li>
<li>Data output</li>
</ul>
</section>
<section>
<section id="from-file" class="title-slide slide level1 center">
<h1>From File</h1>

</section>
<section id="from-file-1" class="slide level2">
<h2>From File</h2>
<ul>
<li>.csv 逗號分隔格式檔案</li>
<li>.xls Excel格式檔案</li>
<li>純文字資料</li>
<li>其他格式</li>
</ul>
</section>
<section id="csv-逗號分隔格式檔案" class="slide level2">
<h2>.csv 逗號分隔格式檔案</h2>
<ul>
<li>.csv 為逗號分隔格式檔案</li>
<li><code>pandas</code>的<code>read_csv(路徑)</code>，將檔案匯入</li>
<li>路徑可以是<em>本機端路徑</em>，也可以是<em>網址</em></li>
</ul>
<div id="7adb6745" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href=""></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb2-2"><a href=""></a>url <span class="op">=</span> <span class="st">"https://quality.data.gov.tw//dq_download_csv.php?nid=102775&amp;md5_url=ea56d6e1f2642b2c5c44f9e8b6185d54"</span></span>
<span id="cb2-3"><a href=""></a>df_csv <span class="op">=</span> pd.read_csv(url)</span>
<span id="cb2-4"><a href=""></a>df_csv.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="44">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe caption-top" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header" style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">停車場型態</th>
<th data-quarto-table-cell-role="th">停車場代碼</th>
<th data-quarto-table-cell-role="th">停車場名稱</th>
<th data-quarto-table-cell-role="th">停車場地址</th>
<th data-quarto-table-cell-role="th">停車場電話</th>
<th data-quarto-table-cell-role="th">即時車位</th>
<th data-quarto-table-cell-role="th">一般大型車</th>
<th data-quarto-table-cell-role="th">一般小型車</th>
<th data-quarto-table-cell-role="th">身障者小型車</th>
<th data-quarto-table-cell-role="th">婦幼者小型車</th>
<th data-quarto-table-cell-role="th">綠能小型車</th>
<th data-quarto-table-cell-role="th">一般機車</th>
<th data-quarto-table-cell-role="th">身障者機車</th>
<th data-quarto-table-cell-role="th">小型車充電樁</th>
<th data-quarto-table-cell-role="th">收費時間</th>
<th data-quarto-table-cell-role="th">收費費率</th>
<th data-quarto-table-cell-role="th">經緯度</th>
<th data-quarto-table-cell-role="th">備註欄</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>公有免費停車場</td>
<td>044</td>
<td>佳里停1公有停車場</td>
<td>臺南市佳里區安西路與文化路交叉口</td>
<td>2138172</td>
<td>-1</td>
<td>0</td>
<td>11</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>23.16238，120.1714</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>公有免費停車場</td>
<td>045</td>
<td>佳里停2公有停車場</td>
<td>臺南市佳里區文化路與公園路交叉口</td>
<td>2138172</td>
<td>-1</td>
<td>0</td>
<td>8</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>23.16293，120.17216</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>公有免費停車場</td>
<td>100</td>
<td>停2立體停車場</td>
<td>臺南市新市區環東路1段與南科二路</td>
<td>NaN</td>
<td>-1</td>
<td>0</td>
<td>417</td>
<td>6</td>
<td>0</td>
<td>0</td>
<td>70</td>
<td>2</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>23.096305，120.284649</td>
<td>南科管理局</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>公有免費停車場</td>
<td>101</td>
<td>管理局地下停車場</td>
<td>臺南市新市區環東路1段與南科三路</td>
<td>NaN</td>
<td>-1</td>
<td>0</td>
<td>402</td>
<td>14</td>
<td>0</td>
<td>0</td>
<td>467</td>
<td>6</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>23.101229，120.282238</td>
<td>南科管理局</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>公有免費停車場</td>
<td>102</td>
<td>管理局戶外平面停車場</td>
<td>臺南市新市區環東路1段</td>
<td>NaN</td>
<td>-1</td>
<td>0</td>
<td>227</td>
<td>2</td>
<td>0</td>
<td>0</td>
<td>46</td>
<td>0</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>23.102632，120.283831</td>
<td>南科管理局</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="csv-逗號分隔格式檔案-1" class="slide level2">
<h2>.csv 逗號分隔格式檔案</h2>
<div id="3888611f" class="cell" data-execution_count="3">
<div class="cell-output cell-output-display" data-execution_count="45">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe caption-top" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header" style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">停車場型態</th>
<th data-quarto-table-cell-role="th">停車場代碼</th>
<th data-quarto-table-cell-role="th">停車場名稱</th>
<th data-quarto-table-cell-role="th">停車場地址</th>
<th data-quarto-table-cell-role="th">停車場電話</th>
<th data-quarto-table-cell-role="th">即時車位</th>
<th data-quarto-table-cell-role="th">一般大型車</th>
<th data-quarto-table-cell-role="th">一般小型車</th>
<th data-quarto-table-cell-role="th">身障者小型車</th>
<th data-quarto-table-cell-role="th">婦幼者小型車</th>
<th data-quarto-table-cell-role="th">綠能小型車</th>
<th data-quarto-table-cell-role="th">一般機車</th>
<th data-quarto-table-cell-role="th">身障者機車</th>
<th data-quarto-table-cell-role="th">小型車充電樁</th>
<th data-quarto-table-cell-role="th">收費時間</th>
<th data-quarto-table-cell-role="th">收費費率</th>
<th data-quarto-table-cell-role="th">經緯度</th>
<th data-quarto-table-cell-role="th">備註欄</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>公有免費停車場</td>
<td>044</td>
<td>佳里停1公有停車場</td>
<td>臺南市佳里區安西路與文化路交叉口</td>
<td>2138172</td>
<td>-1</td>
<td>0</td>
<td>11</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>23.16238，120.1714</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>公有免費停車場</td>
<td>045</td>
<td>佳里停2公有停車場</td>
<td>臺南市佳里區文化路與公園路交叉口</td>
<td>2138172</td>
<td>-1</td>
<td>0</td>
<td>8</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>23.16293，120.17216</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>公有免費停車場</td>
<td>100</td>
<td>停2立體停車場</td>
<td>臺南市新市區環東路1段與南科二路</td>
<td>NaN</td>
<td>-1</td>
<td>0</td>
<td>417</td>
<td>6</td>
<td>0</td>
<td>0</td>
<td>70</td>
<td>2</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>23.096305，120.284649</td>
<td>南科管理局</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>公有免費停車場</td>
<td>101</td>
<td>管理局地下停車場</td>
<td>臺南市新市區環東路1段與南科三路</td>
<td>NaN</td>
<td>-1</td>
<td>0</td>
<td>402</td>
<td>14</td>
<td>0</td>
<td>0</td>
<td>467</td>
<td>6</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>23.101229，120.282238</td>
<td>南科管理局</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>公有免費停車場</td>
<td>102</td>
<td>管理局戶外平面停車場</td>
<td>臺南市新市區環東路1段</td>
<td>NaN</td>
<td>-1</td>
<td>0</td>
<td>227</td>
<td>2</td>
<td>0</td>
<td>0</td>
<td>46</td>
<td>0</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>23.102632，120.283831</td>
<td>南科管理局</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="hands-on---.csv檔案匯入" class="slide level2">
<h2>Hands-on - .csv檔案匯入</h2>
<ul>
<li>以<a href="https://data.gov.tw/dataset/18420">上市公司每月營業收入彙總表</a>為例</li>
<li>複製<code>csv</code>資料下載網址</li>
<li>用<code>pandas</code> 的 <code>read_csv()</code>函數將檔案匯入</li>
<li>匯入後印出前5個row</li>
</ul>

<img data-src="figures/downloadcsv.png" class="r-stretch"></section>
<section id="xls-excel格式檔案" class="slide level2">
<h2>.xls Excel格式檔案</h2>
<ul>
<li>需要安裝<code>openpyxl</code>和<code>xlrd</code>套件</li>
</ul>
<div id="ed1abce4" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href=""></a><span class="op">!</span>pip3 install openpyxl xlrd</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="xls-excel格式檔案-1" class="slide level2">
<h2>.xls Excel格式檔案</h2>
<ul>
<li>使用<code>pandas</code>的<code>read_excel(路徑)</code></li>
<li>路徑可以是<em>本機端路徑</em>，也可以是<em>網址</em></li>
<li>可設定<code>sheet_name</code>參數指定<em>工作表名稱</em></li>
</ul>
<div id="f792b38c" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href=""></a>url <span class="op">=</span> <span class="st">'https://github.com/CGUIM-BigDataAnalysis/BigDataCGUIM/raw/master/EMBA_BigData/Data/</span><span class="sc">%E</span><span class="st">6</span><span class="sc">%96%</span><span class="st">B0</span><span class="sc">%E</span><span class="st">7%AB%B9</span><span class="sc">%E</span><span class="st">4%B8%8D</span><span class="sc">%E</span><span class="st">5%8B</span><span class="sc">%95%</span><span class="st">E7</span><span class="sc">%94%</span><span class="st">A2.xls'</span></span>
<span id="cb4-2"><a href=""></a>house <span class="op">=</span> pd.read_excel(url,sheet_name <span class="op">=</span> <span class="st">"不動產買賣"</span>)  </span>
<span id="cb4-3"><a href=""></a>house.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="46">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe caption-top" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header" style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">鄉鎮市區</th>
<th data-quarto-table-cell-role="th">交易標的</th>
<th data-quarto-table-cell-role="th">土地位置建物門牌</th>
<th data-quarto-table-cell-role="th">土地移轉總面積平方公尺</th>
<th data-quarto-table-cell-role="th">都市土地使用分區</th>
<th data-quarto-table-cell-role="th">非都市土地使用分區</th>
<th data-quarto-table-cell-role="th">非都市土地使用編定</th>
<th data-quarto-table-cell-role="th">交易年月日</th>
<th data-quarto-table-cell-role="th">交易筆棟數</th>
<th data-quarto-table-cell-role="th">移轉層次</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">總價元</th>
<th data-quarto-table-cell-role="th">單價元平方公尺</th>
<th data-quarto-table-cell-role="th">車位類別</th>
<th data-quarto-table-cell-role="th">車位移轉總面積平方公尺</th>
<th data-quarto-table-cell-role="th">車位總價元</th>
<th data-quarto-table-cell-role="th">備註</th>
<th data-quarto-table-cell-role="th">主建物面積</th>
<th data-quarto-table-cell-role="th">附屬建物面積</th>
<th data-quarto-table-cell-role="th">陽台面積</th>
<th data-quarto-table-cell-role="th">電梯</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>新竹市</td>
<td>土地</td>
<td>明湖段840地號</td>
<td>18.74</td>
<td>NaN</td>
<td>山坡地保育區</td>
<td>農牧用地</td>
<td>1121101</td>
<td>土地1建物0車位0</td>
<td>NaN</td>
<td>...</td>
<td>150000</td>
<td>8004.0</td>
<td>NaN</td>
<td>0.0</td>
<td>0</td>
<td>NaN</td>
<td>0.00</td>
<td>0.0</td>
<td>0.00</td>
<td>無</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>新竹市</td>
<td>土地</td>
<td>新莊段198地號</td>
<td>42.95</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>1121101</td>
<td>土地12建物0車位0</td>
<td>NaN</td>
<td>...</td>
<td>4576000</td>
<td>106542.0</td>
<td>NaN</td>
<td>0.0</td>
<td>0</td>
<td>親友、員工、共有人或其他特殊關係間之交易；</td>
<td>0.00</td>
<td>0.0</td>
<td>0.00</td>
<td>無</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>新竹市</td>
<td>房地(土地+建物)</td>
<td>新竹市新竹市光華街９５巷３號５樓之３</td>
<td>6.72</td>
<td>住</td>
<td>NaN</td>
<td>NaN</td>
<td>1121101</td>
<td>土地1建物1車位0</td>
<td>五層</td>
<td>...</td>
<td>3630000</td>
<td>81665.0</td>
<td>NaN</td>
<td>0.0</td>
<td>0</td>
<td>NaN</td>
<td>31.62</td>
<td>0.0</td>
<td>3.74</td>
<td>有</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>新竹市</td>
<td>土地</td>
<td>南門段四小段177-25地號</td>
<td>29.67</td>
<td>都市：其他:道路用地</td>
<td>NaN</td>
<td>NaN</td>
<td>1121103</td>
<td>土地1建物0車位0</td>
<td>NaN</td>
<td>...</td>
<td>1316221</td>
<td>44362.0</td>
<td>NaN</td>
<td>0.0</td>
<td>0</td>
<td>包含公共設施保留地用地；</td>
<td>0.00</td>
<td>0.0</td>
<td>0.00</td>
<td>無</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>新竹市</td>
<td>土地</td>
<td>東山段一小段189-11地號</td>
<td>357.38</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>1121107</td>
<td>土地1建物0車位0</td>
<td>NaN</td>
<td>...</td>
<td>5038989</td>
<td>14100.0</td>
<td>NaN</td>
<td>0.0</td>
<td>0</td>
<td>協議價購；</td>
<td>0.00</td>
<td>0.0</td>
<td>0.00</td>
<td>無</td>
</tr>
</tbody>
</table>

<p>5 rows × 31 columns</p>
</div>
</div>
</div>
</section>
<section id="xls-excel格式檔案-2" class="slide level2">
<h2>.xls Excel格式檔案</h2>
<div id="c01114e8" class="cell" data-execution_count="6">
<div class="cell-output cell-output-display" data-execution_count="47">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe caption-top" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header" style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">鄉鎮市區</th>
<th data-quarto-table-cell-role="th">交易標的</th>
<th data-quarto-table-cell-role="th">土地位置建物門牌</th>
<th data-quarto-table-cell-role="th">土地移轉總面積平方公尺</th>
<th data-quarto-table-cell-role="th">都市土地使用分區</th>
<th data-quarto-table-cell-role="th">非都市土地使用分區</th>
<th data-quarto-table-cell-role="th">非都市土地使用編定</th>
<th data-quarto-table-cell-role="th">交易年月日</th>
<th data-quarto-table-cell-role="th">交易筆棟數</th>
<th data-quarto-table-cell-role="th">移轉層次</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">總價元</th>
<th data-quarto-table-cell-role="th">單價元平方公尺</th>
<th data-quarto-table-cell-role="th">車位類別</th>
<th data-quarto-table-cell-role="th">車位移轉總面積平方公尺</th>
<th data-quarto-table-cell-role="th">車位總價元</th>
<th data-quarto-table-cell-role="th">備註</th>
<th data-quarto-table-cell-role="th">主建物面積</th>
<th data-quarto-table-cell-role="th">附屬建物面積</th>
<th data-quarto-table-cell-role="th">陽台面積</th>
<th data-quarto-table-cell-role="th">電梯</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>新竹市</td>
<td>土地</td>
<td>明湖段840地號</td>
<td>18.74</td>
<td>NaN</td>
<td>山坡地保育區</td>
<td>農牧用地</td>
<td>1121101</td>
<td>土地1建物0車位0</td>
<td>NaN</td>
<td>...</td>
<td>150000</td>
<td>8004.0</td>
<td>NaN</td>
<td>0.0</td>
<td>0</td>
<td>NaN</td>
<td>0.00</td>
<td>0.0</td>
<td>0.00</td>
<td>無</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>新竹市</td>
<td>土地</td>
<td>新莊段198地號</td>
<td>42.95</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>1121101</td>
<td>土地12建物0車位0</td>
<td>NaN</td>
<td>...</td>
<td>4576000</td>
<td>106542.0</td>
<td>NaN</td>
<td>0.0</td>
<td>0</td>
<td>親友、員工、共有人或其他特殊關係間之交易；</td>
<td>0.00</td>
<td>0.0</td>
<td>0.00</td>
<td>無</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>新竹市</td>
<td>房地(土地+建物)</td>
<td>新竹市新竹市光華街９５巷３號５樓之３</td>
<td>6.72</td>
<td>住</td>
<td>NaN</td>
<td>NaN</td>
<td>1121101</td>
<td>土地1建物1車位0</td>
<td>五層</td>
<td>...</td>
<td>3630000</td>
<td>81665.0</td>
<td>NaN</td>
<td>0.0</td>
<td>0</td>
<td>NaN</td>
<td>31.62</td>
<td>0.0</td>
<td>3.74</td>
<td>有</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>新竹市</td>
<td>土地</td>
<td>南門段四小段177-25地號</td>
<td>29.67</td>
<td>都市：其他:道路用地</td>
<td>NaN</td>
<td>NaN</td>
<td>1121103</td>
<td>土地1建物0車位0</td>
<td>NaN</td>
<td>...</td>
<td>1316221</td>
<td>44362.0</td>
<td>NaN</td>
<td>0.0</td>
<td>0</td>
<td>包含公共設施保留地用地；</td>
<td>0.00</td>
<td>0.0</td>
<td>0.00</td>
<td>無</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>新竹市</td>
<td>土地</td>
<td>東山段一小段189-11地號</td>
<td>357.38</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>1121107</td>
<td>土地1建物0車位0</td>
<td>NaN</td>
<td>...</td>
<td>5038989</td>
<td>14100.0</td>
<td>NaN</td>
<td>0.0</td>
<td>0</td>
<td>協議價購；</td>
<td>0.00</td>
<td>0.0</td>
<td>0.00</td>
<td>無</td>
</tr>
</tbody>
</table>

<p>5 rows × 31 columns</p>
</div>
</div>
</div>
</section>
<section id="hands-on---.xls-excel格式檔案" class="slide level2">
<h2>Hands-on - .xls Excel格式檔案</h2>
<ul>
<li>以<a href="https://data.gov.tw/dataset/145466">水位雨量站</a>為例</li>
<li>複製<code>Excel</code>資料下載網址</li>
<li>用pandas 的 <code>read_excel()</code>函數將檔案匯入，記得設定工作表名稱</li>
<li>匯入後印出第三個row</li>
</ul>
</section>
<section id="純文字資料" class="slide level2">
<h2>純文字資料</h2>
<ul>
<li>使用<code>oepn(檔名)</code>開啟檔案</li>
<li>使用<code>檔案物件.read()</code>讀取內容。<strong>一次取全部</strong></li>
<li>讀取完畢後，使用<code>檔案物件.close()</code>關閉檔案</li>
</ul>
<div id="c1486e9c" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href=""></a>f <span class="op">=</span> <span class="bu">open</span>(<span class="st">"output_write.txt"</span>)</span>
<span id="cb5-2"><a href=""></a><span class="bu">print</span>(f.read())</span>
<span id="cb5-3"><a href=""></a>f.close()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Hello World123456789Hello World
123
456
789
</code></pre>
</div>
</div>
</section>
<section id="純文字資料-1" class="slide level2">
<h2>純文字資料</h2>
<ul>
<li>使用<code>oepn(檔名)</code>開啟檔案</li>
<li>使用<code>檔案物件.readlines()</code>讀取內容。<strong>一次取全部，分行存成list</strong></li>
<li>讀取完畢後，使用<code>檔案物件.close()</code>關閉檔案</li>
</ul>
<div id="15e50b78" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href=""></a>f <span class="op">=</span> <span class="bu">open</span>(<span class="st">"output_write.txt"</span>)</span>
<span id="cb7-2"><a href=""></a><span class="bu">print</span>(f.readlines())</span>
<span id="cb7-3"><a href=""></a>f.close()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>['Hello World123456789Hello World\n', '123\n', '456\n', '789\n']</code></pre>
</div>
</div>
</section>
<section id="純文字資料-2" class="slide level2">
<h2>純文字資料</h2>
<ul>
<li>使用<code>oepn(檔名)</code>開啟檔案</li>
<li>使用<code>檔案物件.readline()</code>讀取內容。<strong>逐行讀</strong></li>
<li>讀取完畢後，使用<code>檔案物件.close()</code>關閉檔案</li>
</ul>
<div id="66f804ec" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href=""></a>f <span class="op">=</span> <span class="bu">open</span>(<span class="st">"output_write.txt"</span>)</span>
<span id="cb9-2"><a href=""></a><span class="bu">print</span>(f.readline())</span>
<span id="cb9-3"><a href=""></a><span class="bu">print</span>(f.readline())</span>
<span id="cb9-4"><a href=""></a>f.close()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Hello World123456789Hello World

123
</code></pre>
</div>
</div>
</section>
<section id="dist-for-open" class="slide level2">
<h2>dist + for + open</h2>
<div id="3e8534dc" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href=""></a>name <span class="op">=</span> <span class="st">'trump.txt'</span></span>
<span id="cb11-2"><a href=""></a>handle <span class="op">=</span> <span class="bu">open</span>(name)</span>
<span id="cb11-3"><a href=""></a></span>
<span id="cb11-4"><a href=""></a>counts <span class="op">=</span> <span class="bu">dict</span>()</span>
<span id="cb11-5"><a href=""></a><span class="cf">for</span> line <span class="kw">in</span> handle:</span>
<span id="cb11-6"><a href=""></a>    words <span class="op">=</span> line.split()</span>
<span id="cb11-7"><a href=""></a>    <span class="cf">for</span> word <span class="kw">in</span> words:</span>
<span id="cb11-8"><a href=""></a>        counts[word] <span class="op">=</span> counts.get(word,<span class="dv">0</span>) <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb11-9"><a href=""></a></span>
<span id="cb11-10"><a href=""></a>bigcount <span class="op">=</span> <span class="va">None</span></span>
<span id="cb11-11"><a href=""></a>bigword <span class="op">=</span> <span class="va">None</span></span>
<span id="cb11-12"><a href=""></a><span class="cf">for</span> word,count <span class="kw">in</span> counts.items():</span>
<span id="cb11-13"><a href=""></a>    <span class="cf">if</span> bigcount <span class="kw">is</span> <span class="va">None</span> <span class="kw">or</span> count <span class="op">&gt;</span> bigcount:</span>
<span id="cb11-14"><a href=""></a>        bigword <span class="op">=</span> word</span>
<span id="cb11-15"><a href=""></a>        bigcount <span class="op">=</span> count</span>
<span id="cb11-16"><a href=""></a></span>
<span id="cb11-17"><a href=""></a><span class="bu">print</span>(bigword, bigcount)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>the 31</code></pre>
</div>
</div>
</section>
<section id="其他格式" class="slide level2">
<h2>其他格式</h2>
<ul>
<li>以圖片為例，需安裝並載入繪圖用套件<code>matplotlib</code></li>
<li>使用<code>plt.imread(路徑)</code>載入圖片，為RGB向量</li>
</ul>
<div id="6d08b480" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href=""></a><span class="op">!</span>pip3 install matplotlib</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="6643b4db" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href=""></a><span class="im">import</span> matplotlib</span>
<span id="cb14-2"><a href=""></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb14-3"><a href=""></a>im <span class="op">=</span> plt.imread(<span class="st">'figures/nycu_logo.png'</span>) </span>
<span id="cb14-4"><a href=""></a><span class="bu">print</span>(im)</span>
<span id="cb14-5"><a href=""></a>plt.imshow(im, <span class="st">'gray'</span>)</span>
<span id="cb14-6"><a href=""></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[[1. 1. 1. 0.]
  [1. 1. 1. 0.]
  [1. 1. 1. 0.]
  ...
  [1. 1. 1. 0.]
  [1. 1. 1. 0.]
  [1. 1. 1. 0.]]

 [[1. 1. 1. 0.]
  [1. 1. 1. 0.]
  [1. 1. 1. 0.]
  ...
  [1. 1. 1. 0.]
  [1. 1. 1. 0.]
  [1. 1. 1. 0.]]

 [[1. 1. 1. 0.]
  [1. 1. 1. 0.]
  [1. 1. 1. 0.]
  ...
  [1. 1. 1. 0.]
  [1. 1. 1. 0.]
  [1. 1. 1. 0.]]

 ...

 [[1. 1. 1. 0.]
  [1. 1. 1. 0.]
  [1. 1. 1. 0.]
  ...
  [1. 1. 1. 0.]
  [1. 1. 1. 0.]
  [1. 1. 1. 0.]]

 [[1. 1. 1. 0.]
  [1. 1. 1. 0.]
  [1. 1. 1. 0.]
  ...
  [1. 1. 1. 0.]
  [1. 1. 1. 0.]
  [1. 1. 1. 0.]]

 [[1. 1. 1. 0.]
  [1. 1. 1. 0.]
  [1. 1. 1. 0.]
  ...
  [1. 1. 1. 0.]
  [1. 1. 1. 0.]
  [1. 1. 1. 0.]]]</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src="4_DataIO_files/figure-revealjs/cell-13-output-2.png" width="423" height="416"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="其他格式-1" class="slide level2">
<h2>其他格式</h2>
<ul>
<li>使用<code>plt.imshow(向量)</code>呈現圖片</li>
<li><code>plt.show()</code>在視窗中呈現圖片內容</li>
</ul>
<div id="fdc14745" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href=""></a>plt.imshow(im, <span class="st">'gray'</span>)</span>
<span id="cb16-2"><a href=""></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src="4_DataIO_files/figure-revealjs/cell-14-output-1.png" width="423" height="416"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="data-input-and-output-2" class="slide level2">
<h2>Data input and output</h2>
<ul>
<li><strong>Data input</strong>
<ul>
<li>From file</li>
<li><strong>From google drive</strong></li>
<li>From API</li>
<li>Webscrapping</li>
</ul></li>
<li>Data output</li>
</ul>
</section></section>
<section>
<section id="從google-drive匯入" class="title-slide slide level1 center">
<h1>從Google drive匯入</h1>

</section>
<section id="從google-drive匯入---google-試算表" class="slide level2">
<h2>從Google drive匯入 - google 試算表</h2>
<ul>
<li><code>pandas</code>套件</li>
<li>注意原始連結後方，須為文件ID
<ul>
<li>若有<code>/edit#gid=0</code>或<code>/edit?usp=sharing</code>字樣，請刪除</li>
</ul></li>
<li>需要加工連結，在原始連結最後加上<code>/export?format=csv</code></li>
<li>如果不是公開資料表，需要授權
<ul>
<li>參考<code>google-api-python-client</code>套件</li>
</ul></li>
</ul>
<div id="f4f51127" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href=""></a>link<span class="op">=</span><span class="st">"https://docs.google.com/spreadsheets/d/1WqkYGfZZinxqhyqnbHIDC4NrHXbApfm8m8EvFR4SPAU"</span></span>
<span id="cb17-2"><a href=""></a>csv_link<span class="op">=</span><span class="st">"/export?format=csv"</span></span>
<span id="cb17-3"><a href=""></a>pd.read_csv(link<span class="op">+</span>csv_link)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="54">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe caption-top" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header" style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">交易日期</th>
<th data-quarto-table-cell-role="th">開盤</th>
<th data-quarto-table-cell-role="th">最高</th>
<th data-quarto-table-cell-role="th">最低</th>
<th data-quarto-table-cell-role="th">收盤</th>
<th data-quarto-table-cell-role="th">漲跌</th>
<th data-quarto-table-cell-role="th">漲跌(%)</th>
<th data-quarto-table-cell-role="th">振幅(%)</th>
<th data-quarto-table-cell-role="th">張數</th>
<th data-quarto-table-cell-role="th">筆數</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">外資</th>
<th data-quarto-table-cell-role="th">投信</th>
<th data-quarto-table-cell-role="th">自營</th>
<th data-quarto-table-cell-role="th">合計</th>
<th data-quarto-table-cell-role="th">外資持股(%)</th>
<th data-quarto-table-cell-role="th">融資增減</th>
<th data-quarto-table-cell-role="th">融資餘額</th>
<th data-quarto-table-cell-role="th">融券增減</th>
<th data-quarto-table-cell-role="th">融券餘額</th>
<th data-quarto-table-cell-role="th">券資比(%)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>25/02/14</td>
<td>1065</td>
<td>1070</td>
<td>1060</td>
<td>1060</td>
<td>-30</td>
<td>-2.75</td>
<td>0.92</td>
<td>73,417</td>
<td>218,986</td>
<td>...</td>
<td>-20,971</td>
<td>-91.4</td>
<td>+34.5</td>
<td>-21,028</td>
<td>73.4</td>
<td>+1,090</td>
<td>23,081</td>
<td>-100</td>
<td>111</td>
<td>0.48</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>25/02/13</td>
<td>1090</td>
<td>1095</td>
<td>1080</td>
<td>1090</td>
<td>-10</td>
<td>-0.91</td>
<td>1.36</td>
<td>35,682</td>
<td>72,456</td>
<td>...</td>
<td>-10,885</td>
<td>+454</td>
<td>+1,117</td>
<td>-9,313</td>
<td>73.5</td>
<td>+262</td>
<td>21,991</td>
<td>-56</td>
<td>211</td>
<td>0.96</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>25/02/12</td>
<td>1110</td>
<td>1115</td>
<td>1100</td>
<td>1100</td>
<td>-10</td>
<td>-0.90</td>
<td>1.35</td>
<td>26,190</td>
<td>38,511</td>
<td>...</td>
<td>+213</td>
<td>-19</td>
<td>-347</td>
<td>-153</td>
<td>73.6</td>
<td>+129</td>
<td>21,729</td>
<td>-4</td>
<td>267</td>
<td>1.23</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>25/02/11</td>
<td>1110</td>
<td>1115</td>
<td>1100</td>
<td>1110</td>
<td>5</td>
<td>0.45</td>
<td>1.36</td>
<td>21,023</td>
<td>31,837</td>
<td>...</td>
<td>+1,229</td>
<td>-353</td>
<td>-292</td>
<td>+584</td>
<td>73.6</td>
<td>-38</td>
<td>21,600</td>
<td>10</td>
<td>271</td>
<td>1.25</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>25/02/10</td>
<td>1125</td>
<td>1125</td>
<td>1095</td>
<td>1105</td>
<td>-20</td>
<td>-1.78</td>
<td>2.67</td>
<td>31,037</td>
<td>60,839</td>
<td>...</td>
<td>-2,271</td>
<td>-132</td>
<td>-479</td>
<td>-2,882</td>
<td>73.6</td>
<td>+532</td>
<td>21,638</td>
<td>-24</td>
<td>261</td>
<td>1.21</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">235</td>
<td>24/02/23</td>
<td>701</td>
<td>703</td>
<td>696</td>
<td>697</td>
<td>5</td>
<td>0.72</td>
<td>1.01</td>
<td>48,404</td>
<td>48,018</td>
<td>...</td>
<td>+20,881</td>
<td>-366</td>
<td>-570</td>
<td>+19,946</td>
<td>74.2</td>
<td>-1,807</td>
<td>13,053</td>
<td>9</td>
<td>392</td>
<td>3.00</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">236</td>
<td>24/02/22</td>
<td>695</td>
<td>695</td>
<td>685</td>
<td>692</td>
<td>11</td>
<td>1.62</td>
<td>1.47</td>
<td>34,269</td>
<td>36,998</td>
<td>...</td>
<td>+7,728</td>
<td>+37.7</td>
<td>+2,125</td>
<td>+9,890</td>
<td>74.1</td>
<td>+899</td>
<td>14,860</td>
<td>19</td>
<td>383</td>
<td>2.58</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">237</td>
<td>24/02/21</td>
<td>678</td>
<td>683</td>
<td>678</td>
<td>681</td>
<td>-6</td>
<td>-0.87</td>
<td>0.73</td>
<td>31,981</td>
<td>36,004</td>
<td>...</td>
<td>-5,942</td>
<td>+39.3</td>
<td>+1,514</td>
<td>-4,389</td>
<td>74.0</td>
<td>-145</td>
<td>13,961</td>
<td>-26</td>
<td>364</td>
<td>2.61</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">238</td>
<td>24/02/20</td>
<td>675</td>
<td>688</td>
<td>675</td>
<td>687</td>
<td>9</td>
<td>1.33</td>
<td>1.92</td>
<td>31,404</td>
<td>32,847</td>
<td>...</td>
<td>+2,641</td>
<td>-12.4</td>
<td>-1,188</td>
<td>+1,441</td>
<td>74.1</td>
<td>-249</td>
<td>14,106</td>
<td>23</td>
<td>390</td>
<td>2.76</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">239</td>
<td>24/02/19</td>
<td>674</td>
<td>682</td>
<td>674</td>
<td>678</td>
<td>-5</td>
<td>-0.73</td>
<td>1.17</td>
<td>36,367</td>
<td>35,240</td>
<td>...</td>
<td>-10,732</td>
<td>+81.6</td>
<td>+1,855</td>
<td>-8,795</td>
<td>74.0</td>
<td>+616</td>
<td>14,355</td>
<td>-5</td>
<td>367</td>
<td>2.56</td>
</tr>
</tbody>
</table>

<p>240 rows × 22 columns</p>
</div>
</div>
</div>
</section>
<section id="從google-drive匯入---google-試算表-1" class="slide level2">
<h2>從Google drive匯入 - google 試算表</h2>
<div id="2ee330ed" class="cell" data-execution_count="15">
<div class="cell-output cell-output-display" data-execution_count="55">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe caption-top" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header" style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">交易日期</th>
<th data-quarto-table-cell-role="th">開盤</th>
<th data-quarto-table-cell-role="th">最高</th>
<th data-quarto-table-cell-role="th">最低</th>
<th data-quarto-table-cell-role="th">收盤</th>
<th data-quarto-table-cell-role="th">漲跌</th>
<th data-quarto-table-cell-role="th">漲跌(%)</th>
<th data-quarto-table-cell-role="th">振幅(%)</th>
<th data-quarto-table-cell-role="th">張數</th>
<th data-quarto-table-cell-role="th">筆數</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">外資</th>
<th data-quarto-table-cell-role="th">投信</th>
<th data-quarto-table-cell-role="th">自營</th>
<th data-quarto-table-cell-role="th">合計</th>
<th data-quarto-table-cell-role="th">外資持股(%)</th>
<th data-quarto-table-cell-role="th">融資增減</th>
<th data-quarto-table-cell-role="th">融資餘額</th>
<th data-quarto-table-cell-role="th">融券增減</th>
<th data-quarto-table-cell-role="th">融券餘額</th>
<th data-quarto-table-cell-role="th">券資比(%)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>25/02/14</td>
<td>1065</td>
<td>1070</td>
<td>1060</td>
<td>1060</td>
<td>-30</td>
<td>-2.75</td>
<td>0.92</td>
<td>73,417</td>
<td>218,986</td>
<td>...</td>
<td>-20,971</td>
<td>-91.4</td>
<td>+34.5</td>
<td>-21,028</td>
<td>73.4</td>
<td>+1,090</td>
<td>23,081</td>
<td>-100</td>
<td>111</td>
<td>0.48</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>25/02/13</td>
<td>1090</td>
<td>1095</td>
<td>1080</td>
<td>1090</td>
<td>-10</td>
<td>-0.91</td>
<td>1.36</td>
<td>35,682</td>
<td>72,456</td>
<td>...</td>
<td>-10,885</td>
<td>+454</td>
<td>+1,117</td>
<td>-9,313</td>
<td>73.5</td>
<td>+262</td>
<td>21,991</td>
<td>-56</td>
<td>211</td>
<td>0.96</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>25/02/12</td>
<td>1110</td>
<td>1115</td>
<td>1100</td>
<td>1100</td>
<td>-10</td>
<td>-0.90</td>
<td>1.35</td>
<td>26,190</td>
<td>38,511</td>
<td>...</td>
<td>+213</td>
<td>-19</td>
<td>-347</td>
<td>-153</td>
<td>73.6</td>
<td>+129</td>
<td>21,729</td>
<td>-4</td>
<td>267</td>
<td>1.23</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>25/02/11</td>
<td>1110</td>
<td>1115</td>
<td>1100</td>
<td>1110</td>
<td>5</td>
<td>0.45</td>
<td>1.36</td>
<td>21,023</td>
<td>31,837</td>
<td>...</td>
<td>+1,229</td>
<td>-353</td>
<td>-292</td>
<td>+584</td>
<td>73.6</td>
<td>-38</td>
<td>21,600</td>
<td>10</td>
<td>271</td>
<td>1.25</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>25/02/10</td>
<td>1125</td>
<td>1125</td>
<td>1095</td>
<td>1105</td>
<td>-20</td>
<td>-1.78</td>
<td>2.67</td>
<td>31,037</td>
<td>60,839</td>
<td>...</td>
<td>-2,271</td>
<td>-132</td>
<td>-479</td>
<td>-2,882</td>
<td>73.6</td>
<td>+532</td>
<td>21,638</td>
<td>-24</td>
<td>261</td>
<td>1.21</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">235</td>
<td>24/02/23</td>
<td>701</td>
<td>703</td>
<td>696</td>
<td>697</td>
<td>5</td>
<td>0.72</td>
<td>1.01</td>
<td>48,404</td>
<td>48,018</td>
<td>...</td>
<td>+20,881</td>
<td>-366</td>
<td>-570</td>
<td>+19,946</td>
<td>74.2</td>
<td>-1,807</td>
<td>13,053</td>
<td>9</td>
<td>392</td>
<td>3.00</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">236</td>
<td>24/02/22</td>
<td>695</td>
<td>695</td>
<td>685</td>
<td>692</td>
<td>11</td>
<td>1.62</td>
<td>1.47</td>
<td>34,269</td>
<td>36,998</td>
<td>...</td>
<td>+7,728</td>
<td>+37.7</td>
<td>+2,125</td>
<td>+9,890</td>
<td>74.1</td>
<td>+899</td>
<td>14,860</td>
<td>19</td>
<td>383</td>
<td>2.58</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">237</td>
<td>24/02/21</td>
<td>678</td>
<td>683</td>
<td>678</td>
<td>681</td>
<td>-6</td>
<td>-0.87</td>
<td>0.73</td>
<td>31,981</td>
<td>36,004</td>
<td>...</td>
<td>-5,942</td>
<td>+39.3</td>
<td>+1,514</td>
<td>-4,389</td>
<td>74.0</td>
<td>-145</td>
<td>13,961</td>
<td>-26</td>
<td>364</td>
<td>2.61</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">238</td>
<td>24/02/20</td>
<td>675</td>
<td>688</td>
<td>675</td>
<td>687</td>
<td>9</td>
<td>1.33</td>
<td>1.92</td>
<td>31,404</td>
<td>32,847</td>
<td>...</td>
<td>+2,641</td>
<td>-12.4</td>
<td>-1,188</td>
<td>+1,441</td>
<td>74.1</td>
<td>-249</td>
<td>14,106</td>
<td>23</td>
<td>390</td>
<td>2.76</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">239</td>
<td>24/02/19</td>
<td>674</td>
<td>682</td>
<td>674</td>
<td>678</td>
<td>-5</td>
<td>-0.73</td>
<td>1.17</td>
<td>36,367</td>
<td>35,240</td>
<td>...</td>
<td>-10,732</td>
<td>+81.6</td>
<td>+1,855</td>
<td>-8,795</td>
<td>74.0</td>
<td>+616</td>
<td>14,355</td>
<td>-5</td>
<td>367</td>
<td>2.56</td>
</tr>
</tbody>
</table>

<p>240 rows × 22 columns</p>
</div>
</div>
</div>
</section>
<section id="hands-on---google-試算表匯入" class="slide level2">
<h2>Hands-on - google 試算表匯入</h2>
<ul>
<li>以<a href="https://docs.google.com/spreadsheets/d/1wmcc6e8n9bvIQgps6MgFLyLCcq6DWx-3uP2uLIA9rnU">Example Spreadsheet</a>為例</li>
<li>加工連結 (<strong>hint</strong>:前兩頁投影片)</li>
<li>用pandas 的 <code>pd.read_csv()</code>函數將檔案匯入</li>
<li>匯入後印出第Home State column</li>
</ul>
</section>
<section id="data-input-and-output-3" class="slide level2">
<h2>Data input and output</h2>
<ul>
<li><strong>Data input</strong>
<ul>
<li>From file</li>
<li>From google drive</li>
<li><strong>From API</strong></li>
<li>Webscrapping</li>
</ul></li>
<li>Data output</li>
</ul>
</section></section>
<section>
<section id="from-api" class="title-slide slide level1 center">
<h1>From API</h1>

</section>
<section id="from-api-1" class="slide level2">
<h2>From API</h2>
<ul>
<li>Open Data</li>
<li>API (Application programming interfaces)</li>
<li>JSON格式檔案</li>
</ul>
</section>
<section id="open-data-開放資料" class="slide level2">
<h2>Open Data 開放資料</h2>
<ul>
<li>2011年推動開放政府與開放資料 (<a href="https://zh.wikipedia.org/wiki/%E9%96%8B%E6%94%BE%E8%B3%87%E6%96%99">維基百科</a>)</li>
<li>不受著作權、專利權，以及其他管理機制所限制，任何人都可以自由出版使用</li>
<li>常見的儲存方式為:
<ul>
<li><code>CSV</code></li>
<li><code>JSON</code></li>
<li><code>XML</code></li>
</ul></li>
</ul>
</section>
<section id="open-data-開放資料常見平台" class="slide level2">
<h2>Open Data 開放資料常見平台</h2>
<ul>
<li><a href="https://data.gov.tw/">政府資料開放平台</a></li>
<li><a href="https://data.taipei/">台北市資料大平台</a></li>
<li><a href="https://opendata.tycg.gov.tw/">桃園開放資料</a></li>
<li><a href="https://opendata.hccg.gov.tw/">新竹市政府資料開放平臺</a></li>
</ul>
</section>
<section id="api" class="slide level2">
<h2>API</h2>
<ul>
<li>應用程式介面</li>
<li><strong>A</strong>pplication <strong>P</strong>rogramming <strong>I</strong>nterfaces</li>
<li>為了讓第三方的開發者可以額外開發應用程式來強化他們的產品，推出可以與系統溝通的介面</li>
<li>有API輔助可將資料擷取過程自動化
<ul>
<li>以下載Open Data為例，若檔案更新頻繁，使用手動下載相當耗時</li>
</ul></li>
<li><a href="https://zh.wikipedia.org/zh-tw/%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F%E6%8E%A5%E5%8F%A3">維基百科</a></li>
</ul>
</section>
<section id="api---open-data" class="slide level2">
<h2>API - Open Data</h2>
<ul>
<li>[桃園公共自行車即時服務資料]https://opendata.tycg.gov.tw/datalist/5ca2bfc7-9ace-4719-88ae-4034b9a5a55c)資料</li>
<li>每日更新</li>
<li>不可能每日手動下載</li>
<li>提供透過<strong>API</strong>下載的服務</li>
<li>透過API下載的資料格式: <strong>JSON格式</strong></li>
</ul>
</section>
<section id="json-format" class="slide level2">
<h2>JSON format</h2>
<ul>
<li>JSON (<strong>J</strong>ava<strong>s</strong>cript <strong>O</strong>bject <strong>N</strong>otation)</li>
<li>輕量級的資料交換語言</li>
<li>From <strong>a</strong>pplication <strong>p</strong>rogramming <strong>i</strong>nterfaces (APIs)</li>
<li>JavaScript、Java、Node.js應用</li>
<li>一些NoSQL資料庫用JSON儲存資料：<strong>MongoDB</strong></li>
<li><a href="http://en.wikipedia.org/wiki/JSON">Wiki</a></li>
</ul>

<img data-src="figures/json.png" width="383" class="r-stretch"></section>
<section id="json檔案匯入" class="slide level2">
<h2>JSON檔案匯入</h2>
<ul>
<li>從網路載資料，需要安裝<code>requests</code>套件</li>
<li>處理json資料，需要安裝與載入<code>json</code>套件</li>
</ul>
<div id="f8c7195f" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href=""></a><span class="op">!</span>pip3 install json requests</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="adf30874" class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href=""></a><span class="im">import</span> json, requests</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="json檔案匯入-1" class="slide level2">
<h2>JSON檔案匯入</h2>
<ul>
<li>API網址參考<a href="https://opendata.taichung.gov.tw/search/6e38eb56-0e9a-4b9e-806d-23cd35d44d6b">臺中市公共自行車(YouBike2.0)</a></li>
<li>點選<strong>API</strong>獲取相關資訊</li>
<li>使用<code>requests</code>套件的<code>get(網址)</code>擷取資料</li>
<li>此API會檔短時間內擷取多次的要求，因此放入<code>params = {'param':'1'}</code>以及<code>headers = {'Connection':'close'}</code>設定</li>
<li>最後將使用<code>回傳結果.json()</code>，將檔案轉成JSON格式</li>
</ul>
<div id="9db768a8" class="cell" data-cache="true" data-execution_count="18">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href=""></a>url<span class="op">=</span><span class="st">"https://datacenter.taichung.gov.tw/swagger/OpenData/34a848ab-eeb3-44fd-a842-a09cb3209a7d"</span></span>
<span id="cb20-2"><a href=""></a>response <span class="op">=</span> requests.get(url, params <span class="op">=</span> {<span class="st">'param'</span>:<span class="st">'1'</span>}, headers <span class="op">=</span> {<span class="st">'Connection'</span>:<span class="st">'close'</span>})</span>
<span id="cb20-3"><a href=""></a>data <span class="op">=</span> response.json()  <span class="co"># Convert the response to JSON</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="json檔案匯入-2" class="slide level2">
<h2>JSON檔案匯入</h2>
<p>探索資料，使用<code>.keys()</code>查看keys</p>
<div id="836bb152" class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href=""></a><span class="bu">type</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="58">
<pre><code>dict</code></pre>
</div>
</div>
<div id="3e4036ea" class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href=""></a>data.keys()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="59">
<pre><code>dict_keys(['retCode', 'updated_at', 'retVal'])</code></pre>
</div>
</div>
<div id="4763b5a1" class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href=""></a><span class="bu">type</span>(data[<span class="st">"retVal"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="60">
<pre><code>list</code></pre>
</div>
</div>
</section>
<section id="json檔案匯入-3" class="slide level2">
<h2>JSON檔案匯入</h2>
<p>探索資料，發現是dist (data)中retVal key儲存含有資料的list</p>
<div id="b64903f2" class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href=""></a>data[<span class="st">"retVal"</span>][<span class="dv">0</span>:<span class="dv">2</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="61">
<pre><code>[{'scity': '台中市',
  'scityen': 'Taichung City',
  'sna': 'YouBike2.0_綠川東中山路口',
  'sarea': '中區',
  'ar': '綠川東街/中山路口(東側)',
  'snaen': 'YouBike2.0_Luchuan E. St. / Zhongshan Rd.',
  'sareaen': 'Central Dist',
  'aren': 'Luchuan E. St. &amp; Zhongshan Rd. Intersection (East)',
  'sno': '500601001',
  'tot': '16',
  'sbi': '7',
  'mday': '20250220121216',
  'lat': '24.13785',
  'lng': '120.68337',
  'bemp': '9',
  'act': 1,
  'sbi_detail': {'yb2': '7', 'eyb': '0'}},
 {'scity': '台中市',
  'scityen': 'Taichung City',
  'sna': 'YouBike2.0_繼光光復路口',
  'sarea': '中區',
  'ar': '繼光街166號(對側人行道)',
  'snaen': 'YouBike2.0_Jiguang St. / Guangfu Rd.',
  'sareaen': 'Central Dist',
  'aren': 'No.166, Jiguang St. (Opposite)',
  'sno': '500601002',
  'tot': '18',
  'sbi': '7',
  'mday': '20250220120917',
  'lat': '24.1411',
  'lng': '120.68474',
  'bemp': '10',
  'act': 1,
  'sbi_detail': {'yb2': '5', 'eyb': '2'}}]</code></pre>
</div>
</div>
</section>
<section id="json檔案匯入-4" class="slide level2">
<h2>JSON檔案匯入</h2>
<p>探索資料，發現是dist (data)中retVal key儲存含有資料的list</p>
<div id="460ff9e7" class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href=""></a>data[<span class="st">"retVal"</span>][<span class="dv">0</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="62">
<pre><code>{'scity': '台中市',
 'scityen': 'Taichung City',
 'sna': 'YouBike2.0_綠川東中山路口',
 'sarea': '中區',
 'ar': '綠川東街/中山路口(東側)',
 'snaen': 'YouBike2.0_Luchuan E. St. / Zhongshan Rd.',
 'sareaen': 'Central Dist',
 'aren': 'Luchuan E. St. &amp; Zhongshan Rd. Intersection (East)',
 'sno': '500601001',
 'tot': '16',
 'sbi': '7',
 'mday': '20250220121216',
 'lat': '24.13785',
 'lng': '120.68337',
 'bemp': '9',
 'act': 1,
 'sbi_detail': {'yb2': '7', 'eyb': '0'}}</code></pre>
</div>
</div>
</section>
<section id="hands-on---json檔案匯入練習" class="slide level2">
<h2>Hands-on - JSON檔案匯入練習</h2>
<ul>
<li>練習用資料：<a href="https://data.gov.tw/dataset/137993">YouBike2.0臺北市公共自行車即時資訊</a></li>
<li>API地址<a href="https://tcgbusfs.blob.core.windows.net/dotapp/youbike/v2/youbike_immediate.json">在此</a></li>
<li>使用檔案匯入<strong>範例</strong>，將資料匯入Python中
<ul>
<li>提示：設定url</li>
</ul></li>
<li>找到資料的儲存處，並將答案print出</li>
</ul>
</section>
<section id="from-api---recap" class="slide level2">
<h2>From API - Recap</h2>
<ul>
<li>Open Data</li>
<li>API (Application programming interfaces)</li>
<li>JSON格式檔案 <code>requests.get()</code>下載，<code>.json</code>轉型</li>
<li>用<code>type()</code>查看資料類別</li>
<li>若為dist，則可使用<code>keys()</code>查看資料擷取方法，並印出來試試看</li>
</ul>
</section>
<section id="data-input-and-output-4" class="slide level2">
<h2>Data input and output</h2>
<ul>
<li><strong>Data input</strong>
<ul>
<li>From file</li>
<li>From google drive</li>
<li>From API</li>
<li><strong>Webscrapping</strong></li>
</ul></li>
<li>Data output</li>
</ul>
</section></section>
<section>
<section id="網頁爬蟲-webscraping" class="title-slide slide level1 center">
<h1>網頁爬蟲 Webscraping</h1>

</section>
<section id="網頁爬蟲-webscraping-1" class="slide level2">
<h2>網頁爬蟲 Webscraping</h2>
<ul>
<li>不是每個網站都提供API</li>
<li>人工複製貼上?!</li>
<li>程式化的方式擷取網頁資料: <strong>網頁爬蟲（Webscraping）</strong>（<a href="http://en.wikipedia.org/wiki/Web_scraping">Webscraping Wiki</a>）</li>
<li>可能耗費很多網頁流量和資源 －很可能被鎖IP</li>
<li>使用<code>beautifulsoup4</code> 套件輔助</li>
</ul>
</section>
<section id="網頁爬蟲-webscraping-beautifulsoup4" class="slide level2">
<h2>網頁爬蟲 Webscraping-beautifulsoup4</h2>
<p>需要先安裝<code>beautifulsoup4</code>以及<code>requests</code>套件。</p>
<div id="84cb3595" class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href=""></a><span class="op">!</span>pip3 install beautifulsoup4 requests</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>擷取條件的撰寫會因網頁語法不同而有差異</li>
<li>使用<strong>Google Chrome開發工具</strong>輔助觀察擷取資料的條件
<ul>
<li>或是按右鍵，點選“檢查”</li>
<li>或使用<strong>SelectorGadget</strong>輔助</li>
</ul></li>
<li>觀察需要擷取的資料所在HTML片段
<ul>
<li>css class, id 等</li>
</ul></li>
</ul>
</section>
<section id="即時股價爬取" class="slide level2">
<h2>即時股價爬取</h2>
<ul>
<li><a href="ttps://www.google.com/finance/">Google 財經</a></li>
<li><a href="https://www.google.com/finance/quote/2330:TPE?hl=zh-TW">Google 財經 - 台積電</a></li>
</ul>
<div id="b45b43c9" class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href=""></a><span class="im">from</span> bs4 <span class="im">import</span> BeautifulSoup</span>
<span id="cb32-2"><a href=""></a><span class="im">import</span> requests</span>
<span id="cb32-3"><a href=""></a>StockUrl <span class="op">=</span> <span class="st">"https://www.google.com/finance/quote/2330:TPE?hl=zh-TW"</span></span>
<span id="cb32-4"><a href=""></a>res <span class="op">=</span> requests.get(StockUrl)</span>
<span id="cb32-5"><a href=""></a>soup <span class="op">=</span> BeautifulSoup(res.text, <span class="st">"html.parser"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="17fc2247" class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href=""></a>price <span class="op">=</span> soup.select(<span class="st">".fxKbKc"</span>)</span>
<span id="cb33-2"><a href=""></a>price[<span class="dv">0</span>].get_text()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="64">
<pre><code>'$1,085.00'</code></pre>
</div>
</div>
</section>
<section id="即時股價爬取---下載html" class="slide level2">
<h2>即時股價爬取 - 下載html</h2>
<ul>
<li>使用<code>requests</code>套件的<code>get(網址)</code>函數，輸入網址，將網頁載入python分析環境。</li>
<li>成功載入網頁後，針對該物件，使用<code>.text</code>取得網頁原始碼 (.html)</li>
</ul>
<div id="cd707645" class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href=""></a>StockUrl <span class="op">=</span> <span class="st">"https://www.google.com/finance/quote/2330:TPE?hl=zh-TW"</span></span>
<span id="cb35-2"><a href=""></a>res <span class="op">=</span> requests.get(StockUrl)</span>
<span id="cb35-3"><a href=""></a>res.text[<span class="dv">0</span>:<span class="dv">1000</span>] <span class="co">## print first 1000 chars</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="65">
<pre><code>'&lt;!doctype html&gt;&lt;html lang="zh-TW" dir="ltr"&gt;&lt;head&gt;&lt;base href="https://www.google.com/finance/"&gt;&lt;link rel="preconnect" href="//www.gstatic.com"&gt;&lt;meta name="referrer" content="origin"&gt;&lt;script nonce="H2d7gNGV-tjarhXn2zMPeQ"&gt;window[\'ppConfig\'] = {productName: \'GoogleFinanceUi\', deleteIsEnforced:  true , sealIsEnforced:  true , heartbeatRate:  0.5 , periodicReportingRateMillis:  60000.0 , disableAllReporting:  false };(function(){\'use strict\';function k(a){var b=0;return function(){return b&lt;a.length?{done:!1,value:a[b++]}:{done:!0}}}var l=typeof Object.defineProperties=="function"?Object.defineProperty:function(a,b,c){if(a==Array.prototype||a==Object.prototype)return a;a[b]=c.value;return a};\nfunction m(a){a=["object"==typeof globalThis&amp;&amp;globalThis,a,"object"==typeof window&amp;&amp;window,"object"==typeof self&amp;&amp;self,"object"==typeof global&amp;&amp;global];for(var b=0;b&lt;a.length;++b){var c=a[b];if(c&amp;&amp;c.Math==Math)return c}throw Error("Cannot find global object");}var n=m(this);function p(a,b){if(b)a:{var '</code></pre>
</div>
</div>
</section>
<section id="即時股價爬取---解析html" class="slide level2">
<h2>即時股價爬取 - 解析html</h2>
<ul>
<li>使用<code>BeautifulSoup</code>套件提供的解析方法<code>BeautifulSoup(html檔案,格式)</code>
<ul>
<li>輸入剛剛載回來的html檔案<code>res.text</code>，以及設定格式<code>"html.parser"</code>，完成HTML解析</li>
</ul></li>
<li>解析後可使用<code>解析後內容.prettify</code>取得排版後的網頁原始碼</li>
</ul>
<div id="4237284f" class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href=""></a>soup <span class="op">=</span> BeautifulSoup(res.text, <span class="st">"html.parser"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="即時股價爬取---搜尋所需節點--1" class="slide level2">
<h2>即時股價爬取 - 搜尋所需節點 -1</h2>
<ul>
<li><code>find(節點條件)</code>:
<ul>
<li>取得第一個符合條件的節點 (<code>&lt;&gt;</code>內的內容)</li>
</ul></li>
<li><code>find_all(節點條件)</code>
<ul>
<li>取得所有符合條件的節點 (<code>&lt;&gt;</code>內的內容)</li>
</ul></li>
<li><code>select_one()</code>
<ul>
<li>取得第一個符合CSS條件的節點 (<code>class</code> or <code>id</code>等屬性)</li>
</ul></li>
<li><code>select()</code>
<ul>
<li>取得所有符合CSS條件的節點 (<code>class</code> or <code>id</code>等屬性)</li>
</ul></li>
</ul>
</section>
<section id="即時股價爬取---搜尋所需節點--1-1" class="slide level2">
<h2>即時股價爬取 - 搜尋所需節點 -1</h2>
<p>範例：class 包含 <code>fxKbKc</code></p>
<ul>
<li><code>select()</code>
<ul>
<li>取得所有符合CSS條件的節點 (<code>class</code> or <code>id</code>等屬性)</li>
</ul></li>
<li><code>class=</code>可用<code>.</code>代表</li>
<li><code>id=</code>可用<code>#</code>代表</li>
</ul>
<div id="077cefeb" class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href=""></a>soup <span class="op">=</span> BeautifulSoup(res.text, <span class="st">"html.parser"</span>)</span>
<span id="cb38-2"><a href=""></a>price <span class="op">=</span> soup.select(<span class="st">".fxKbKc"</span>)</span>
<span id="cb38-3"><a href=""></a>price</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="67">
<pre><code>[&lt;div class="YMlKec fxKbKc"&gt;$1,085.00&lt;/div&gt;]</code></pre>
</div>
</div>
</section>
<section id="即時股價爬取---取出需要的資料--1" class="slide level2">
<h2>即時股價爬取 - 取出需要的資料 -1</h2>
<ul>
<li><code>.get_text()</code>可抓取節點內文字</li>
<li><code>.get("屬性名稱")</code>可抓取屬性內容</li>
</ul>
<div id="fd0ba2f5" class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href=""></a>price[<span class="dv">0</span>].get_text()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="68">
<pre><code>'$1,085.00'</code></pre>
</div>
</div>
</section>
<section id="即時股價爬取---搜尋所需節點--2" class="slide level2">
<h2>即時股價爬取 - 搜尋所需節點 -2</h2>
<p>範例：class 包含 <code>gyFHrc</code></p>
<ul>
<li><code>select()</code>
<ul>
<li>取得所有符合CSS條件的節點 (<code>class</code> or <code>id</code>等屬性)</li>
</ul></li>
</ul>
<div id="d3092eb9" class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href=""></a>soup <span class="op">=</span> BeautifulSoup(res.text, <span class="st">"html.parser"</span>)</span>
<span id="cb42-2"><a href=""></a>price_detail <span class="op">=</span> soup.select(<span class="st">".gyFHrc"</span>)</span>
<span id="cb42-3"><a href=""></a>price_detail</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="69">
<pre><code>[&lt;div class="gyFHrc"&gt;&lt;span data-is-tooltip-wrapper="true"&gt;&lt;div aria-describedby="i15" class="mfs7Fc" data-tooltip-anchor-boundary-type="2" data-tooltip-x-position="2" jsaction="mouseenter:tfO1Yc; focus:AHmuwe; blur:O22p3e; mouseleave:JywGue; touchstart:p6p2H; touchend:yfqBxc;mlnRJb:fLiPzd;" jscontroller="e2jnoe"&gt;前次收盤價&lt;/div&gt;&lt;div aria-hidden="true" class="EY8ABd-OWXEXe-TAWMXe" id="i15" role="tooltip"&gt;最後收盤價&lt;/div&gt;&lt;/span&gt;&lt;div class="P6K39c"&gt;$1,090.00&lt;/div&gt;&lt;/div&gt;,
 &lt;div class="gyFHrc"&gt;&lt;span data-is-tooltip-wrapper="true"&gt;&lt;div aria-describedby="i16" class="mfs7Fc" data-tooltip-anchor-boundary-type="2" data-tooltip-x-position="2" jsaction="mouseenter:tfO1Yc; focus:AHmuwe; blur:O22p3e; mouseleave:JywGue; touchstart:p6p2H; touchend:yfqBxc;mlnRJb:fLiPzd;" jscontroller="e2jnoe"&gt;單日股價範圍&lt;/div&gt;&lt;div aria-hidden="true" class="EY8ABd-OWXEXe-TAWMXe" id="i16" role="tooltip"&gt;過去一天內最高價與最低價之間的價格範圍&lt;/div&gt;&lt;/span&gt;&lt;div class="P6K39c"&gt;$1,070.00 - $1,085.00&lt;/div&gt;&lt;/div&gt;,
 &lt;div class="gyFHrc"&gt;&lt;span data-is-tooltip-wrapper="true"&gt;&lt;div aria-describedby="i17" class="mfs7Fc" data-tooltip-anchor-boundary-type="2" data-tooltip-x-position="2" jsaction="mouseenter:tfO1Yc; focus:AHmuwe; blur:O22p3e; mouseleave:JywGue; touchstart:p6p2H; touchend:yfqBxc;mlnRJb:fLiPzd;" jscontroller="e2jnoe"&gt;一年股價範圍&lt;/div&gt;&lt;div aria-hidden="true" class="EY8ABd-OWXEXe-TAWMXe" id="i17" role="tooltip"&gt;過去 52 週內最高價與最低價之間的價格範圍&lt;/div&gt;&lt;/span&gt;&lt;div class="P6K39c"&gt;$675.00 - $1,160.00&lt;/div&gt;&lt;/div&gt;,
 &lt;div class="gyFHrc"&gt;&lt;span data-is-tooltip-wrapper="true"&gt;&lt;div aria-describedby="i18" class="mfs7Fc" data-tooltip-anchor-boundary-type="2" data-tooltip-x-position="2" jsaction="mouseenter:tfO1Yc; focus:AHmuwe; blur:O22p3e; mouseleave:JywGue; touchstart:p6p2H; touchend:yfqBxc;mlnRJb:fLiPzd;" jscontroller="e2jnoe"&gt;總市值&lt;/div&gt;&lt;div aria-hidden="true" class="EY8ABd-OWXEXe-TAWMXe" id="i18" role="tooltip"&gt;一種估價方法，將公司股價乘以在外流通總股數。&lt;/div&gt;&lt;/span&gt;&lt;div class="P6K39c"&gt;28.14兆 TWD&lt;/div&gt;&lt;/div&gt;,
 &lt;div class="gyFHrc"&gt;&lt;span data-is-tooltip-wrapper="true"&gt;&lt;div aria-describedby="i19" class="mfs7Fc" data-tooltip-anchor-boundary-type="2" data-tooltip-x-position="2" jsaction="mouseenter:tfO1Yc; focus:AHmuwe; blur:O22p3e; mouseleave:JywGue; touchstart:p6p2H; touchend:yfqBxc;mlnRJb:fLiPzd;" jscontroller="e2jnoe"&gt;平均交易量&lt;/div&gt;&lt;div aria-hidden="true" class="EY8ABd-OWXEXe-TAWMXe" id="i19" role="tooltip"&gt;過去 30 天內平均每天的成交股數&lt;/div&gt;&lt;/span&gt;&lt;div class="P6K39c"&gt;4051.10萬&lt;/div&gt;&lt;/div&gt;,
 &lt;div class="gyFHrc"&gt;&lt;span data-is-tooltip-wrapper="true"&gt;&lt;div aria-describedby="i20" class="mfs7Fc" data-tooltip-anchor-boundary-type="2" data-tooltip-x-position="2" jsaction="mouseenter:tfO1Yc; focus:AHmuwe; blur:O22p3e; mouseleave:JywGue; touchstart:p6p2H; touchend:yfqBxc;mlnRJb:fLiPzd;" jscontroller="e2jnoe"&gt;本益比&lt;/div&gt;&lt;div aria-hidden="true" class="EY8ABd-OWXEXe-TAWMXe" id="i20" role="tooltip"&gt;目前股價與過去十二個月每股盈餘總和兩者之間的比率，這個比率可反映某檔股票的價格相較於其他股票是高還低&lt;/div&gt;&lt;/span&gt;&lt;div class="P6K39c"&gt;23.98&lt;/div&gt;&lt;/div&gt;,
 &lt;div class="gyFHrc"&gt;&lt;span data-is-tooltip-wrapper="true"&gt;&lt;div aria-describedby="i21" class="mfs7Fc" data-tooltip-anchor-boundary-type="2" data-tooltip-x-position="2" jsaction="mouseenter:tfO1Yc; focus:AHmuwe; blur:O22p3e; mouseleave:JywGue; touchstart:p6p2H; touchend:yfqBxc;mlnRJb:fLiPzd;" jscontroller="e2jnoe"&gt;股利收益率&lt;/div&gt;&lt;div aria-hidden="true" class="EY8ABd-OWXEXe-TAWMXe" id="i21" role="tooltip"&gt;年股利與目前股價兩者之間的比率，這個比率可用於估計某檔股票的股利報酬率&lt;/div&gt;&lt;/span&gt;&lt;div class="P6K39c"&gt;1.47%&lt;/div&gt;&lt;/div&gt;,
 &lt;div class="gyFHrc"&gt;&lt;span data-is-tooltip-wrapper="true"&gt;&lt;div aria-describedby="i22" class="mfs7Fc" data-tooltip-anchor-boundary-type="2" data-tooltip-x-position="2" jsaction="mouseenter:tfO1Yc; focus:AHmuwe; blur:O22p3e; mouseleave:JywGue; touchstart:p6p2H; touchend:yfqBxc;mlnRJb:fLiPzd;" jscontroller="e2jnoe"&gt;主要交易所&lt;/div&gt;&lt;div aria-hidden="true" class="EY8ABd-OWXEXe-TAWMXe" id="i22" role="tooltip"&gt;這檔證券的上市交易所&lt;/div&gt;&lt;/span&gt;&lt;div class="P6K39c"&gt;TPE&lt;/div&gt;&lt;/div&gt;,
 &lt;div class="gyFHrc"&gt;&lt;div class="mfs7Fc"&gt;&lt;span aria-hidden="true" class="notranslate gnzz8b"&gt;&lt;svg class="NMm5M" focusable="false" height="14" viewbox="0 0 24 24" width="14"&gt;&lt;path d="M12 6c1.1 0 2 .9 2 2s-.9 2-2 2-2-.9-2-2 .9-2 2-2m0 9c2.7 0 5.8 1.29 6 2v1H6v-.99c.2-.72 3.3-2.01 6-2.01m0-11C9.79 4 8 5.79 8 8s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4zm0 9c-2.67 0-8 1.34-8 4v3h16v-3c0-2.66-5.33-4-8-4z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/span&gt;執行長&lt;/div&gt;&lt;div class="P6K39c"&gt;&lt;ul class="OEHt4c"&gt;&lt;li&gt;&lt;a class="tBHE4e" href="https://www.google.com/search?q=%E9%AD%8F%E5%93%B2%E5%AE%B6&amp;amp;hl=zh-TW" jslog="166166;ved:2ahUKEwjLoq3YstGLAxW6grkFHcFcGnYQlpIKegQIAhBc;track:click" target="_blank"&gt;魏哲家&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&lt;/div&gt;,
 &lt;div class="gyFHrc"&gt;&lt;div class="mfs7Fc"&gt;&lt;span aria-hidden="true" class="notranslate gnzz8b"&gt;&lt;svg class="NMm5M" focusable="false" height="14" viewbox="0 0 24 24" width="14"&gt;&lt;path d="M19 4h-1V2h-2v2H8V2H6v2H5c-1.11 0-1.99.9-1.99 2L3 20a2 2 0 0 0 2 2h14c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 16H5V10h14v10z"&gt;&lt;/path&gt;&lt;path d="M14.5 13a2.5 2.5 0 0 0 0 5 2.5 2.5 0 0 0 0-5z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/span&gt;成立時間&lt;/div&gt;&lt;div class="P6K39c"&gt;1987年2月21日&lt;/div&gt;&lt;/div&gt;,
 &lt;div class="gyFHrc"&gt;&lt;div class="mfs7Fc"&gt;&lt;span aria-hidden="true" class="notranslate gnzz8b"&gt;&lt;svg class="NMm5M" focusable="false" height="14" viewbox="0 0 24 24" width="14"&gt;&lt;path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zM7 9c0-2.76 2.24-5 5-5s5 2.24 5 5c0 2.88-2.88 7.19-5 9.88C9.92 16.21 7 11.85 7 9z"&gt;&lt;/path&gt;&lt;circle cx="12" cy="9" r="2.5"&gt;&lt;/circle&gt;&lt;/svg&gt;&lt;/span&gt;總部&lt;/div&gt;&lt;div class="P6K39c"&gt;&lt;a class="tBHE4e" href="https://www.google.com/maps/place/8%2C%20Li-Hsin%20Rd.%206%2C%20%E6%96%B0%E7%AB%B9%2C%20%E8%87%BA%E7%81%A3%E7%9C%81%2C%20%E5%8F%B0%E7%81%A3?hl=zh-TW" jslog="166166;ved:2ahUKEwjLoq3YstGLAxW6grkFHcFcGnYQlpIKegQIAhBc;track:click" target="_blank"&gt;臺灣省新竹&lt;br/&gt;台灣&lt;/a&gt;&lt;/div&gt;&lt;/div&gt;,
 &lt;div class="gyFHrc"&gt;&lt;div class="mfs7Fc"&gt;&lt;span aria-hidden="true" class="notranslate gnzz8b"&gt;&lt;svg class="NMm5M" focusable="false" height="14" viewbox="0 0 24 24" width="14"&gt;&lt;path d="M20 4H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h16c1.1 0 2-.9 2-2V6a2 2 0 0 0-2-2zm0 14H4V8h16v10z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/span&gt;網站&lt;/div&gt;&lt;div class="P6K39c"&gt;&lt;a class="tBHE4e" href="http://www.tsmc.com/" jslog="166166;ved:2ahUKEwjLoq3YstGLAxW6grkFHcFcGnYQlpIKegQIAhBc;track:click" rel="noopener noreferrer" target="_blank"&gt;tsmc.com&lt;/a&gt;&lt;/div&gt;&lt;/div&gt;,
 &lt;div class="gyFHrc"&gt;&lt;div class="mfs7Fc"&gt;&lt;span aria-hidden="true" class="notranslate gnzz8b"&gt;&lt;svg class="NMm5M" focusable="false" height="14" viewbox="0 0 24 24" width="14"&gt;&lt;path d="M15 8c0-1.42-.5-2.73-1.33-3.76.42-.14.86-.24 1.33-.24 2.21 0 4 1.79 4 4s-1.79 4-4 4c-.43 0-.84-.09-1.23-.21-.03-.01-.06-.02-.1-.03A5.98 5.98 0 0 0 15 8zm1.66 5.13C18.03 14.06 19 15.32 19 17v3h4v-3c0-2.18-3.58-3.47-6.34-3.87zM9 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2m0 9c-2.7 0-5.8 1.29-6 2.01V18h12v-1c-.2-.71-3.3-2-6-2M9 4c2.21 0 4 1.79 4 4s-1.79 4-4 4-4-1.79-4-4 1.79-4 4-4zm0 9c2.67 0 8 1.34 8 4v3H1v-3c0-2.66 5.33-4 8-4z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/span&gt;員工數&lt;/div&gt;&lt;div class="P6K39c"&gt;65,152&lt;/div&gt;&lt;/div&gt;]</code></pre>
</div>
</div>
</section>
<section id="即時股價爬取---取出需要的資料--2" class="slide level2">
<h2>即時股價爬取 - 取出需要的資料 -2</h2>
<ul>
<li><code>.get_text()</code>可抓取節點內文字</li>
<li><code>.get("屬性名稱")</code>可抓取屬性內容</li>
</ul>
<div id="c9d8806e" class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href=""></a><span class="bu">len</span>(price_detail)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="70">
<pre><code>13</code></pre>
</div>
</div>
<div id="bff951cd" class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href=""></a><span class="cf">for</span> price <span class="kw">in</span> price_detail:</span>
<span id="cb46-2"><a href=""></a>  <span class="bu">print</span>(price.get_text())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>前次收盤價最後收盤價$1,090.00
單日股價範圍過去一天內最高價與最低價之間的價格範圍$1,070.00 - $1,085.00
一年股價範圍過去 52 週內最高價與最低價之間的價格範圍$675.00 - $1,160.00
總市值一種估價方法，將公司股價乘以在外流通總股數。28.14兆 TWD
平均交易量過去 30 天內平均每天的成交股數4051.10萬
本益比目前股價與過去十二個月每股盈餘總和兩者之間的比率，這個比率可反映某檔股票的價格相較於其他股票是高還低23.98
股利收益率年股利與目前股價兩者之間的比率，這個比率可用於估計某檔股票的股利報酬率1.47%
主要交易所這檔證券的上市交易所TPE
執行長魏哲家
成立時間1987年2月21日
總部臺灣省新竹台灣
網站tsmc.com
員工數65,152</code></pre>
</div>
</div>
</section>
<section id="即時股價爬取---搜尋所需節點--3" class="slide level2">
<h2>即時股價爬取 - 搜尋所需節點 -3</h2>
<p>範例：class 包含 <code>z4rs2b</code></p>
<ul>
<li><code>select()</code>: 取得所有符合CSS條件的節點 (<code>class</code> or <code>id</code>等屬性)</li>
</ul>
<div id="431a2961" class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href=""></a>soup <span class="op">=</span> BeautifulSoup(res.text, <span class="st">"html.parser"</span>)</span>
<span id="cb48-2"><a href=""></a>news <span class="op">=</span> soup.select(<span class="st">".z4rs2b"</span>)</span>
<span id="cb48-3"><a href=""></a>news</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="72">
<pre><code>[&lt;div class="z4rs2b"&gt;&lt;a data-ved="2ahUKEwjLoq3YstGLAxW6grkFHcFcGnYQuL8GegQIAhAx" href="https://www.ctee.com.tw/news/20250219700737-430201" jslog="106424;ved:2ahUKEwjLoq3YstGLAxW6grkFHcFcGnYQuL8GegQIAhAx;track:click" rel="noopener noreferrer" target="_blank"&gt;&lt;div class="Tfehrf"&gt;&lt;div class="nkXTJ W8knGc" jsname="GvmPSb"&gt;&lt;div class="sfyJob"&gt;工商時報&lt;/div&gt;&lt;div class="cCEUJe"&gt;&lt;div class="Adak"&gt;1 天前&lt;/div&gt;&lt;div class="hVmHve" jsname="iwaAEc"&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class="Yfwt5"&gt;這家台積電轉投資公司大跳水「這原因」拖垮股價逼近跌停- 證券&lt;/div&gt;&lt;/div&gt;&lt;/a&gt;&lt;/div&gt;,
 &lt;div class="z4rs2b"&gt;&lt;a data-ved="2ahUKEwjLoq3YstGLAxW6grkFHcFcGnYQuL8GegQIAhAz" href="https://tw.stock.yahoo.com/news/%E4%BC%81%E6%A5%AD%E5%AF%B5%E5%93%A1%E5%B7%A5%E7%84%A1%E6%A5%B5%E9%99%90%EF%BC%81%E5%8F%B0%E7%A9%8D%E9%9B%BB%E5%93%A1%E5%B7%A5%E7%A6%8F%E5%88%A9%E4%B9%9F%E6%AF%94%E4%B8%8D%E4%B8%8A%E5%AE%83%E8%B2%BC%E5%BF%83%E3%80%8C%E9%80%99%E9%96%93%E3%80%8D%E7%AB%9F%E7%9B%B4%E6%8E%A5%E8%93%8B%E6%88%BF%E8%AE%93%E5%93%A1%E5%B7%A5%E6%92%BF%E4%BE%BF%E5%AE%9C%EF%BD%9C%E6%88%BF%E5%B8%82%E8%A7%80%E9%BB%9E-011739672.html" jslog="106424;ved:2ahUKEwjLoq3YstGLAxW6grkFHcFcGnYQuL8GegQIAhAz;track:click" rel="noopener noreferrer" target="_blank"&gt;&lt;div class="Tfehrf"&gt;&lt;div class="nkXTJ W8knGc" jsname="GvmPSb"&gt;&lt;div class="sfyJob"&gt;奇摩股市&lt;/div&gt;&lt;div class="cCEUJe"&gt;&lt;div class="Adak"&gt;3 小時前&lt;/div&gt;&lt;div class="hVmHve" jsname="iwaAEc"&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class="Yfwt5"&gt;企業寵員工無極限！台積電員工福利也比不上它貼心「這間」竟直接蓋房讓員工撿便宜｜房市觀點&lt;/div&gt;&lt;/div&gt;&lt;/a&gt;&lt;/div&gt;,
 &lt;div class="z4rs2b"&gt;&lt;a data-ved="2ahUKEwjLoq3YstGLAxW6grkFHcFcGnYQuL8GegQIAhA1" href="https://udn.com/news/story/7240/8559373" jslog="106424;ved:2ahUKEwjLoq3YstGLAxW6grkFHcFcGnYQuL8GegQIAhA1;track:click" rel="noopener noreferrer" target="_blank"&gt;&lt;div class="Tfehrf"&gt;&lt;div class="nkXTJ W8knGc" jsname="GvmPSb"&gt;&lt;div class="sfyJob"&gt;聯合新聞網&lt;/div&gt;&lt;div class="cCEUJe"&gt;&lt;div class="Adak"&gt;6 小時前&lt;/div&gt;&lt;div class="hVmHve" jsname="iwaAEc"&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class="Yfwt5"&gt;台積電可能投資英特爾晶圓廠 外媒：台美恐掀政治憂慮&lt;/div&gt;&lt;/div&gt;&lt;/a&gt;&lt;/div&gt;,
 &lt;div class="z4rs2b"&gt;&lt;a data-ved="2ahUKEwjLoq3YstGLAxW6grkFHcFcGnYQuL8GegQIAhA5" href="https://www.moneydj.com/funddj/ya/yp050000.djhtm?a=CE121E8D-E134-4A82-A638-036D9EFAB953" jslog="106424;ved:2ahUKEwjLoq3YstGLAxW6grkFHcFcGnYQuL8GegQIAhA5;track:click" rel="noopener noreferrer" target="_blank"&gt;&lt;div class="Tfehrf"&gt;&lt;div class="nkXTJ W8knGc" jsname="GvmPSb"&gt;&lt;div class="sfyJob"&gt;MoneyDJ&lt;/div&gt;&lt;div class="cCEUJe"&gt;&lt;div class="Adak"&gt;1 天前&lt;/div&gt;&lt;div class="hVmHve" jsname="iwaAEc"&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class="Yfwt5"&gt;外媒：台積是憑企業文化拿下領先 難跟Intel兼容-新聞內容-基金&lt;/div&gt;&lt;/div&gt;&lt;/a&gt;&lt;/div&gt;,
 &lt;div class="z4rs2b"&gt;&lt;a data-ved="2ahUKEwjLoq3YstGLAxW6grkFHcFcGnYQuL8GegQIAhA9" href="https://www.businesstoday.com.tw/article/category/183008/post/202502190008/" jslog="106424;ved:2ahUKEwjLoq3YstGLAxW6grkFHcFcGnYQuL8GegQIAhA9;track:click" rel="noopener noreferrer" target="_blank"&gt;&lt;div class="Tfehrf"&gt;&lt;div class="nkXTJ W8knGc" jsname="GvmPSb"&gt;&lt;div class="sfyJob"&gt;今周刊&lt;/div&gt;&lt;div class="cCEUJe"&gt;&lt;div class="Adak"&gt;1 天前&lt;/div&gt;&lt;div class="hVmHve" jsname="iwaAEc"&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class="Yfwt5"&gt;大成鋼漲不停、台塑谷底翻身，都因「美國製造」…台積電、環球晶超前佈署，這2家準備加碼投資美國&lt;/div&gt;&lt;/div&gt;&lt;/a&gt;&lt;/div&gt;,
 &lt;div class="z4rs2b"&gt;&lt;a data-ved="2ahUKEwjLoq3YstGLAxW6grkFHcFcGnYQuL8GegQIAhA_" href="https://news.tvbs.com.tw/politics/2783650" jslog="106424;ved:2ahUKEwjLoq3YstGLAxW6grkFHcFcGnYQuL8GegQIAhA_;track:click" rel="noopener noreferrer" target="_blank"&gt;&lt;div class="Tfehrf"&gt;&lt;div class="nkXTJ W8knGc" jsname="GvmPSb"&gt;&lt;div class="sfyJob"&gt;TVBS新聞網&lt;/div&gt;&lt;div class="cCEUJe"&gt;&lt;div class="Adak"&gt;1 天前&lt;/div&gt;&lt;div class="hVmHve" jsname="iwaAEc"&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class="Yfwt5"&gt;【川普施壓台積電3】補貼政策恐生變 台積電在美擴大投資還有3大難關&lt;/div&gt;&lt;/div&gt;&lt;/a&gt;&lt;/div&gt;]</code></pre>
</div>
</div>
</section>
<section id="即時股價爬取---取出需要的資料--3" class="slide level2">
<h2>即時股價爬取 - 取出需要的資料 -3</h2>
<ul>
<li><code>.get_text()</code>可抓取節點內文字</li>
<li><code>.get("屬性名稱")</code>可抓取屬性內容</li>
</ul>
<div id="052a147b" class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href=""></a><span class="bu">len</span>(news)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="73">
<pre><code>6</code></pre>
</div>
</div>
<div id="d2dd92d6" class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href=""></a><span class="cf">for</span> title_click <span class="kw">in</span> news:</span>
<span id="cb52-2"><a href=""></a>  <span class="bu">print</span>(title_click.get_text())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>工商時報1 天前這家台積電轉投資公司大跳水「這原因」拖垮股價逼近跌停- 證券
奇摩股市3 小時前企業寵員工無極限！台積電員工福利也比不上它貼心「這間」竟直接蓋房讓員工撿便宜｜房市觀點
聯合新聞網6 小時前台積電可能投資英特爾晶圓廠 外媒：台美恐掀政治憂慮
MoneyDJ1 天前外媒：台積是憑企業文化拿下領先 難跟Intel兼容-新聞內容-基金
今周刊1 天前大成鋼漲不停、台塑谷底翻身，都因「美國製造」…台積電、環球晶超前佈署，這2家準備加碼投資美國
TVBS新聞網1 天前【川普施壓台積電3】補貼政策恐生變 台積電在美擴大投資還有3大難關</code></pre>
</div>
</div>
</section>
<section id="hands-on-爬蟲練習" class="slide level2">
<h2>Hands-on 爬蟲練習</h2>
<ul>
<li><a href="https://www.ptt.cc/bbs/Tech_Job/index.html">Ptt Tech_Job 版</a></li>
<li>試著爬出所有<strong>標題</strong></li>
<li>爬出的第三個標題是？</li>
<li>提示：
<ul>
<li>下載html <code>requests.get(網址)</code></li>
<li>解析html <code>BeautifulSoup(下載網頁.text, "html.parser")</code><br>
</li>
<li>搜尋所需節點 <code>find(節點)</code>, <code>select(css條件)</code></li>
<li>取出需要的資料 <code>get_text()</code>, <code>get(屬性名稱)</code></li>
</ul></li>
</ul>
</section>
<section id="即時股價爬取---取出需要的資料--4" class="slide level2">
<h2>即時股價爬取 - 取出需要的資料 -4</h2>
<ul>
<li><code>.get_text()</code>可抓取節點內文字</li>
<li><code>.get("屬性名稱")</code>可抓取屬性內容</li>
</ul>
<div id="37ee7015" class="cell" data-execution_count="37">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href=""></a><span class="cf">for</span> title_click <span class="kw">in</span> news:</span>
<span id="cb54-2"><a href=""></a>  <span class="bu">print</span>(title_click.find(<span class="st">"a"</span>).get(<span class="st">"href"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>https://www.ctee.com.tw/news/20250219700737-430201
https://tw.stock.yahoo.com/news/%E4%BC%81%E6%A5%AD%E5%AF%B5%E5%93%A1%E5%B7%A5%E7%84%A1%E6%A5%B5%E9%99%90%EF%BC%81%E5%8F%B0%E7%A9%8D%E9%9B%BB%E5%93%A1%E5%B7%A5%E7%A6%8F%E5%88%A9%E4%B9%9F%E6%AF%94%E4%B8%8D%E4%B8%8A%E5%AE%83%E8%B2%BC%E5%BF%83%E3%80%8C%E9%80%99%E9%96%93%E3%80%8D%E7%AB%9F%E7%9B%B4%E6%8E%A5%E8%93%8B%E6%88%BF%E8%AE%93%E5%93%A1%E5%B7%A5%E6%92%BF%E4%BE%BF%E5%AE%9C%EF%BD%9C%E6%88%BF%E5%B8%82%E8%A7%80%E9%BB%9E-011739672.html
https://udn.com/news/story/7240/8559373
https://www.moneydj.com/funddj/ya/yp050000.djhtm?a=CE121E8D-E134-4A82-A638-036D9EFAB953
https://www.businesstoday.com.tw/article/category/183008/post/202502190008/
https://news.tvbs.com.tw/politics/2783650</code></pre>
</div>
</div>
</section>
<section id="即時股價爬取---爬連結內的新聞" class="slide level2">
<h2>即時股價爬取 - 爬連結內的新聞</h2>
<ul>
<li>得到連結後，重複上述步驟
<ul>
<li>下載html <code>requests.get(網址)</code></li>
<li>解析html <code>BeautifulSoup(下載網頁.text, "html.parser")</code><br>
</li>
<li>搜尋所需節點 <code>find(節點)</code>, <code>select(css條件)</code></li>
<li>取出需要的資料 <code>get_text()</code>, <code>get(屬性名稱)</code></li>
</ul></li>
</ul>
</section>
<section id="即時股價爬取---爬連結內的新聞-1" class="slide level2">
<h2>即時股價爬取 - 爬連結內的新聞</h2>
<p>首先取得連結list。</p>
<p>補充內容：</p>
<ul>
<li><code>sequence物件.append()</code>可新增內容至sequence中</li>
</ul>
<div id="8fe30226" class="cell" data-execution_count="38">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a href=""></a>url_list <span class="op">=</span> []</span>
<span id="cb56-2"><a href=""></a>title_list <span class="op">=</span> []</span>
<span id="cb56-3"><a href=""></a><span class="cf">for</span> title_click <span class="kw">in</span> news:</span>
<span id="cb56-4"><a href=""></a>  url_list.append(title_click.find(<span class="st">"a"</span>).get(<span class="st">"href"</span>))</span>
<span id="cb56-5"><a href=""></a>  title_list.append(title_click.get_text())</span>
<span id="cb56-6"><a href=""></a><span class="bu">print</span>(url_list)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>['https://www.ctee.com.tw/news/20250219700737-430201', 'https://tw.stock.yahoo.com/news/%E4%BC%81%E6%A5%AD%E5%AF%B5%E5%93%A1%E5%B7%A5%E7%84%A1%E6%A5%B5%E9%99%90%EF%BC%81%E5%8F%B0%E7%A9%8D%E9%9B%BB%E5%93%A1%E5%B7%A5%E7%A6%8F%E5%88%A9%E4%B9%9F%E6%AF%94%E4%B8%8D%E4%B8%8A%E5%AE%83%E8%B2%BC%E5%BF%83%E3%80%8C%E9%80%99%E9%96%93%E3%80%8D%E7%AB%9F%E7%9B%B4%E6%8E%A5%E8%93%8B%E6%88%BF%E8%AE%93%E5%93%A1%E5%B7%A5%E6%92%BF%E4%BE%BF%E5%AE%9C%EF%BD%9C%E6%88%BF%E5%B8%82%E8%A7%80%E9%BB%9E-011739672.html', 'https://udn.com/news/story/7240/8559373', 'https://www.moneydj.com/funddj/ya/yp050000.djhtm?a=CE121E8D-E134-4A82-A638-036D9EFAB953', 'https://www.businesstoday.com.tw/article/category/183008/post/202502190008/', 'https://news.tvbs.com.tw/politics/2783650']</code></pre>
</div>
</div>
</section>
<section id="即時股價爬取---爬連結內的新聞-2" class="slide level2">
<h2>即時股價爬取 - 爬連結內的新聞</h2>
<p>以第一個新聞連結為例，下載html後，重複步驟，取得本文</p>
<div id="8406d3e2" class="cell" data-execution_count="39">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a href=""></a>res <span class="op">=</span> requests.get(url_list[<span class="dv">1</span>])</span>
<span id="cb58-2"><a href=""></a>soup <span class="op">=</span> BeautifulSoup(res.text, <span class="st">"html.parser"</span>)</span>
<span id="cb58-3"><a href=""></a>news_full <span class="op">=</span> soup.select(<span class="st">"p"</span>)</span>
<span id="cb58-4"><a href=""></a>full_text <span class="op">=</span> <span class="st">""</span></span>
<span id="cb58-5"><a href=""></a><span class="cf">for</span> news_para <span class="kw">in</span> news_full:</span>
<span id="cb58-6"><a href=""></a>  full_text <span class="op">=</span> full_text <span class="op">+</span> news_para.get_text()</span>
<span id="cb58-7"><a href=""></a><span class="bu">print</span>(<span class="st">"標題: "</span><span class="op">+</span>title_list[<span class="dv">1</span>] <span class="op">+</span><span class="st">", 內文:"</span> <span class="op">+</span> full_text)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>標題: 奇摩股市3 小時前企業寵員工無極限！台積電員工福利也比不上它貼心「這間」竟直接蓋房讓員工撿便宜｜房市觀點, 內文:Yahoo房市觀察員/ Sam（地產秘密客版主）哪一種員工福利最吸引人？前陣子有人力銀行進行網路統計，發現上班族最喜歡的公司福利前五名分別是尾牙年終獎金、薪水高於平均、分紅認股績效獎勵、免費健康檢查以及育兒教育補助。看起來實質上的金錢福利，果然還是上班族的最愛！不過你知道嗎？台灣居然有企業福利為員工蓋房，讓員工可以用甜甜價幸福成家，就連護國神山台積電也沒它貼心，可以說是最讓人羨慕的一款員工福利了！去年最讓我印象深刻的就是一個在龜山A7的預售案，這個建案地主是一間上市電子公司，他們找來建設公司合建，蓋好後電子公司可以分回約四百多戶。公司高層後來決議把分回來的房子部分做員工宿舍，部分用跟市價有落差的甜價賣給員工，不過為了避免員工變身投資客，一買到馬上轉手套利，公司據說有綁定一個「六年不得轉售」的條款。另一個有名的實例則是今年尾牙剛歡慶營收破千億的全球電子零組件大廠群光電子，根據媒體報導，這間電子公司不但給員工的薪資阿莎力，公司大樓內還有五星級健身房、露天游泳池、三溫暖跟烤箱，而且還在新北市三重幫員工蓋了一棟價格優惠的住宅大樓「群光之星」。從實價登錄上的資料來看，「群光之星」135戶的總戶數中，有118筆的特殊交易，應該就是屬於員工的內部購買。價格的部分，最便宜的一筆是2019年成交的48坪房屋加一個坡平車位，換算下來單價30.47萬，總價1602萬！（同時期鄰近預售案相近樓層的成交價是單價42萬元）上面這兩個案例，員工的住宅大樓距離公司大約都是步行４分鐘左右的距離，雖然房價真的跟市價有差，但跟公司近成這樣，不知道算優點嗎？除此之外，整棟樓都同事，用公設大概會有一種在茶水間的錯覺吧！另外，像這種很多公司同事一起進駐的社區也是有一些潛規則，有聽過購買的樓層跟職階有相對關係的，比如說總經理住18樓 ，那董事長就可能是20樓，經理在12樓這樣，樓層要是買錯一不小心「越界」那就尷尬了。無論如何，可以員工價買房終究還是幸福的，真心希望台灣更多像這樣照顧員工的幸福企業～◎本文章內容僅反映作者個人意見，不代表Yahoo奇摩立場。國內最低工資和基本時薪最近連年調漲，不過有人力銀行調查發現，超過6成上班族3年沒調過薪；其中，甚至還有12%的人高達10年都沒被加薪。而勞工評估自我的薪資滿意度，2025年更降到36.4分，創近12年來新低。有螺絲螺帽生產業者透露，自從疫情爆發加上大環境不景氣，訂單銳減收入減少，想為員工加薪是心有餘而力不足，目前薪資已經凍漲4年。鮮奶脆皮甜甜圈店被指控騙薪之外，前員工也指控休假日也宛如奴隸，比如每個月都要到老闆的別墅幫打掃、運動、玩遊戲到深夜。還有人要幫忙裝太陽能板、甚至要求女員工穿短褲去、還要學游泳才能去員工旅遊。老闆則反駁，沒有要求員工一定要穿短褲，至於玩遊戲是尾牙沒有強迫參加。勞動局表示，休假加班打掃需要付加班費，至於要求員工穿短褲，可能涉及性騷。IC設計大廠聯發科將於2月底發放2024年下半年員工分紅，外界估算，此次分紅總金額近110億元，大約是去年8月底發放去年...領完年終再找工作的情況，近年來出現變化。根據人力銀行數據顯示，今年農曆年前一個月找工作人數，比去年同期成長3.1%，大環境缺工下，求職者更勇於在年前轉職，期盼爭取更優渥薪資。不過專家也強調，想轉職獲取高薪，學經歷、專業技能、語言能力和表達力，都相當重要。在 iPhone 以動作按鈕取代傳統的靜音撥桿後，越來越多廠商也開始為單一按鍵賦予更多功能，預載 One UI 7 的 Galaxy S25 系列便是其中之一。開學季想換新筆電卻不知道怎麼選？找高CP值的Acer筆電、桌機或電競筆電推薦，Yahoo的Acer品牌日會是最佳下單日！集結AI PC、電競筆電，甚至還有不到8千元的高性價比文書筆電，讓你省錢升級不是夢。期間限定使用聯名款最高還有6%回饋，加碼送上超贈點讓你買的超划算！[FTNN新聞網]記者莊蕙如／綜合報導台灣高鐵(2633)公布2024年財報，全年營收達531.85億元，較前一年成長6.8%，營業毛利為233.56億元，稅後淨利64.51億元，較20...電電公會理事長李詩欽今 (18) 日指出，美國總統川普上任後，供應鏈因應地緣政治赴美設廠，尤其 AI 成未來趨勢，伺服器領域成市場焦點，他進一步透露，今年 5 月、川普上任約 100 天，將有伺服器大廠宣布至美國德州擴大投資。[FTNN新聞網]記者林廷宇／綜合報導光通訊廠波若威（3163）日前搭上矽光子熱潮股價不斷攀漲，因短線漲多應主管機關要求公布最新財務數字，1月營收僅1.59億元，...安瑞攜樺漢、Google Cloud 合作智能資安防護應用MoneyDJ新聞 2025-02-19 12:45:33 記者 林昕潔 報導俄烏有望和談，預期將帶來戰後重建需求，使塑化族群後市動能備受關注，台塑四寶1月營收雖受到年節長假影響表現降溫，但多數看好2、3月市場氛圍將轉樂觀，營收動能有望往上。 法人表示，中國於元宵後拉升下游加工廠開工率，確實有提振塑化產品需求，但報價方面，目前看來變化不大，主要受供給端產能仍大於需求，目前廠商多數調降開工率、以減產保價，市場仍觀望後續需求提升幅度及力道。 不過，法人分析，目前台塑(1301)、南亞(1303)、台化(1326)股價皆低於淨值，且股價淨值比落在0.5~0.7倍，已是過往歷史最低水位，預期下檔風險有限，但後續仍須觀察油價走勢及塑化產品利差表現。 (圖片來源:資料庫)延伸閱讀：台化看2、3月氛圍漸樂觀；苯/PX利差料回升台塑四寶1月營收 僅台塑化年月雙增 資料來源-MoneyDJ理財網大學開學「燒錢」季來了！您的花費爆表了嗎？學雜費、學習用品、筆電平板一樣都不能少，荷包壓力瞬間飆升。元大金（2885）旗下元大銀行「神救援」在63間大學間7-ELEVEN推出最高20%回饋幫您省更大。透過悠遊付連結繳學雜費也有5%回饋，減輕家長負擔。股東會旺季將至，「徵求股權委託書」的戰火再度升溫！過去市場曾傳出，一張委託書可喊破千元，然而在法規明令禁止「收購」後，市場風向轉變，如今不少徵求者改以發放紀念品等方式進行拉攏，但專家提醒， 簽下委託書之前，務必先搞清楚三大關鍵。[FTNN新聞網]記者洪宗荃／台北報導台股今（20）日以下跌73.11點開低後，指數下滑後走低，目前跌幅持續縮小當中，最低下跌174.26點，來到23203.33點。而近期受...[FTNN新聞網]記者莊蕙如／綜合報導台灣證券交易所表示，自今年1月6日取消創新板「合格投資人限制」以來，市場交易熱度大幅提升。近一個月內，創新板總成交金...董監改選行情發酵中！每年3到4月是改選董監事持股比例和股價的最後防守，「改選行情」也在股市中應運而生。董監改選時常伴隨經營權爭奪的場面，不少投資人會趁此時抓緊題材賺上一筆。不過，市面上可能改選公司高達上百家，眼花好撩亂到底要怎麼選？《Yahoo奇摩財經》請股市名師統一投顧董事長黎方國篩出可成（2474）等15檔潛力股供投資人參考。記憶體大廠華邦電（2344）連6日漲幅高達34%，然而昨（19）日開完法說會，今（20）日盤中股價卻一度重摔7.8％，截止上午10時40分，股價落在18.15元。對此，摩爾投顧分析師鐘崑禎指出，因股價連續性跌深反彈，套牢壓力重，再加上法說會卻沒出現驚喜，短線操作上不建議今日買進。睽違三年，台灣好市多再度調薪！美式賣場好市多近日發出內部通知，台灣區將自4月1日起調薪，助理員最低時薪自新台幣243元調高至253元，月薪可達4萬3769元，其他級數時薪人員平均加薪約4%，其中最高級數服務員時薪來到384元，換算月薪突破6.6萬元。[FTNN新聞網]記者曾奕語／綜合報導有「國民ETF」之稱的國泰永續高股息（00878）今天（20日）除息，開盤微揚0.05元至22.51元開出，盤中一度陷入貼息態勢，約上...[FTNN新聞網]記者蔡昀庭／台北報導財信傳媒董事長謝金河昨（19日）晚在臉書發文，台灣精銳（4583）從他點名後，股價在一年多內從不到200元漲到975元，並且認...抽不到興櫃小巨人印能沒關係！光焱科技（7728）近期辦理初次上櫃公開申購，抽中一張有望賺逾16萬元，報酬率飆破七成，比印能還高。綠能環保族群今（20）日成焦點之一，除上櫃股綠電（8440）直飆漲停，雲豹能源（6869）、森崴能源（6806）分別漲近3%，率領上市櫃31檔綠能個股中有27檔上漲。大華投顧分析師林睿閎表示，綠能環保股今日相對大盤穩健強勢，相對於受關稅陰霾籠罩的大型股，一些內需為主的綠能概念股反而可以趁低布局。美俄元首通話為俄烏停戰帶來轉機，水泥產業有望迎來戰後重建需求，今日（20）盤中相關指數上漲2.4%，領漲指標股台泥（1101）因在土耳其OYAK的轉投資具有地利優勢，一度飆漲3.93%，也引發網友討論「台泥現在買還來得及嗎？」對此，顧德投顧分析師何文高表示，若烏克蘭重建商機的題材未能有效發酵，台泥的股價可能仍將呈現區間震盪。每年春季都有大批旅客前往日本賞櫻，不過，最近日圓強升，今（20）日兌美元升破150大關， 台銀匯價也來到0.22字頭，近4個月新高，拿10萬台幣換，少換2.2萬日圓，等於少吃22碗一蘭拉麵。在AI、HPC新應用推動下，先進封裝商機持續噴發，也為設備廠商創造絕佳機會。其中，先進製程解決方案大廠印能科技(7734)即將掛牌上櫃，這家公司以半導體「封裝製程氣泡解決方案」聞名，他們如何看待後市?未來營運展望又是如何呢?MoneyDJ TV帶您一探究竟。 #印能 #CoWoS #FOPLP #CPO #先進封裝 #半導體設備 #IC封測 #台積電 #翹曲 #除泡機川普(Donald Trump)預告最快4月2日對半導體、汽車、藥品課徵25%以上關稅。學者今天(20日)指出，台灣出口這3類產品皆屬中間財，影響有限，即便是半導體，台積電先進製程仍有議價能力，不過川普尚未使出殺手鐧，未來台積電仍有赴美壓力。另一名學者則說，台積電中長期對美投資比重升高，帶動供應鏈投資移轉，將衝擊台灣民間投資，不利經濟發展。 美國總統川普日前指出，預計對進口汽車、藥品和半導體徵收25％關稅，且稅率還會再增加，最快4月2日上路，他並透露，目前已有晶片與汽車大廠表達要回美投資意願，近幾週將會宣布。 東海大學經濟系兼任教授、亞太商工總會執行長邱達生20日分析，以實際面來說，汽車、半導體、藥品都不適合在美國投資，主要是美國生產成本及工資高昂，又有工會強勢的問題，即便外資礙於關稅壓力宣布赴美，也可能以拖待變，甚至在川普卸任後撤資。 至於對台灣的影響，邱達生認為，台灣出口這三類產品皆為中間財，衝擊並不大。其中，台灣汽車零組件廠商可能會受到客戶要求，分擔部分關稅；半導體方面，台積電先進製程無人能敵，可順利轉嫁關稅，成熟製程業者壓力會比較大。 邱達生指出，川普目前仍未真的對台積電動用殺【時報記者王逸芯台北報導】合勤控（3704）旗下兆勤科技（Zyxel Networks）宣布，蔡明見將於2025年2月起正式接任總經理一職。 自2019年從合勤科技分拆成立以來，兆勤科技專注於中小企業的網路通訊市場，並透過自有品牌Zyxel Networks及其核心的Nebula雲端網路管理平台與資安解決方案，成功在市場中建立了明確的區隔與競爭力。蔡明見先生的上任，將為兆勤科技帶來更多創新思維和市場洞察，進一步加速公司在全球市場的成長。 蔡明見表示：「兆勤科技自成立以來，一直致力於為中小企業提供卓越的網路解決方案。我們透過Nebula雲端管理平台和資安解決方案，成功將自主研發技術推向國際市場，並建立穩固的商業模式。未來，我們將以此為基礎，穩健前行。我深感使命重大，並將全力以赴，帶領兆勤科技持續成長與創新。」 蔡明見在合勤集團擁有19年的服務經歷，曾在多個關鍵策略營運與產品管理單位擔任要職，包括Gateway事業總處、管理中心、全球人資處及營運支援中心。他擁有豐富的品牌經營、市場開拓及客戶體驗經驗，並曾駐歐洲市場多年，成功帶領跨部門及跨文化團隊實現業務目標，這些經驗將為兆勤科技未來的發展【財訊快報／記者劉居全報導】玉山金控(2884)旗下玉山銀行打造永續轉型平台，結合專家團隊提供企業客製化永續金融服務方案，提升永續生態圈韌性，協助企業面對淨零轉型的挑戰。此次攜手宏于電機、金屬中心共同推動重電產業綠色供應鏈，於昨（19）日共同簽署永續合作意向書（MOU）。玉山銀行表示，此次三方合作簽署MOU，玉山將透過永續金融結合金屬中心以大帶小的政府資源，協助宏于電機推動低碳產品及綠色供應鏈、系統化進行範疇三管理、導入輔導資源等項目，與供應商一同朝淨零碳排目標邁進，創造社會共好、企業永續的未來。宏于電機面對全球氣候變遷和碳排減量的挑戰，持續開發低碳產品及創新能源解決方案，總經理詹家榮宣布以「能源轉型，碳排淨零」為行動目標，將自家工廠打造為微電網示範基地，建構智慧微電網，整合創能、儲能、充電樁及能源管理系統，啟動「微電網X能源轉型計畫」，透過創能與儲能技術有效降低能源消耗，實現更高效的能源利用。金屬中心積極推動淨零碳排政策，支持國內產業實現永續發展目標，更運用專業知識與技術，協助大型企業梳理產品全生命週期中的碳排放熱點，並透過帶動供應鏈中的中小型企業同步進行碳排放管理，結合政府政策與企【時報-台北電】南亞科(2408)與華邦電(2344)19日股價表現強勢，成為市場矚目焦點，今早開盤多方續強，南亞科直接跳空站上40元之上，然而大盤表現不佳，投資人不敢任性追價，反而在高檔引爆獲利了結賣壓，南亞科直接翻黑下探到37.6元。華邦電遭外資四賣達7.54萬張，投信、自營商亦站空方，在法人無情砍殺之下，盤中下挫逾半根跌停板，18元不保。相對於昨日煙花四射的表現，今日熱情冷卻，形成兩樣情。 目前台DRAM廠受到利基型DRAM需求尚未明顯回升，短期營運仍面臨壓力，不過，業界傳出記憶體三大原廠三星、SK海力士與美光將陸續停止生產DDR3、DDR4，最快夏季後市場可能出現供應缺口，南亞科、華邦電有機會受惠。由於兩檔個股都在相對便宜水位，資金積極搶短，19日點火一日行情。 南亞科於日前的法說會上提到2025年DRAM供給增加，新增產能持續提高HBM與DDR5占比。而常規DRAM產品的庫存將持續去化。且需求方面，AI伺服器及一般伺服器需求都持續正面成長，而手機業者庫存逐步回到正常水位，上半年有機會改善供需平衡。盤中股價重跌逾3%，但仍高於5日線上。 華邦電展望今年Nor Flash上半年供彩券開獎要等30分 網疑在作弊？ 台彩主持人全說了【財訊快報／記者張家瑋報導】住展雜誌統計排行北台灣2024年十大代銷在住宅產品接案狀況（不含商辦、廠辦建案），依接案量統計依序為海悅(2348)、新聯陽、甲山林、新理想、創意家、新高創、信義(9940)、聯鑫、漢華、甲桂林，接案量介於248至1694億元，總接案量來到6523.3億元，相比2023年增27.2%。住展雜誌發言人陳炳辰指出，2024年上半年房市一片欣欣向榮，推案都走順銷，創造量體，雖然下半年的銀行貸款滿水位危機、央行新一波打炒房政策，逆轉市場信心，但早已承接規劃的新案難以說停就停，持續累積案量，此次奪下冠亞軍的海悅、新聯陽指標案不乏在冷氣團中登場，展現接案實力。2024年十大代銷之首的海悅，總接案量1694億元，10多年以來的統計資料年年居冠，去年接下兩、300億元案量的新北市淡海新市鎮的「新海城」，與中和區捷運宅「大同新紀元」，還有各達百億元量體的「METRO PARK」、「META PARK」，其中「大同新紀元」在房市寒冬中仍傳買氣。居2、3名的新聯陽、甲山林與去年名次相同，新聯陽接案量來到1410.4億元，承接總銷600億元台北市文山區指標大案「元利四季莊園」成為最</code></pre>
</div>
</div>
</section>
<section id="即時股價爬取---爬連結內的新聞-3" class="slide level2">
<h2>即時股價爬取 - 爬連結內的新聞</h2>
<p>用<code>for</code>迴圈一次做完所有連結，並轉成pandas data frame</p>
<div id="0a3bcf4d" class="cell" data-execution_count="40">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href=""></a>newdf <span class="op">=</span> []</span>
<span id="cb60-2"><a href=""></a><span class="cf">for</span> title_click <span class="kw">in</span> news:</span>
<span id="cb60-3"><a href=""></a>  title <span class="op">=</span> title_click.get_text()</span>
<span id="cb60-4"><a href=""></a>  url <span class="op">=</span> title_click.find(<span class="st">"a"</span>).get(<span class="st">"href"</span>)</span>
<span id="cb60-5"><a href=""></a>  res <span class="op">=</span> requests.get(url)</span>
<span id="cb60-6"><a href=""></a>  soup <span class="op">=</span> BeautifulSoup(res.text, <span class="st">"html.parser"</span>)</span>
<span id="cb60-7"><a href=""></a>  news_full <span class="op">=</span> soup.select(<span class="st">"p"</span>)</span>
<span id="cb60-8"><a href=""></a>  full_text <span class="op">=</span> <span class="st">""</span></span>
<span id="cb60-9"><a href=""></a>  <span class="cf">for</span> news_para <span class="kw">in</span> news_full:</span>
<span id="cb60-10"><a href=""></a>    full_text <span class="op">=</span> full_text <span class="op">+</span> news_para.get_text()</span>
<span id="cb60-11"><a href=""></a>  add_news <span class="op">=</span> pd.DataFrame({<span class="st">"title"</span>:[title],<span class="st">"content"</span>:[full_text]})</span>
<span id="cb60-12"><a href=""></a>  newdf.append(add_news)</span>
<span id="cb60-13"><a href=""></a></span>
<span id="cb60-14"><a href=""></a>newdf_pd<span class="op">=</span>pd.concat(newdf)</span>
<span id="cb60-15"><a href=""></a>newdf_pd</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="78">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe caption-top" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header" style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">title</th>
<th data-quarto-table-cell-role="th">content</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>工商時報1 天前這家台積電轉投資公司大跳水「這原因」拖垮股價逼近跌停- 證券</td>
<td>如果您看到這個頁面，表示您的網路已遭到停止訪問本網站的權利。本站基於資訊安全以及保護網站內容...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">0</td>
<td>奇摩股市3 小時前企業寵員工無極限！台積電員工福利也比不上它貼心「這間」竟直接蓋房讓員工撿便...</td>
<td>Yahoo房市觀察員/ Sam（地產秘密客版主）哪一種員工福利最吸引人？前陣子有人力銀行進行...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>聯合新聞網6 小時前台積電可能投資英特爾晶圓廠 外媒：台美恐掀政治憂慮</td>
<td>外傳台積電（2330）和博通可能各自收購英特爾的晶圓代工與晶片設計部門，巴隆周刊（Barro...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">0</td>
<td>MoneyDJ1 天前外媒：台積是憑企業文化拿下領先 難跟Intel兼容-新聞內容-基金</td>
<td>MoneyDJ新聞 2025-02-19 11:38:22 記者 郭妍希 報導\r\n市場最...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>今周刊1 天前大成鋼漲不停、台塑谷底翻身，都因「美國製造」…台積電、環球晶超前佈署，這2家準...</td>
<td>龔招健台股達志勿轉1470期2025-02-19 09:28儘管美國製造成本較高，但美國是台...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">0</td>
<td>TVBS新聞網1 天前【川普施壓台積電3】補貼政策恐生變 台積電在美擴大投資還有3大難關</td>
<td>點擊關閉或任一空白處，繼續閱讀新聞。追蹤我們掌握最新動態人氣點閱榜今日頭條TVBS民調／近半...</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="即時股價爬取---爬連結內的新聞-4" class="slide level2">
<h2>即時股價爬取 - 爬連結內的新聞</h2>
<div id="48d70e01" class="cell" data-execution_count="41">
<div class="cell-output cell-output-display" data-execution_count="79">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe caption-top" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header" style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">title</th>
<th data-quarto-table-cell-role="th">content</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>工商時報1 天前這家台積電轉投資公司大跳水「這原因」拖垮股價逼近跌停- 證券</td>
<td>如果您看到這個頁面，表示您的網路已遭到停止訪問本網站的權利。本站基於資訊安全以及保護網站內容...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">0</td>
<td>奇摩股市3 小時前企業寵員工無極限！台積電員工福利也比不上它貼心「這間」竟直接蓋房讓員工撿便...</td>
<td>Yahoo房市觀察員/ Sam（地產秘密客版主）哪一種員工福利最吸引人？前陣子有人力銀行進行...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>聯合新聞網6 小時前台積電可能投資英特爾晶圓廠 外媒：台美恐掀政治憂慮</td>
<td>外傳台積電（2330）和博通可能各自收購英特爾的晶圓代工與晶片設計部門，巴隆周刊（Barro...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">0</td>
<td>MoneyDJ1 天前外媒：台積是憑企業文化拿下領先 難跟Intel兼容-新聞內容-基金</td>
<td>MoneyDJ新聞 2025-02-19 11:38:22 記者 郭妍希 報導\r\n市場最...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>今周刊1 天前大成鋼漲不停、台塑谷底翻身，都因「美國製造」…台積電、環球晶超前佈署，這2家準...</td>
<td>龔招健台股達志勿轉1470期2025-02-19 09:28儘管美國製造成本較高，但美國是台...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">0</td>
<td>TVBS新聞網1 天前【川普施壓台積電3】補貼政策恐生變 台積電在美擴大投資還有3大難關</td>
<td>點擊關閉或任一空白處，繼續閱讀新聞。追蹤我們掌握最新動態人氣點閱榜今日頭條TVBS民調／近半...</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="hands-on-爬蟲練習-1" class="slide level2">
<h2>Hands-on 爬蟲練習</h2>
<ul>
<li><a href="https://www.ptt.cc/bbs/Tech_Job/index.html">Ptt Tech_Job 版</a></li>
<li>試著爬出<strong>最新的一頁</strong>、<strong>前一頁</strong>以及<strong>前前一頁</strong>的所有<strong>標題</strong>和<strong>內文網址</strong></li>
<li>總共爬出幾個標題？</li>
<li>提示：
<ul>
<li>下載html <code>requests.get(網址)</code></li>
<li>解析html <code>BeautifulSoup(下載網頁.text, "html.parser")</code><br>
</li>
<li>搜尋所需節點 <code>find(節點)</code>, <code>select(css條件)</code></li>
<li>取出需要的資料 <code>get_text()</code>, <code>get(屬性名稱)</code></li>
</ul></li>
<li>一頁一頁爬 or for 迴圈都可以</li>
</ul>
</section>
<section id="網頁爬蟲-進階版" class="slide level2">
<h2>網頁爬蟲 進階版</h2>
<ul>
<li>滾動式等動態網頁網頁，如剛剛的新聞
<ul>
<li><a href="https://hackmd.io/@AndyChiang/DynamicCrawler">Python 進階爬蟲 by Andy Chiang</a></li>
</ul></li>
</ul>
</section>
<section id="網頁爬蟲-再想想" class="slide level2">
<h2>網頁爬蟲 再想想？</h2>
<ul>
<li>其實… 很多資料有其他存取方式，像API</li>
<li>隱私問題 （OkCupid事件）
<ul>
<li><a href="https://motherboard.vice.com/en_us/article/70000-okcupid-users-just-had-their-data-published">70,000 OkCupid Users Just Had Their Data Published</a></li>
</ul></li>
</ul>
</section>
<section id="網頁爬蟲-webscraping---recap" class="slide level2">
<h2>網頁爬蟲 Webscraping - Recap</h2>
<ul>
<li>下載html <code>requests.get(網址)</code></li>
<li>解析html <code>BeautifulSoup(下載網頁.text, "html.parser")</code></li>
<li>搜尋所需節點 <code>find(節點)</code>, <code>select(css條件)</code></li>
<li>取出需要的資料 <code>get_text()</code>, <code>get(屬性名稱)</code></li>
</ul>
</section>
<section id="data-input-and-output-5" class="slide level2">
<h2>Data input and output</h2>
<ul>
<li>Data input
<ul>
<li>From file</li>
<li>From google drive</li>
<li>From API</li>
<li>Webscrapping</li>
</ul></li>
<li><strong>Data output</strong></li>
</ul>
</section></section>
<section>
<section id="資料匯出" class="title-slide slide level1 center">
<h1>資料匯出</h1>

</section>
<section id="資料匯出-1" class="slide level2">
<h2>資料匯出</h2>
<ul>
<li>文字檔 .txt</li>
<li>CSV檔 .csv</li>
<li>json檔 .json</li>
</ul>
</section>
<section id="資料匯出---文字檔-.txt" class="slide level2">
<h2>資料匯出 - 文字檔 .txt</h2>
<ul>
<li>首先使用<code>open(檔案名稱)</code>開啟檔案</li>
<li>使用<code>檔案.writelines(資料)</code>寫入內容</li>
<li><code>檔案.writelines(資料)</code>的資料可以是列表</li>
</ul>
<div id="f3d1bf9f" class="cell" data-execution_count="42">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb61-1"><a href=""></a>path <span class="op">=</span> <span class="st">'output_writeline.txt'</span></span>
<span id="cb61-2"><a href=""></a>f <span class="op">=</span> <span class="bu">open</span>(path, <span class="st">'w'</span>)</span>
<span id="cb61-3"><a href=""></a>lines1 <span class="op">=</span> [<span class="st">'Hello World'</span>, <span class="st">'123'</span>, <span class="st">'456'</span>, <span class="st">'789'</span>]</span>
<span id="cb61-4"><a href=""></a>lines2 <span class="op">=</span> [<span class="st">'Hello World</span><span class="ch">\n</span><span class="st">'</span>, <span class="st">'123</span><span class="ch">\n</span><span class="st">'</span>, <span class="st">'456</span><span class="ch">\n</span><span class="st">'</span>, <span class="st">'789</span><span class="ch">\n</span><span class="st">'</span>]</span>
<span id="cb61-5"><a href=""></a>f.writelines(lines1)</span>
<span id="cb61-6"><a href=""></a>f.writelines(lines2)</span>
<span id="cb61-7"><a href=""></a>f.close()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="資料匯出---文字檔-.txt-1" class="slide level2">
<h2>資料匯出 - 文字檔 .txt</h2>
<ul>
<li>首先使用<code>open(檔案名稱)</code>開啟檔案</li>
<li>使用<code>檔案.write(資料)</code>寫入內容</li>
<li><code>檔案.write(資料)</code>的資料必須是文字</li>
</ul>
<div id="acc193d0" class="cell" data-execution_count="43">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb62-1"><a href=""></a>path <span class="op">=</span> <span class="st">'output_write.txt'</span></span>
<span id="cb62-2"><a href=""></a>f <span class="op">=</span> <span class="bu">open</span>(path, <span class="st">'w'</span>)</span>
<span id="cb62-3"><a href=""></a><span class="cf">for</span> t <span class="kw">in</span> lines1:</span>
<span id="cb62-4"><a href=""></a>  f.write(t)</span>
<span id="cb62-5"><a href=""></a>  </span>
<span id="cb62-6"><a href=""></a><span class="cf">for</span> t <span class="kw">in</span> lines2:</span>
<span id="cb62-7"><a href=""></a>  f.write(t)</span>
<span id="cb62-8"><a href=""></a></span>
<span id="cb62-9"><a href=""></a>f.close()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="資料匯出---csv檔-.csv" class="slide level2">
<h2>資料匯出 - CSV檔 .csv</h2>
<p>使用<code>pandas</code> Data frame物件中的<code>.to_csv(檔名)</code>儲存檔案。</p>
<div id="35258174" class="cell" data-execution_count="44">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb63-1"><a href=""></a>house.to_csv(<span class="st">"house.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="資料匯出---json檔-.json" class="slide level2">
<h2>資料匯出 - json檔 .json</h2>
<p>使用<code>pandas</code> Data frame物件中的<code>.to_json(檔名)</code>儲存檔案。</p>
<p>DataFrame中一定要有index</p>
<div id="9fc074aa" class="cell" data-execution_count="45">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb64-1"><a href=""></a>house.to_json(<span class="st">"house.json"</span>)</span>
<span id="cb64-2"><a href=""></a>house</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="83">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe caption-top" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header" style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">鄉鎮市區</th>
<th data-quarto-table-cell-role="th">交易標的</th>
<th data-quarto-table-cell-role="th">土地位置建物門牌</th>
<th data-quarto-table-cell-role="th">土地移轉總面積平方公尺</th>
<th data-quarto-table-cell-role="th">都市土地使用分區</th>
<th data-quarto-table-cell-role="th">非都市土地使用分區</th>
<th data-quarto-table-cell-role="th">非都市土地使用編定</th>
<th data-quarto-table-cell-role="th">交易年月日</th>
<th data-quarto-table-cell-role="th">交易筆棟數</th>
<th data-quarto-table-cell-role="th">移轉層次</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">總價元</th>
<th data-quarto-table-cell-role="th">單價元平方公尺</th>
<th data-quarto-table-cell-role="th">車位類別</th>
<th data-quarto-table-cell-role="th">車位移轉總面積平方公尺</th>
<th data-quarto-table-cell-role="th">車位總價元</th>
<th data-quarto-table-cell-role="th">備註</th>
<th data-quarto-table-cell-role="th">主建物面積</th>
<th data-quarto-table-cell-role="th">附屬建物面積</th>
<th data-quarto-table-cell-role="th">陽台面積</th>
<th data-quarto-table-cell-role="th">電梯</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>新竹市</td>
<td>土地</td>
<td>明湖段840地號</td>
<td>18.74</td>
<td>NaN</td>
<td>山坡地保育區</td>
<td>農牧用地</td>
<td>1121101</td>
<td>土地1建物0車位0</td>
<td>NaN</td>
<td>...</td>
<td>150000</td>
<td>8004.0</td>
<td>NaN</td>
<td>0.00</td>
<td>0</td>
<td>NaN</td>
<td>0.00</td>
<td>0.00</td>
<td>0.00</td>
<td>無</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>新竹市</td>
<td>土地</td>
<td>新莊段198地號</td>
<td>42.95</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>1121101</td>
<td>土地12建物0車位0</td>
<td>NaN</td>
<td>...</td>
<td>4576000</td>
<td>106542.0</td>
<td>NaN</td>
<td>0.00</td>
<td>0</td>
<td>親友、員工、共有人或其他特殊關係間之交易；</td>
<td>0.00</td>
<td>0.00</td>
<td>0.00</td>
<td>無</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>新竹市</td>
<td>房地(土地+建物)</td>
<td>新竹市新竹市光華街９５巷３號５樓之３</td>
<td>6.72</td>
<td>住</td>
<td>NaN</td>
<td>NaN</td>
<td>1121101</td>
<td>土地1建物1車位0</td>
<td>五層</td>
<td>...</td>
<td>3630000</td>
<td>81665.0</td>
<td>NaN</td>
<td>0.00</td>
<td>0</td>
<td>NaN</td>
<td>31.62</td>
<td>0.00</td>
<td>3.74</td>
<td>有</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>新竹市</td>
<td>土地</td>
<td>南門段四小段177-25地號</td>
<td>29.67</td>
<td>都市：其他:道路用地</td>
<td>NaN</td>
<td>NaN</td>
<td>1121103</td>
<td>土地1建物0車位0</td>
<td>NaN</td>
<td>...</td>
<td>1316221</td>
<td>44362.0</td>
<td>NaN</td>
<td>0.00</td>
<td>0</td>
<td>包含公共設施保留地用地；</td>
<td>0.00</td>
<td>0.00</td>
<td>0.00</td>
<td>無</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>新竹市</td>
<td>土地</td>
<td>東山段一小段189-11地號</td>
<td>357.38</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>1121107</td>
<td>土地1建物0車位0</td>
<td>NaN</td>
<td>...</td>
<td>5038989</td>
<td>14100.0</td>
<td>NaN</td>
<td>0.00</td>
<td>0</td>
<td>協議價購；</td>
<td>0.00</td>
<td>0.00</td>
<td>0.00</td>
<td>無</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2864</td>
<td>新竹市</td>
<td>房地(土地+建物)+車位</td>
<td>新竹市新竹市埔頂三路３２號十八樓之９</td>
<td>6.53</td>
<td>商</td>
<td>NaN</td>
<td>NaN</td>
<td>1080326</td>
<td>土地1建物1車位1</td>
<td>十八層</td>
<td>...</td>
<td>7360000</td>
<td>77553.0</td>
<td>坡道平面</td>
<td>28.88</td>
<td>1200000</td>
<td>預售屋、或土地及建物分件登記案件；</td>
<td>45.68</td>
<td>1.78</td>
<td>4.48</td>
<td>有</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2865</td>
<td>新竹市</td>
<td>房地(土地+建物)+車位</td>
<td>新竹市新竹市埔頂三路３６號二十八樓之１０</td>
<td>6.44</td>
<td>商</td>
<td>NaN</td>
<td>NaN</td>
<td>1080324</td>
<td>土地1建物1車位1</td>
<td>二十八層</td>
<td>...</td>
<td>6980000</td>
<td>75472.0</td>
<td>坡道平面</td>
<td>24.86</td>
<td>1100000</td>
<td>預售屋權利轉售，讓渡日期:110年05月13日，權利買賣契約成交價格980萬元。預售屋、或土...</td>
<td>44.84</td>
<td>1.78</td>
<td>4.33</td>
<td>有</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2866</td>
<td>新竹市</td>
<td>房地(土地+建物)+車位</td>
<td>新竹市新竹市埔頂三路２號</td>
<td>20.23</td>
<td>商</td>
<td>NaN</td>
<td>NaN</td>
<td>1080317</td>
<td>土地1建物1車位2</td>
<td>一層，二層</td>
<td>...</td>
<td>55280000</td>
<td>222072.0</td>
<td>坡道平面</td>
<td>57.76</td>
<td>2700000</td>
<td>預售屋權利轉讓，讓渡日期：108年07月13日，權利買賣契約成交價 5880 萬元。預售屋、...</td>
<td>170.24</td>
<td>0.00</td>
<td>0.00</td>
<td>有</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2867</td>
<td>新竹市</td>
<td>房地(土地+建物)+車位</td>
<td>新竹市新竹市埔頂三路６６號</td>
<td>19.96</td>
<td>商</td>
<td>NaN</td>
<td>NaN</td>
<td>1080317</td>
<td>土地1建物1車位2</td>
<td>一層，二層</td>
<td>...</td>
<td>52180000</td>
<td>212854.0</td>
<td>坡道平面</td>
<td>57.76</td>
<td>2700000</td>
<td>預售屋、或土地及建物分件登記案件；</td>
<td>167.16</td>
<td>0.00</td>
<td>0.00</td>
<td>有</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2868</td>
<td>新竹市</td>
<td>房地(土地+建物)+車位</td>
<td>新竹市新竹市埔頂三路６８號</td>
<td>20.23</td>
<td>商</td>
<td>NaN</td>
<td>NaN</td>
<td>1080324</td>
<td>土地1建物1車位2</td>
<td>一層，二層</td>
<td>...</td>
<td>53280000</td>
<td>213625.0</td>
<td>坡道平面</td>
<td>57.76</td>
<td>2700000</td>
<td>預售屋、或土地及建物分件登記案件；</td>
<td>170.24</td>
<td>0.00</td>
<td>0.00</td>
<td>有</td>
</tr>
</tbody>
</table>

<p>2869 rows × 31 columns</p>
</div>
</div>
</div>
</section>
<section id="hands-on-資料匯出" class="slide level2">
<h2>Hands-on 資料匯出</h2>
<ul>
<li><a href="https://www.ptt.cc/bbs/Tech_Job/index.html">Ptt Tech_Job 版</a></li>
<li>試著爬出最新一頁的所有<strong>標題</strong> (Hint!)</li>
<li>將標題存成一個資料框</li>
<li>儲存標題資料框，檔名為ptt.csv</li>
</ul>
</section>
<section id="hands-on-資料匯出-1" class="slide level2">
<h2>Hands-on 資料匯出</h2>
<div id="5956a713" class="cell" data-execution_count="46">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb65-1"><a href=""></a><span class="im">from</span> bs4 <span class="im">import</span> BeautifulSoup</span>
<span id="cb65-2"><a href=""></a><span class="im">import</span> requests</span>
<span id="cb65-3"><a href=""></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb65-4"><a href=""></a><span class="co"># step 1 download url</span></span>
<span id="cb65-5"><a href=""></a>res <span class="op">=</span> requests.get(<span class="st">"https://www.ptt.cc/bbs/Tech_Job/index.html"</span>)</span>
<span id="cb65-6"><a href=""></a><span class="co"># step 2 parse html</span></span>
<span id="cb65-7"><a href=""></a>soup <span class="op">=</span> BeautifulSoup(res.text, <span class="st">"html.parser"</span>)</span>
<span id="cb65-8"><a href=""></a><span class="co"># step 3 select tags/css</span></span>
<span id="cb65-9"><a href=""></a>title_tags <span class="op">=</span> soup.select(<span class="st">".title a"</span>)</span>
<span id="cb65-10"><a href=""></a><span class="bu">print</span>(title_tags)</span>
<span id="cb65-11"><a href=""></a><span class="co"># step 4 get the data</span></span>
<span id="cb65-12"><a href=""></a>title_list<span class="op">=</span>[] </span>
<span id="cb65-13"><a href=""></a><span class="cf">for</span> title <span class="kw">in</span> title_tags:</span>
<span id="cb65-14"><a href=""></a>  title_list.append(title.get_text())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[&lt;a href="/bbs/Tech_Job/M.1740002631.A.06C.html"&gt;Re: Wed Feb 19 02:15:01 2025&lt;/a&gt;, &lt;a href="/bbs/Tech_Job/M.1740005514.A.E98.html"&gt;Re: [新聞] 台積電美國廠3挑戰曝光　魏哲家坦言「我&lt;/a&gt;, &lt;a href="/bbs/Tech_Job/M.1740011374.A.9C5.html"&gt;[討論] 智易智邦年薪&lt;/a&gt;, &lt;a href="/bbs/Tech_Job/M.1740012359.A.15B.html"&gt;[新聞] 聯發科分紅 每人估領91萬 員工加薪同步&lt;/a&gt;, &lt;a href="/bbs/Tech_Job/M.1740017723.A.3A1.html"&gt;[新聞] 黃仁勳曾請攝影師，對某失職主管「臉部特&lt;/a&gt;, &lt;a href="/bbs/Tech_Job/M.1740018719.A.CB2.html"&gt;[請益] 台塑警衛好嗎？&lt;/a&gt;, &lt;a href="/bbs/Tech_Job/M.1740023613.A.9DD.html"&gt;[討論] 養1個全職竹科太太+2孩 年收入要多少 &lt;/a&gt;, &lt;a href="/bbs/Tech_Job/M.1393646135.A.A28.html"&gt;[公告] Tech_Job板板規 2022.05.26更新&lt;/a&gt;, &lt;a href="/bbs/Tech_Job/M.1410062073.A.1B6.html"&gt;[公告] 置底 檢舉/推薦 文章&lt;/a&gt;, &lt;a href="/bbs/Tech_Job/M.1425268790.A.15E.html"&gt;[公告] 如何消除退文 轉自Ask板&lt;/a&gt;, &lt;a href="/bbs/Tech_Job/M.1585618843.A.D43.html"&gt;[情報] 薪資查詢平台&lt;/a&gt;, &lt;a href="/bbs/Tech_Job/M.1653574616.A.A15.html"&gt;[公告] 板規十五 offer請益文 m文解除申請&lt;/a&gt;]</code></pre>
</div>
</div>
</section>
<section id="資料匯出---recap" class="slide level2">
<h2>資料匯出 - Recap</h2>
<ul>
<li>文字檔 .txt <code>writelines(內容)</code></li>
<li>CSV檔 .csv <code>pandas_df.to_csv(檔名)</code></li>
<li>json檔 .json <code>pandas_df.to_json(檔名)</code></li>
</ul>
</section>
<section id="references" class="slide level2">
<h2>References</h2>
<ul>
<li><a href="https://www.py4e.com/">Python for Everybody</a>
<ul>
<li>Some contents are from Python for Everybody, and these contents are Copyright 2010- Charles R. Severance (www.dr-chuck.com) of the University of Michigan School of Information and open.umich.edu and made available under a Creative Commons Attribution 4.0 License.</li>
</ul></li>
<li><a href="https://jakevdp.github.io/PythonDataScienceHandbook/">Python Data Science Handbook</a></li>
</ul>
</section></section>
<section id="questions" class="title-slide slide level1 center">
<h1>Questions?</h1>
<div class="quarto-auto-generated-content">
<div class="footer footer-default">

</div>
</div>
</section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="4_DataIO_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="4_DataIO_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="4_DataIO_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="4_DataIO_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="4_DataIO_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="4_DataIO_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="4_DataIO_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="4_DataIO_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="4_DataIO_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="4_DataIO_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const onCopySuccess = function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      }
      const getTextToCopy = function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
        text: getTextToCopy
      });
      clipboard.on('success', onCopySuccess);
      if (window.document.getElementById('quarto-embedded-source-code-modal')) {
        // For code content inside modals, clipBoardJS needs to be initialized with a container option
        // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
        const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
          text: getTextToCopy,
          container: window.document.getElementById('quarto-embedded-source-code-modal')
        });
        clipboardModal.on('success', onCopySuccess);
      }
        var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
        var mailtoRegex = new RegExp(/^mailto:/);
          var filterRegex = new RegExp('/' + window.location.host + '/');
        var isInternal = (href) => {
            return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
        }
        // Inspect non-navigation links and adorn them if external
     	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
        for (var i=0; i<links.length; i++) {
          const link = links[i];
          if (!isInternal(link.href)) {
            // undo the damage that might have been done by quarto-nav.js in the case of
            // links that we want to consider external
            if (link.dataset.originalHref !== undefined) {
              link.href = link.dataset.originalHref;
            }
          }
        }
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note) {
            return note.innerHTML;
          } else {
            return "";
          }
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>