<!DOCTYPE html>
<html lang="en"><head>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="4_DataIO_files/libs/clipboard/clipboard.min.js"></script>
<script src="4_DataIO_files/libs/quarto-html/tabby.min.js"></script>
<script src="4_DataIO_files/libs/quarto-html/popper.min.js"></script>
<script src="4_DataIO_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="4_DataIO_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="4_DataIO_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href="4_DataIO_files/libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="4_DataIO_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.5.57">

  <meta name="author" content="Yi-Ju Tseng">
  <title>4. Data I/O</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="4_DataIO_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="4_DataIO_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; font-weight: bold; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="4_DataIO_files/libs/revealjs/dist/theme/quarto.css">
  <link href="4_DataIO_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="4_DataIO_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="4_DataIO_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="4_DataIO_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    padding-bottom: 0.5rem;
    margin-bottom: 0;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
  
  <script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">4. Data I/O</h1>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Yi-Ju Tseng 
</div>
</div>
</div>

</section>
<section id="data-input-and-output" class="slide level2">
<h2>Data input and output</h2>
<ul>
<li>Data input
<ul>
<li>From file</li>
<li>From google drive</li>
<li>From API</li>
<li>From database</li>
<li>Webscrapping</li>
</ul></li>
<li>Data output</li>
</ul>
</section>
<section id="前置作業" class="slide level2">
<h2>前置作業</h2>
<p>為了成功從https (加密封包傳輸)下載資料，首先取消證書驗證</p>
<div id="00f23d73" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href=""></a><span class="im">import</span> ssl</span>
<span id="cb1-2"><a href=""></a>ssl._create_default_https_context <span class="op">=</span> ssl._create_unverified_context</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="data-input-and-output-1" class="slide level2">
<h2>Data input and output</h2>
<ul>
<li><strong>Data input</strong>
<ul>
<li><strong>From file</strong></li>
<li>From google drive</li>
<li>From API</li>
<li>From database</li>
<li>Webscrapping</li>
</ul></li>
<li>Data output</li>
</ul>
</section>
<section>
<section id="from-file" class="title-slide slide level1 center">
<h1>From File</h1>

</section>
<section id="from-file-1" class="slide level2">
<h2>From File</h2>
<ul>
<li>.csv 逗號分隔格式檔案</li>
<li>.xls Excel格式檔案</li>
<li>.pkl pickle格式檔案 <strong>python常用</strong></li>
<li>純文字資料</li>
<li>其他格式</li>
</ul>
</section>
<section id="csv-逗號分隔格式檔案" class="slide level2">
<h2>.csv 逗號分隔格式檔案</h2>
<ul>
<li>.csv 為逗號分隔格式檔案</li>
<li><code>pandas</code>的<code>read_csv(路徑)</code>，將檔案匯入</li>
<li>路徑可以是<em>本機端路徑</em>，也可以是<em>網址</em></li>
</ul>
<div id="f4409553" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href=""></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb2-2"><a href=""></a>url <span class="op">=</span> <span class="st">"https://quality.data.gov.tw//dq_download_csv.php?nid=102775&amp;md5_url=ea56d6e1f2642b2c5c44f9e8b6185d54"</span></span>
<span id="cb2-3"><a href=""></a>df_csv <span class="op">=</span> pd.read_csv(url)</span>
<span id="cb2-4"><a href=""></a>df_csv.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="108">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe caption-top" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header" style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">停車場型態</th>
<th data-quarto-table-cell-role="th">停車場代碼</th>
<th data-quarto-table-cell-role="th">停車場名稱</th>
<th data-quarto-table-cell-role="th">停車場地址</th>
<th data-quarto-table-cell-role="th">停車場電話</th>
<th data-quarto-table-cell-role="th">即時車位</th>
<th data-quarto-table-cell-role="th">一般大型車</th>
<th data-quarto-table-cell-role="th">一般小型車</th>
<th data-quarto-table-cell-role="th">身障者小型車</th>
<th data-quarto-table-cell-role="th">婦幼者小型車</th>
<th data-quarto-table-cell-role="th">綠能小型車</th>
<th data-quarto-table-cell-role="th">一般機車</th>
<th data-quarto-table-cell-role="th">身障者機車</th>
<th data-quarto-table-cell-role="th">小型車充電樁</th>
<th data-quarto-table-cell-role="th">收費時間</th>
<th data-quarto-table-cell-role="th">收費費率</th>
<th data-quarto-table-cell-role="th">經緯度</th>
<th data-quarto-table-cell-role="th">備註欄</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>公有免費停車場</td>
<td>044</td>
<td>佳里停1公有停車場</td>
<td>臺南市佳里區安西路與文化路交叉口</td>
<td>2138172</td>
<td>-1</td>
<td>0</td>
<td>11</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>23.16238，120.1714</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>公有免費停車場</td>
<td>045</td>
<td>佳里停2公有停車場</td>
<td>臺南市佳里區文化路與公園路交叉口</td>
<td>2138172</td>
<td>-1</td>
<td>0</td>
<td>8</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>23.16293，120.17216</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>公有免費停車場</td>
<td>100</td>
<td>停2立體停車場</td>
<td>臺南市新市區環東路1段與南科二路</td>
<td>NaN</td>
<td>-1</td>
<td>0</td>
<td>417</td>
<td>6</td>
<td>0</td>
<td>0</td>
<td>70</td>
<td>2</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>23.096305，120.284649</td>
<td>南科管理局</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>公有免費停車場</td>
<td>101</td>
<td>管理局地下停車場</td>
<td>臺南市新市區環東路1段與南科三路</td>
<td>NaN</td>
<td>-1</td>
<td>0</td>
<td>402</td>
<td>14</td>
<td>0</td>
<td>0</td>
<td>467</td>
<td>6</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>23.101229，120.282238</td>
<td>南科管理局</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>公有免費停車場</td>
<td>102</td>
<td>管理局戶外平面停車場</td>
<td>臺南市新市區環東路1段</td>
<td>NaN</td>
<td>-1</td>
<td>0</td>
<td>227</td>
<td>2</td>
<td>0</td>
<td>0</td>
<td>46</td>
<td>0</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>23.102632，120.283831</td>
<td>南科管理局</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="csv-逗號分隔格式檔案-1" class="slide level2">
<h2>.csv 逗號分隔格式檔案</h2>
<div id="ba6cb6be" class="cell" data-execution_count="3">
<div class="cell-output cell-output-display" data-execution_count="109">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe caption-top" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header" style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">停車場型態</th>
<th data-quarto-table-cell-role="th">停車場代碼</th>
<th data-quarto-table-cell-role="th">停車場名稱</th>
<th data-quarto-table-cell-role="th">停車場地址</th>
<th data-quarto-table-cell-role="th">停車場電話</th>
<th data-quarto-table-cell-role="th">即時車位</th>
<th data-quarto-table-cell-role="th">一般大型車</th>
<th data-quarto-table-cell-role="th">一般小型車</th>
<th data-quarto-table-cell-role="th">身障者小型車</th>
<th data-quarto-table-cell-role="th">婦幼者小型車</th>
<th data-quarto-table-cell-role="th">綠能小型車</th>
<th data-quarto-table-cell-role="th">一般機車</th>
<th data-quarto-table-cell-role="th">身障者機車</th>
<th data-quarto-table-cell-role="th">小型車充電樁</th>
<th data-quarto-table-cell-role="th">收費時間</th>
<th data-quarto-table-cell-role="th">收費費率</th>
<th data-quarto-table-cell-role="th">經緯度</th>
<th data-quarto-table-cell-role="th">備註欄</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>公有免費停車場</td>
<td>044</td>
<td>佳里停1公有停車場</td>
<td>臺南市佳里區安西路與文化路交叉口</td>
<td>2138172</td>
<td>-1</td>
<td>0</td>
<td>11</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>23.16238，120.1714</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>公有免費停車場</td>
<td>045</td>
<td>佳里停2公有停車場</td>
<td>臺南市佳里區文化路與公園路交叉口</td>
<td>2138172</td>
<td>-1</td>
<td>0</td>
<td>8</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>23.16293，120.17216</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>公有免費停車場</td>
<td>100</td>
<td>停2立體停車場</td>
<td>臺南市新市區環東路1段與南科二路</td>
<td>NaN</td>
<td>-1</td>
<td>0</td>
<td>417</td>
<td>6</td>
<td>0</td>
<td>0</td>
<td>70</td>
<td>2</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>23.096305，120.284649</td>
<td>南科管理局</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>公有免費停車場</td>
<td>101</td>
<td>管理局地下停車場</td>
<td>臺南市新市區環東路1段與南科三路</td>
<td>NaN</td>
<td>-1</td>
<td>0</td>
<td>402</td>
<td>14</td>
<td>0</td>
<td>0</td>
<td>467</td>
<td>6</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>23.101229，120.282238</td>
<td>南科管理局</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>公有免費停車場</td>
<td>102</td>
<td>管理局戶外平面停車場</td>
<td>臺南市新市區環東路1段</td>
<td>NaN</td>
<td>-1</td>
<td>0</td>
<td>227</td>
<td>2</td>
<td>0</td>
<td>0</td>
<td>46</td>
<td>0</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>23.102632，120.283831</td>
<td>南科管理局</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="hands-on---.csv檔案匯入" class="slide level2">
<h2>Hands-on - .csv檔案匯入</h2>
<ul>
<li>以<a href="https://data.gov.tw/dataset/18420">上市公司每月營業收入彙總表</a>為例</li>
<li>複製<code>csv</code>資料下載網址</li>
<li>用<code>pandas</code> 的 <code>read_csv()</code>函數將檔案匯入</li>
<li>匯入後印出前5個row</li>
</ul>

<img data-src="figures/downloadcsv.png" class="r-stretch"></section>
<section id="xls-excel格式檔案" class="slide level2">
<h2>.xls Excel格式檔案</h2>
<ul>
<li>需要安裝<code>openpyxl</code>和<code>xlrd</code>套件</li>
</ul>
<div id="7df06197" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href=""></a><span class="op">!</span>pip3 install openpyxl xlrd</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="xls-excel格式檔案-1" class="slide level2">
<h2>.xls Excel格式檔案</h2>
<ul>
<li>使用<code>pandas</code>的<code>read_excel(路徑)</code></li>
<li>路徑可以是<em>本機端路徑</em>，也可以是<em>網址</em></li>
<li>可設定<code>sheet_name</code>參數指定<em>工作表名稱</em></li>
</ul>
<div id="3f25f167" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href=""></a>url <span class="op">=</span> <span class="st">'https://github.com/CGUIM-BigDataAnalysis/BigDataCGUIM/raw/master/EMBA_BigData/Data/</span><span class="sc">%E</span><span class="st">6</span><span class="sc">%96%</span><span class="st">B0</span><span class="sc">%E</span><span class="st">7%AB%B9</span><span class="sc">%E</span><span class="st">4%B8%8D</span><span class="sc">%E</span><span class="st">5%8B</span><span class="sc">%95%</span><span class="st">E7</span><span class="sc">%94%</span><span class="st">A2.xls'</span></span>
<span id="cb4-2"><a href=""></a>house <span class="op">=</span> pd.read_excel(url,sheet_name <span class="op">=</span> <span class="st">"不動產買賣"</span>)  </span>
<span id="cb4-3"><a href=""></a>house.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="110">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe caption-top" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header" style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">鄉鎮市區</th>
<th data-quarto-table-cell-role="th">交易標的</th>
<th data-quarto-table-cell-role="th">土地位置建物門牌</th>
<th data-quarto-table-cell-role="th">土地移轉總面積平方公尺</th>
<th data-quarto-table-cell-role="th">都市土地使用分區</th>
<th data-quarto-table-cell-role="th">非都市土地使用分區</th>
<th data-quarto-table-cell-role="th">非都市土地使用編定</th>
<th data-quarto-table-cell-role="th">交易年月日</th>
<th data-quarto-table-cell-role="th">交易筆棟數</th>
<th data-quarto-table-cell-role="th">移轉層次</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">總價元</th>
<th data-quarto-table-cell-role="th">單價元平方公尺</th>
<th data-quarto-table-cell-role="th">車位類別</th>
<th data-quarto-table-cell-role="th">車位移轉總面積平方公尺</th>
<th data-quarto-table-cell-role="th">車位總價元</th>
<th data-quarto-table-cell-role="th">備註</th>
<th data-quarto-table-cell-role="th">主建物面積</th>
<th data-quarto-table-cell-role="th">附屬建物面積</th>
<th data-quarto-table-cell-role="th">陽台面積</th>
<th data-quarto-table-cell-role="th">電梯</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>新竹市</td>
<td>土地</td>
<td>明湖段840地號</td>
<td>18.74</td>
<td>NaN</td>
<td>山坡地保育區</td>
<td>農牧用地</td>
<td>1121101</td>
<td>土地1建物0車位0</td>
<td>NaN</td>
<td>...</td>
<td>150000</td>
<td>8004.0</td>
<td>NaN</td>
<td>0.0</td>
<td>0</td>
<td>NaN</td>
<td>0.00</td>
<td>0.0</td>
<td>0.00</td>
<td>無</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>新竹市</td>
<td>土地</td>
<td>新莊段198地號</td>
<td>42.95</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>1121101</td>
<td>土地12建物0車位0</td>
<td>NaN</td>
<td>...</td>
<td>4576000</td>
<td>106542.0</td>
<td>NaN</td>
<td>0.0</td>
<td>0</td>
<td>親友、員工、共有人或其他特殊關係間之交易；</td>
<td>0.00</td>
<td>0.0</td>
<td>0.00</td>
<td>無</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>新竹市</td>
<td>房地(土地+建物)</td>
<td>新竹市新竹市光華街９５巷３號５樓之３</td>
<td>6.72</td>
<td>住</td>
<td>NaN</td>
<td>NaN</td>
<td>1121101</td>
<td>土地1建物1車位0</td>
<td>五層</td>
<td>...</td>
<td>3630000</td>
<td>81665.0</td>
<td>NaN</td>
<td>0.0</td>
<td>0</td>
<td>NaN</td>
<td>31.62</td>
<td>0.0</td>
<td>3.74</td>
<td>有</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>新竹市</td>
<td>土地</td>
<td>南門段四小段177-25地號</td>
<td>29.67</td>
<td>都市：其他:道路用地</td>
<td>NaN</td>
<td>NaN</td>
<td>1121103</td>
<td>土地1建物0車位0</td>
<td>NaN</td>
<td>...</td>
<td>1316221</td>
<td>44362.0</td>
<td>NaN</td>
<td>0.0</td>
<td>0</td>
<td>包含公共設施保留地用地；</td>
<td>0.00</td>
<td>0.0</td>
<td>0.00</td>
<td>無</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>新竹市</td>
<td>土地</td>
<td>東山段一小段189-11地號</td>
<td>357.38</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>1121107</td>
<td>土地1建物0車位0</td>
<td>NaN</td>
<td>...</td>
<td>5038989</td>
<td>14100.0</td>
<td>NaN</td>
<td>0.0</td>
<td>0</td>
<td>協議價購；</td>
<td>0.00</td>
<td>0.0</td>
<td>0.00</td>
<td>無</td>
</tr>
</tbody>
</table>

<p>5 rows × 31 columns</p>
</div>
</div>
</div>
</section>
<section id="xls-excel格式檔案-2" class="slide level2">
<h2>.xls Excel格式檔案</h2>
<div id="0dd8ec52" class="cell" data-execution_count="6">
<div class="cell-output cell-output-stdout">
<pre><code>  鄉鎮市區       交易標的            土地位置建物門牌  土地移轉總面積平方公尺    都市土地使用分區 非都市土地使用分區  \
0  新竹市         土地            明湖段840地號        18.74         NaN    山坡地保育區   
1  新竹市         土地            新莊段198地號        42.95         NaN       NaN   
2  新竹市  房地(土地+建物)  新竹市新竹市光華街９５巷３號５樓之３         6.72           住       NaN   
3  新竹市         土地      南門段四小段177-25地號        29.67  都市：其他:道路用地       NaN   
4  新竹市         土地      東山段一小段189-11地號       357.38         NaN       NaN   

  非都市土地使用編定    交易年月日       交易筆棟數 移轉層次  ...      總價元   單價元平方公尺 車位類別  \
0      農牧用地  1121101   土地1建物0車位0  NaN  ...   150000    8004.0  NaN   
1       NaN  1121101  土地12建物0車位0  NaN  ...  4576000  106542.0  NaN   
2       NaN  1121101   土地1建物1車位0   五層  ...  3630000   81665.0  NaN   
3       NaN  1121103   土地1建物0車位0  NaN  ...  1316221   44362.0  NaN   
4       NaN  1121107   土地1建物0車位0  NaN  ...  5038989   14100.0  NaN   

  車位移轉總面積平方公尺  車位總價元                     備註  主建物面積  附屬建物面積  陽台面積 電梯  
0         0.0      0                    NaN   0.00     0.0  0.00  無  
1         0.0      0  親友、員工、共有人或其他特殊關係間之交易；   0.00     0.0  0.00  無  
2         0.0      0                    NaN  31.62     0.0  3.74  有  
3         0.0      0           包含公共設施保留地用地；   0.00     0.0  0.00  無  
4         0.0      0                  協議價購；   0.00     0.0  0.00  無  

[5 rows x 31 columns]</code></pre>
</div>
</div>
</section>
<section id="hands-on---.xls-excel格式檔案" class="slide level2">
<h2>Hands-on - .xls Excel格式檔案</h2>
<ul>
<li>以<a href="https://data.gov.tw/dataset/145466">水位雨量站</a>為例</li>
<li>複製<code>Excel</code>資料下載網址</li>
<li>用pandas 的 <code>read_excel()</code>函數將檔案匯入，記得設定工作表名稱</li>
<li>匯入後印出第三個row</li>
</ul>
</section>
<section id="pkl-pickle格式檔案" class="slide level2">
<h2>.pkl pickle格式檔案</h2>
<ul>
<li>python專用，可儲存 python 的工作階段與變數</li>
<li>常用functions
<ul>
<li><code>dumps</code>, <code>dump</code>:儲存</li>
<li><code>loads</code>, <code>load</code>:讀取</li>
</ul></li>
<li>確保使用信任來源的pickle檔案以避免安全風險</li>
<li><code>with ... as ...:</code>可自動在執行完區塊程式後將檔案關閉</li>
</ul>
<div id="6c40ebbe" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href=""></a><span class="im">import</span> pickle</span>
<span id="cb6-2"><a href=""></a><span class="cf">with</span> <span class="bu">open</span>(<span class="st">"cash_rate.pkl"</span>, <span class="st">'rb'</span>) <span class="im">as</span> f: </span>
<span id="cb6-3"><a href=""></a>    cash <span class="op">=</span> pickle.load(f) </span>
<span id="cb6-4"><a href=""></a>    </span>
<span id="cb6-5"><a href=""></a><span class="bu">print</span>(<span class="bu">type</span>(cash))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'list'&gt;</code></pre>
</div>
</div>
</section>
<section id="純文字資料" class="slide level2">
<h2>純文字資料</h2>
<ul>
<li>使用<code>oepn(檔名)</code>開啟檔案
<ul>
<li>以sequence形式儲存</li>
</ul></li>
<li>使用<code>檔案物件.read()</code>讀取內容。<strong>一次取全部</strong></li>
<li>讀取完畢後，使用<code>檔案物件.close()</code>關閉檔案</li>
</ul>
<div id="c17a55ed" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href=""></a>f <span class="op">=</span> <span class="bu">open</span>(<span class="st">"output_write.txt"</span>)</span>
<span id="cb8-2"><a href=""></a><span class="bu">print</span>(f.read())</span>
<span id="cb8-3"><a href=""></a>f.close()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Hello World123456789Hello World
123
456
789
</code></pre>
</div>
</div>
</section>
<section id="純文字資料-1" class="slide level2">
<h2>純文字資料</h2>
<ul>
<li>使用<code>oepn(檔名)</code>開啟檔案</li>
<li>使用<code>檔案物件.readlines()</code>讀取內容。<strong>一次取全部，分行存成list</strong></li>
<li>讀取完畢後，使用<code>檔案物件.close()</code>關閉檔案</li>
</ul>
<div id="71823ea4" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href=""></a>f <span class="op">=</span> <span class="bu">open</span>(<span class="st">"output_write.txt"</span>)</span>
<span id="cb10-2"><a href=""></a><span class="bu">print</span>(f.readlines())</span>
<span id="cb10-3"><a href=""></a>f.close()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>['Hello World123456789Hello World\n', '123\n', '456\n', '789\n']</code></pre>
</div>
</div>
</section>
<section id="純文字資料-2" class="slide level2">
<h2>純文字資料</h2>
<ul>
<li>使用<code>oepn(檔名)</code>開啟檔案</li>
<li>使用<code>檔案物件.readline()</code>讀取內容。<strong>逐行讀</strong></li>
<li>讀取完畢後，使用<code>檔案物件.close()</code>關閉檔案</li>
</ul>
<div id="3b78df7a" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href=""></a>f <span class="op">=</span> <span class="bu">open</span>(<span class="st">"output_write.txt"</span>)</span>
<span id="cb12-2"><a href=""></a><span class="bu">print</span>(f.readline())</span>
<span id="cb12-3"><a href=""></a><span class="bu">print</span>(f.readline())</span>
<span id="cb12-4"><a href=""></a>f.close()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Hello World123456789Hello World

123
</code></pre>
</div>
</div>
</section>
<section id="dist-for-open" class="slide level2">
<h2>dist + for + open</h2>
<div id="1e26f6b0" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href=""></a>name <span class="op">=</span> <span class="st">'trump.txt'</span></span>
<span id="cb14-2"><a href=""></a>handle <span class="op">=</span> <span class="bu">open</span>(name)</span>
<span id="cb14-3"><a href=""></a></span>
<span id="cb14-4"><a href=""></a>counts <span class="op">=</span> <span class="bu">dict</span>()</span>
<span id="cb14-5"><a href=""></a><span class="cf">for</span> line <span class="kw">in</span> handle:</span>
<span id="cb14-6"><a href=""></a>    words <span class="op">=</span> line.split()</span>
<span id="cb14-7"><a href=""></a>    <span class="cf">for</span> word <span class="kw">in</span> words:</span>
<span id="cb14-8"><a href=""></a>        counts[word] <span class="op">=</span> counts.get(word,<span class="dv">0</span>) <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb14-9"><a href=""></a></span>
<span id="cb14-10"><a href=""></a>bigcount <span class="op">=</span> <span class="va">None</span></span>
<span id="cb14-11"><a href=""></a>bigword <span class="op">=</span> <span class="va">None</span></span>
<span id="cb14-12"><a href=""></a><span class="cf">for</span> word,count <span class="kw">in</span> counts.items():</span>
<span id="cb14-13"><a href=""></a>    <span class="cf">if</span> bigcount <span class="kw">is</span> <span class="va">None</span> <span class="kw">or</span> count <span class="op">&gt;</span> bigcount:</span>
<span id="cb14-14"><a href=""></a>        bigword <span class="op">=</span> word</span>
<span id="cb14-15"><a href=""></a>        bigcount <span class="op">=</span> count</span>
<span id="cb14-16"><a href=""></a></span>
<span id="cb14-17"><a href=""></a><span class="bu">print</span>(bigword, bigcount)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>the 31</code></pre>
</div>
</div>
</section>
<section id="其他格式" class="slide level2">
<h2>其他格式</h2>
<ul>
<li>以圖片為例，需安裝並載入繪圖用套件<code>matplotlib</code></li>
<li>使用<code>plt.imread(路徑)</code>載入圖片，為RGB向量</li>
</ul>
<div id="4f07acf4" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href=""></a><span class="op">!</span>pip3 install matplotlib</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="af9053c0" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href=""></a><span class="im">import</span> matplotlib</span>
<span id="cb17-2"><a href=""></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb17-3"><a href=""></a>im <span class="op">=</span> plt.imread(<span class="st">'figures/nycu_logo.png'</span>) </span>
<span id="cb17-4"><a href=""></a><span class="bu">print</span>(im)</span>
<span id="cb17-5"><a href=""></a>plt.imshow(im, <span class="st">'gray'</span>)</span>
<span id="cb17-6"><a href=""></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[[1. 1. 1. 0.]
  [1. 1. 1. 0.]
  [1. 1. 1. 0.]
  ...
  [1. 1. 1. 0.]
  [1. 1. 1. 0.]
  [1. 1. 1. 0.]]

 [[1. 1. 1. 0.]
  [1. 1. 1. 0.]
  [1. 1. 1. 0.]
  ...
  [1. 1. 1. 0.]
  [1. 1. 1. 0.]
  [1. 1. 1. 0.]]

 [[1. 1. 1. 0.]
  [1. 1. 1. 0.]
  [1. 1. 1. 0.]
  ...
  [1. 1. 1. 0.]
  [1. 1. 1. 0.]
  [1. 1. 1. 0.]]

 ...

 [[1. 1. 1. 0.]
  [1. 1. 1. 0.]
  [1. 1. 1. 0.]
  ...
  [1. 1. 1. 0.]
  [1. 1. 1. 0.]
  [1. 1. 1. 0.]]

 [[1. 1. 1. 0.]
  [1. 1. 1. 0.]
  [1. 1. 1. 0.]
  ...
  [1. 1. 1. 0.]
  [1. 1. 1. 0.]
  [1. 1. 1. 0.]]

 [[1. 1. 1. 0.]
  [1. 1. 1. 0.]
  [1. 1. 1. 0.]
  ...
  [1. 1. 1. 0.]
  [1. 1. 1. 0.]
  [1. 1. 1. 0.]]]</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src="4_DataIO_files/figure-revealjs/cell-14-output-2.png" width="423" height="416"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="其他格式-1" class="slide level2">
<h2>其他格式</h2>
<ul>
<li>使用<code>plt.imshow(向量)</code>呈現圖片</li>
<li><code>plt.show()</code>在視窗中呈現圖片內容</li>
</ul>
<div id="137cb9a8" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href=""></a>plt.imshow(im, <span class="st">'gray'</span>)</span>
<span id="cb19-2"><a href=""></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src="4_DataIO_files/figure-revealjs/cell-15-output-1.png" width="423" height="416"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="data-input-and-output-2" class="slide level2">
<h2>Data input and output</h2>
<ul>
<li><strong>Data input</strong>
<ul>
<li>From file</li>
<li><strong>From google drive</strong></li>
<li>From API</li>
<li>From database</li>
<li>Webscrapping</li>
</ul></li>
<li>Data output</li>
</ul>
</section></section>
<section>
<section id="從google-drive匯入" class="title-slide slide level1 center">
<h1>從Google drive匯入</h1>

</section>
<section id="從google-drive匯入---google-試算表" class="slide level2">
<h2>從Google drive匯入 - google 試算表</h2>
<ul>
<li><code>pandas</code>套件</li>
<li>注意原始連結後方，須為文件ID
<ul>
<li>若有<code>/edit#gid=0</code>或<code>/edit?usp=sharing</code>字樣，請刪除</li>
</ul></li>
<li>需要加工連結，在原始連結最後加上<code>/export?format=csv</code></li>
<li>如果不是公開資料表，需要授權
<ul>
<li>參考<code>google-api-python-client</code>套件</li>
</ul></li>
</ul>
<div id="0958d0cc" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href=""></a>link<span class="op">=</span><span class="st">"https://docs.google.com/spreadsheets/d/1WqkYGfZZinxqhyqnbHIDC4NrHXbApfm8m8EvFR4SPAU"</span></span>
<span id="cb20-2"><a href=""></a>csv_link<span class="op">=</span><span class="st">"/export?format=csv"</span></span>
<span id="cb20-3"><a href=""></a>pd.read_csv(link<span class="op">+</span>csv_link)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="119">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe caption-top" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header" style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">交易日期</th>
<th data-quarto-table-cell-role="th">開盤</th>
<th data-quarto-table-cell-role="th">最高</th>
<th data-quarto-table-cell-role="th">最低</th>
<th data-quarto-table-cell-role="th">收盤</th>
<th data-quarto-table-cell-role="th">漲跌</th>
<th data-quarto-table-cell-role="th">漲跌(%)</th>
<th data-quarto-table-cell-role="th">振幅(%)</th>
<th data-quarto-table-cell-role="th">張數</th>
<th data-quarto-table-cell-role="th">筆數</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">外資</th>
<th data-quarto-table-cell-role="th">投信</th>
<th data-quarto-table-cell-role="th">自營</th>
<th data-quarto-table-cell-role="th">合計</th>
<th data-quarto-table-cell-role="th">外資持股(%)</th>
<th data-quarto-table-cell-role="th">融資增減</th>
<th data-quarto-table-cell-role="th">融資餘額</th>
<th data-quarto-table-cell-role="th">融券增減</th>
<th data-quarto-table-cell-role="th">融券餘額</th>
<th data-quarto-table-cell-role="th">券資比(%)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>25/02/14</td>
<td>1065</td>
<td>1070</td>
<td>1060</td>
<td>1060</td>
<td>-30</td>
<td>-2.75</td>
<td>0.92</td>
<td>73,417</td>
<td>218,986</td>
<td>...</td>
<td>-20,971</td>
<td>-91.4</td>
<td>+34.5</td>
<td>-21,028</td>
<td>73.4</td>
<td>+1,090</td>
<td>23,081</td>
<td>-100</td>
<td>111</td>
<td>0.48</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>25/02/13</td>
<td>1090</td>
<td>1095</td>
<td>1080</td>
<td>1090</td>
<td>-10</td>
<td>-0.91</td>
<td>1.36</td>
<td>35,682</td>
<td>72,456</td>
<td>...</td>
<td>-10,885</td>
<td>+454</td>
<td>+1,117</td>
<td>-9,313</td>
<td>73.5</td>
<td>+262</td>
<td>21,991</td>
<td>-56</td>
<td>211</td>
<td>0.96</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>25/02/12</td>
<td>1110</td>
<td>1115</td>
<td>1100</td>
<td>1100</td>
<td>-10</td>
<td>-0.90</td>
<td>1.35</td>
<td>26,190</td>
<td>38,511</td>
<td>...</td>
<td>+213</td>
<td>-19</td>
<td>-347</td>
<td>-153</td>
<td>73.6</td>
<td>+129</td>
<td>21,729</td>
<td>-4</td>
<td>267</td>
<td>1.23</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>25/02/11</td>
<td>1110</td>
<td>1115</td>
<td>1100</td>
<td>1110</td>
<td>5</td>
<td>0.45</td>
<td>1.36</td>
<td>21,023</td>
<td>31,837</td>
<td>...</td>
<td>+1,229</td>
<td>-353</td>
<td>-292</td>
<td>+584</td>
<td>73.6</td>
<td>-38</td>
<td>21,600</td>
<td>10</td>
<td>271</td>
<td>1.25</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>25/02/10</td>
<td>1125</td>
<td>1125</td>
<td>1095</td>
<td>1105</td>
<td>-20</td>
<td>-1.78</td>
<td>2.67</td>
<td>31,037</td>
<td>60,839</td>
<td>...</td>
<td>-2,271</td>
<td>-132</td>
<td>-479</td>
<td>-2,882</td>
<td>73.6</td>
<td>+532</td>
<td>21,638</td>
<td>-24</td>
<td>261</td>
<td>1.21</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">235</td>
<td>24/02/23</td>
<td>701</td>
<td>703</td>
<td>696</td>
<td>697</td>
<td>5</td>
<td>0.72</td>
<td>1.01</td>
<td>48,404</td>
<td>48,018</td>
<td>...</td>
<td>+20,881</td>
<td>-366</td>
<td>-570</td>
<td>+19,946</td>
<td>74.2</td>
<td>-1,807</td>
<td>13,053</td>
<td>9</td>
<td>392</td>
<td>3.00</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">236</td>
<td>24/02/22</td>
<td>695</td>
<td>695</td>
<td>685</td>
<td>692</td>
<td>11</td>
<td>1.62</td>
<td>1.47</td>
<td>34,269</td>
<td>36,998</td>
<td>...</td>
<td>+7,728</td>
<td>+37.7</td>
<td>+2,125</td>
<td>+9,890</td>
<td>74.1</td>
<td>+899</td>
<td>14,860</td>
<td>19</td>
<td>383</td>
<td>2.58</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">237</td>
<td>24/02/21</td>
<td>678</td>
<td>683</td>
<td>678</td>
<td>681</td>
<td>-6</td>
<td>-0.87</td>
<td>0.73</td>
<td>31,981</td>
<td>36,004</td>
<td>...</td>
<td>-5,942</td>
<td>+39.3</td>
<td>+1,514</td>
<td>-4,389</td>
<td>74.0</td>
<td>-145</td>
<td>13,961</td>
<td>-26</td>
<td>364</td>
<td>2.61</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">238</td>
<td>24/02/20</td>
<td>675</td>
<td>688</td>
<td>675</td>
<td>687</td>
<td>9</td>
<td>1.33</td>
<td>1.92</td>
<td>31,404</td>
<td>32,847</td>
<td>...</td>
<td>+2,641</td>
<td>-12.4</td>
<td>-1,188</td>
<td>+1,441</td>
<td>74.1</td>
<td>-249</td>
<td>14,106</td>
<td>23</td>
<td>390</td>
<td>2.76</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">239</td>
<td>24/02/19</td>
<td>674</td>
<td>682</td>
<td>674</td>
<td>678</td>
<td>-5</td>
<td>-0.73</td>
<td>1.17</td>
<td>36,367</td>
<td>35,240</td>
<td>...</td>
<td>-10,732</td>
<td>+81.6</td>
<td>+1,855</td>
<td>-8,795</td>
<td>74.0</td>
<td>+616</td>
<td>14,355</td>
<td>-5</td>
<td>367</td>
<td>2.56</td>
</tr>
</tbody>
</table>

<p>240 rows × 22 columns</p>
</div>
</div>
</div>
</section>
<section id="從google-drive匯入---google-試算表-1" class="slide level2">
<h2>從Google drive匯入 - google 試算表</h2>
<div id="1b24b415" class="cell" data-execution_count="16">
<div class="cell-output cell-output-display" data-execution_count="120">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe caption-top" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header" style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">交易日期</th>
<th data-quarto-table-cell-role="th">開盤</th>
<th data-quarto-table-cell-role="th">最高</th>
<th data-quarto-table-cell-role="th">最低</th>
<th data-quarto-table-cell-role="th">收盤</th>
<th data-quarto-table-cell-role="th">漲跌</th>
<th data-quarto-table-cell-role="th">漲跌(%)</th>
<th data-quarto-table-cell-role="th">振幅(%)</th>
<th data-quarto-table-cell-role="th">張數</th>
<th data-quarto-table-cell-role="th">筆數</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">外資</th>
<th data-quarto-table-cell-role="th">投信</th>
<th data-quarto-table-cell-role="th">自營</th>
<th data-quarto-table-cell-role="th">合計</th>
<th data-quarto-table-cell-role="th">外資持股(%)</th>
<th data-quarto-table-cell-role="th">融資增減</th>
<th data-quarto-table-cell-role="th">融資餘額</th>
<th data-quarto-table-cell-role="th">融券增減</th>
<th data-quarto-table-cell-role="th">融券餘額</th>
<th data-quarto-table-cell-role="th">券資比(%)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>25/02/14</td>
<td>1065</td>
<td>1070</td>
<td>1060</td>
<td>1060</td>
<td>-30</td>
<td>-2.75</td>
<td>0.92</td>
<td>73,417</td>
<td>218,986</td>
<td>...</td>
<td>-20,971</td>
<td>-91.4</td>
<td>+34.5</td>
<td>-21,028</td>
<td>73.4</td>
<td>+1,090</td>
<td>23,081</td>
<td>-100</td>
<td>111</td>
<td>0.48</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>25/02/13</td>
<td>1090</td>
<td>1095</td>
<td>1080</td>
<td>1090</td>
<td>-10</td>
<td>-0.91</td>
<td>1.36</td>
<td>35,682</td>
<td>72,456</td>
<td>...</td>
<td>-10,885</td>
<td>+454</td>
<td>+1,117</td>
<td>-9,313</td>
<td>73.5</td>
<td>+262</td>
<td>21,991</td>
<td>-56</td>
<td>211</td>
<td>0.96</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>25/02/12</td>
<td>1110</td>
<td>1115</td>
<td>1100</td>
<td>1100</td>
<td>-10</td>
<td>-0.90</td>
<td>1.35</td>
<td>26,190</td>
<td>38,511</td>
<td>...</td>
<td>+213</td>
<td>-19</td>
<td>-347</td>
<td>-153</td>
<td>73.6</td>
<td>+129</td>
<td>21,729</td>
<td>-4</td>
<td>267</td>
<td>1.23</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>25/02/11</td>
<td>1110</td>
<td>1115</td>
<td>1100</td>
<td>1110</td>
<td>5</td>
<td>0.45</td>
<td>1.36</td>
<td>21,023</td>
<td>31,837</td>
<td>...</td>
<td>+1,229</td>
<td>-353</td>
<td>-292</td>
<td>+584</td>
<td>73.6</td>
<td>-38</td>
<td>21,600</td>
<td>10</td>
<td>271</td>
<td>1.25</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>25/02/10</td>
<td>1125</td>
<td>1125</td>
<td>1095</td>
<td>1105</td>
<td>-20</td>
<td>-1.78</td>
<td>2.67</td>
<td>31,037</td>
<td>60,839</td>
<td>...</td>
<td>-2,271</td>
<td>-132</td>
<td>-479</td>
<td>-2,882</td>
<td>73.6</td>
<td>+532</td>
<td>21,638</td>
<td>-24</td>
<td>261</td>
<td>1.21</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">235</td>
<td>24/02/23</td>
<td>701</td>
<td>703</td>
<td>696</td>
<td>697</td>
<td>5</td>
<td>0.72</td>
<td>1.01</td>
<td>48,404</td>
<td>48,018</td>
<td>...</td>
<td>+20,881</td>
<td>-366</td>
<td>-570</td>
<td>+19,946</td>
<td>74.2</td>
<td>-1,807</td>
<td>13,053</td>
<td>9</td>
<td>392</td>
<td>3.00</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">236</td>
<td>24/02/22</td>
<td>695</td>
<td>695</td>
<td>685</td>
<td>692</td>
<td>11</td>
<td>1.62</td>
<td>1.47</td>
<td>34,269</td>
<td>36,998</td>
<td>...</td>
<td>+7,728</td>
<td>+37.7</td>
<td>+2,125</td>
<td>+9,890</td>
<td>74.1</td>
<td>+899</td>
<td>14,860</td>
<td>19</td>
<td>383</td>
<td>2.58</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">237</td>
<td>24/02/21</td>
<td>678</td>
<td>683</td>
<td>678</td>
<td>681</td>
<td>-6</td>
<td>-0.87</td>
<td>0.73</td>
<td>31,981</td>
<td>36,004</td>
<td>...</td>
<td>-5,942</td>
<td>+39.3</td>
<td>+1,514</td>
<td>-4,389</td>
<td>74.0</td>
<td>-145</td>
<td>13,961</td>
<td>-26</td>
<td>364</td>
<td>2.61</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">238</td>
<td>24/02/20</td>
<td>675</td>
<td>688</td>
<td>675</td>
<td>687</td>
<td>9</td>
<td>1.33</td>
<td>1.92</td>
<td>31,404</td>
<td>32,847</td>
<td>...</td>
<td>+2,641</td>
<td>-12.4</td>
<td>-1,188</td>
<td>+1,441</td>
<td>74.1</td>
<td>-249</td>
<td>14,106</td>
<td>23</td>
<td>390</td>
<td>2.76</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">239</td>
<td>24/02/19</td>
<td>674</td>
<td>682</td>
<td>674</td>
<td>678</td>
<td>-5</td>
<td>-0.73</td>
<td>1.17</td>
<td>36,367</td>
<td>35,240</td>
<td>...</td>
<td>-10,732</td>
<td>+81.6</td>
<td>+1,855</td>
<td>-8,795</td>
<td>74.0</td>
<td>+616</td>
<td>14,355</td>
<td>-5</td>
<td>367</td>
<td>2.56</td>
</tr>
</tbody>
</table>

<p>240 rows × 22 columns</p>
</div>
</div>
</div>
</section>
<section id="從google-drive匯入---google-試算表-2" class="slide level2">
<h2>從Google drive匯入 - google 試算表</h2>
<div id="8b1b52a6" class="cell" data-execution_count="17">
<div class="cell-output cell-output-stdout">
<pre><code>         交易日期    開盤    最高    最低    收盤  漲跌  漲跌(%)  振幅(%)      張數       筆數  ...  \
0    25/02/14  1065  1070  1060  1060 -30  -2.75   0.92  73,417  218,986  ...   
1    25/02/13  1090  1095  1080  1090 -10  -0.91   1.36  35,682   72,456  ...   
2    25/02/12  1110  1115  1100  1100 -10  -0.90   1.35  26,190   38,511  ...   
3    25/02/11  1110  1115  1100  1110   5   0.45   1.36  21,023   31,837  ...   
4    25/02/10  1125  1125  1095  1105 -20  -1.78   2.67  31,037   60,839  ...   
..        ...   ...   ...   ...   ...  ..    ...    ...     ...      ...  ...   
235  24/02/23   701   703   696   697   5   0.72   1.01  48,404   48,018  ...   
236  24/02/22   695   695   685   692  11   1.62   1.47  34,269   36,998  ...   
237  24/02/21   678   683   678   681  -6  -0.87   0.73  31,981   36,004  ...   
238  24/02/20   675   688   675   687   9   1.33   1.92  31,404   32,847  ...   
239  24/02/19   674   682   674   678  -5  -0.73   1.17  36,367   35,240  ...   

          外資     投信      自營       合計 外資持股(%)    融資增減    融資餘額 融券增減 融券餘額  券資比(%)  
0    -20,971  -91.4   +34.5  -21,028    73.4  +1,090  23,081 -100  111    0.48  
1    -10,885   +454  +1,117   -9,313    73.5    +262  21,991  -56  211    0.96  
2       +213    -19    -347     -153    73.6    +129  21,729   -4  267    1.23  
3     +1,229   -353    -292     +584    73.6     -38  21,600   10  271    1.25  
4     -2,271   -132    -479   -2,882    73.6    +532  21,638  -24  261    1.21  
..       ...    ...     ...      ...     ...     ...     ...  ...  ...     ...  
235  +20,881   -366    -570  +19,946    74.2  -1,807  13,053    9  392    3.00  
236   +7,728  +37.7  +2,125   +9,890    74.1    +899  14,860   19  383    2.58  
237   -5,942  +39.3  +1,514   -4,389    74.0    -145  13,961  -26  364    2.61  
238   +2,641  -12.4  -1,188   +1,441    74.1    -249  14,106   23  390    2.76  
239  -10,732  +81.6  +1,855   -8,795    74.0    +616  14,355   -5  367    2.56  

[240 rows x 22 columns]</code></pre>
</div>
</div>
</section>
<section id="hands-on---google-試算表匯入" class="slide level2">
<h2>Hands-on - google 試算表匯入</h2>
<ul>
<li>以<a href="https://docs.google.com/spreadsheets/d/1wmcc6e8n9bvIQgps6MgFLyLCcq6DWx-3uP2uLIA9rnU">Example Spreadsheet</a>為例</li>
<li>加工連結 (<strong>hint</strong>:前兩頁投影片)</li>
<li>用pandas 的 <code>pd.read_csv()</code>函數將檔案匯入</li>
<li>匯入後印出第Home State column</li>
</ul>
</section>
<section id="從google-drive匯入---下載後匯入" class="slide level2">
<h2>從Google drive匯入 - 下載後匯入</h2>
<p>使用<code>gdown</code>指令，並輸入google drive 檔案ID</p>
<p>https://drive.google.com/uc?id=1ivP1VeeU0QTdN1pJcudEaIgKO33DMDm7</p>
<div id="3f228dce" class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href=""></a><span class="op">!</span>gdown <span class="st">'1ivP1VeeU0QTdN1pJcudEaIgKO33DMDm7'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>執行後會儲存在工作路徑中，在用相對應的方法匯入即可</p>
</section>
<section id="data-input-and-output-3" class="slide level2">
<h2>Data input and output</h2>
<ul>
<li><strong>Data input</strong>
<ul>
<li>From file</li>
<li>From google drive</li>
<li><strong>From API</strong></li>
<li>From database</li>
<li>Webscrapping</li>
</ul></li>
<li>Data output</li>
</ul>
</section></section>
<section>
<section id="from-api" class="title-slide slide level1 center">
<h1>From API</h1>

</section>
<section id="from-api-1" class="slide level2">
<h2>From API</h2>
<ul>
<li>Open Data</li>
<li>API (Application programming interfaces)</li>
<li>JSON格式檔案</li>
</ul>
</section>
<section id="open-data-開放資料" class="slide level2">
<h2>Open Data 開放資料</h2>
<ul>
<li>2011年推動開放政府與開放資料 (<a href="https://zh.wikipedia.org/wiki/%E9%96%8B%E6%94%BE%E8%B3%87%E6%96%99">維基百科</a>)</li>
<li>不受著作權、專利權，以及其他管理機制所限制，任何人都可以自由出版使用</li>
<li>常見的儲存方式為:
<ul>
<li><code>CSV</code></li>
<li><code>JSON</code></li>
<li><code>XML</code></li>
</ul></li>
</ul>
</section>
<section id="open-data-開放資料常見平台" class="slide level2">
<h2>Open Data 開放資料常見平台</h2>
<ul>
<li><a href="https://data.gov.tw/">政府資料開放平台</a></li>
<li><a href="https://data.taipei/">台北市資料大平台</a></li>
<li><a href="https://opendata.tycg.gov.tw/">桃園開放資料</a></li>
<li><a href="https://opendata.hccg.gov.tw/">新竹市政府資料開放平臺</a></li>
</ul>
</section>
<section id="api" class="slide level2">
<h2>API</h2>
<ul>
<li>應用程式介面</li>
<li><strong>A</strong>pplication <strong>P</strong>rogramming <strong>I</strong>nterfaces</li>
<li>為了讓第三方的開發者可以額外開發應用程式來強化他們的產品，推出可以與系統溝通的介面</li>
<li>有API輔助可將資料擷取過程自動化
<ul>
<li>以下載Open Data為例，若檔案更新頻繁，使用手動下載相當耗時</li>
</ul></li>
<li><a href="https://zh.wikipedia.org/zh-tw/%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F%E6%8E%A5%E5%8F%A3">維基百科</a></li>
</ul>
</section>
<section id="api---open-data" class="slide level2">
<h2>API - Open Data</h2>
<ul>
<li>[桃園公共自行車即時服務資料]https://opendata.tycg.gov.tw/datalist/5ca2bfc7-9ace-4719-88ae-4034b9a5a55c)資料</li>
<li>每日更新</li>
<li>不可能每日手動下載</li>
<li>提供透過<strong>API</strong>下載的服務</li>
<li>透過API下載的資料格式: <strong>JSON格式</strong></li>
</ul>
</section>
<section id="json-format" class="slide level2">
<h2>JSON format</h2>
<ul>
<li>JSON (<strong>J</strong>ava<strong>s</strong>cript <strong>O</strong>bject <strong>N</strong>otation)</li>
<li>輕量級的資料交換語言</li>
<li>From <strong>a</strong>pplication <strong>p</strong>rogramming <strong>i</strong>nterfaces (APIs)</li>
<li>JavaScript、Java、Node.js應用</li>
<li>一些NoSQL資料庫用JSON儲存資料：<strong>MongoDB</strong></li>
<li><a href="http://en.wikipedia.org/wiki/JSON">Wiki</a></li>
</ul>

<img data-src="figures/json.png" width="383" class="r-stretch"></section>
<section id="json檔案匯入" class="slide level2">
<h2>JSON檔案匯入</h2>
<ul>
<li>從網路載資料，需要安裝<code>requests</code>套件</li>
<li>處理json資料，需要安裝與載入<code>json</code>套件</li>
</ul>
<div id="5f7b27e5" class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href=""></a><span class="op">!</span>pip3 install json requests</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="90e25efa" class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href=""></a><span class="im">import</span> json, requests</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="json檔案匯入-1" class="slide level2">
<h2>JSON檔案匯入</h2>
<ul>
<li>API網址參考<a href="https://opendata.taichung.gov.tw/search/6e38eb56-0e9a-4b9e-806d-23cd35d44d6b">臺中市公共自行車(YouBike2.0)</a></li>
<li>點選<strong>API</strong>獲取相關資訊</li>
<li>使用<code>requests</code>套件的<code>get(網址)</code>擷取資料</li>
<li>此API會檔短時間內擷取多次的要求，因此放入<code>params = {'param':'1'}</code>以及<code>headers = {'Connection':'close'}</code>設定</li>
<li>最後將使用<code>回傳結果.json()</code>，將檔案轉成JSON格式</li>
</ul>
<div id="87058138" class="cell" data-cache="true" data-execution_count="21">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href=""></a>url<span class="op">=</span><span class="st">"https://datacenter.taichung.gov.tw/swagger/OpenData/34a848ab-eeb3-44fd-a842-a09cb3209a7d"</span></span>
<span id="cb25-2"><a href=""></a>response <span class="op">=</span> requests.get(url, params <span class="op">=</span> {<span class="st">'param'</span>:<span class="st">'1'</span>}, headers <span class="op">=</span> {<span class="st">'Connection'</span>:<span class="st">'close'</span>})</span>
<span id="cb25-3"><a href=""></a>data <span class="op">=</span> response.json()  <span class="co"># Convert the response to JSON</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="json檔案匯入-2" class="slide level2">
<h2>JSON檔案匯入</h2>
<p>探索資料，使用<code>.keys()</code>查看keys</p>
<div id="2c627e16" class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href=""></a><span class="bu">type</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="124">
<pre><code>dict</code></pre>
</div>
</div>
<div id="2127b3ac" class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href=""></a>data.keys()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="125">
<pre><code>dict_keys(['retCode', 'updated_at', 'retVal'])</code></pre>
</div>
</div>
<div id="b8334dc3" class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href=""></a><span class="bu">type</span>(data[<span class="st">"retVal"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="126">
<pre><code>list</code></pre>
</div>
</div>
</section>
<section id="json檔案匯入-3" class="slide level2">
<h2>JSON檔案匯入</h2>
<p>探索資料，發現是dist (data)中retVal key儲存含有資料的list</p>
<div id="f4f42645" class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href=""></a>data[<span class="st">"retVal"</span>][<span class="dv">0</span>:<span class="dv">2</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="127">
<pre><code>[{'scity': '台中市',
  'scityen': 'Taichung City',
  'sna': 'YouBike2.0_綠川東中山路口',
  'sarea': '中區',
  'ar': '綠川東街/中山路口(東側)',
  'snaen': 'YouBike2.0_Luchuan E. St. / Zhongshan Rd.',
  'sareaen': 'Central Dist',
  'aren': 'Luchuan E. St. &amp; Zhongshan Rd. Intersection (East)',
  'sno': '500601001',
  'tot': '16',
  'sbi': '0',
  'mday': '20250326171414',
  'lat': '24.13785',
  'lng': '120.68337',
  'bemp': '16',
  'act': 1,
  'sbi_detail': {'yb2': '0', 'eyb': '0'}},
 {'scity': '台中市',
  'scityen': 'Taichung City',
  'sna': 'YouBike2.0_繼光光復路口',
  'sarea': '中區',
  'ar': '繼光街166號(對側人行道)',
  'snaen': 'YouBike2.0_Jiguang St. / Guangfu Rd.',
  'sareaen': 'Central Dist',
  'aren': 'No.166, Jiguang St. (Opposite)',
  'sno': '500601002',
  'tot': '18',
  'sbi': '5',
  'mday': '20250326171032',
  'lat': '24.1411',
  'lng': '120.68474',
  'bemp': '13',
  'act': 1,
  'sbi_detail': {'yb2': '5', 'eyb': '0'}}]</code></pre>
</div>
</div>
</section>
<section id="json檔案匯入-4" class="slide level2">
<h2>JSON檔案匯入</h2>
<p>探索資料，發現是dist (data)中retVal key儲存含有資料的list</p>
<div id="1001d4c0" class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href=""></a>data[<span class="st">"retVal"</span>][<span class="dv">0</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="128">
<pre><code>{'scity': '台中市',
 'scityen': 'Taichung City',
 'sna': 'YouBike2.0_綠川東中山路口',
 'sarea': '中區',
 'ar': '綠川東街/中山路口(東側)',
 'snaen': 'YouBike2.0_Luchuan E. St. / Zhongshan Rd.',
 'sareaen': 'Central Dist',
 'aren': 'Luchuan E. St. &amp; Zhongshan Rd. Intersection (East)',
 'sno': '500601001',
 'tot': '16',
 'sbi': '0',
 'mday': '20250326171414',
 'lat': '24.13785',
 'lng': '120.68337',
 'bemp': '16',
 'act': 1,
 'sbi_detail': {'yb2': '0', 'eyb': '0'}}</code></pre>
</div>
</div>
</section>
<section id="hands-on---json檔案匯入練習" class="slide level2">
<h2>Hands-on - JSON檔案匯入練習</h2>
<ul>
<li>練習用資料：<a href="https://data.gov.tw/dataset/137993">YouBike2.0臺北市公共自行車即時資訊</a></li>
<li>API地址<a href="https://tcgbusfs.blob.core.windows.net/dotapp/youbike/v2/youbike_immediate.json">在此</a></li>
<li>使用檔案匯入<strong>範例</strong>，將資料匯入Python中
<ul>
<li>提示：設定url</li>
</ul></li>
<li>找到資料的儲存處，並將答案print出</li>
</ul>
</section>
<section id="from-api---recap" class="slide level2">
<h2>From API - Recap</h2>
<ul>
<li>Open Data</li>
<li>API (Application programming interfaces)</li>
<li>JSON格式檔案 <code>requests.get()</code>下載，<code>.json</code>轉型</li>
<li>用<code>type()</code>查看資料類別</li>
<li>若為dist，則可使用<code>keys()</code>查看資料擷取方法，並印出來試試看</li>
</ul>
</section>
<section id="data-input-and-output-4" class="slide level2">
<h2>Data input and output</h2>
<ul>
<li><strong>Data input</strong>
<ul>
<li>From file</li>
<li>From google drive</li>
<li>From API</li>
<li><strong>From database</strong></li>
<li>Webscrapping</li>
</ul></li>
<li>Data output</li>
</ul>
</section></section>
<section>
<section id="from-database" class="title-slide slide level1 center">
<h1>From database</h1>

</section>
<section id="from-database-1" class="slide level2">
<h2>From database</h2>
<ul>
<li>Database access
<ul>
<li>File system: SQLite</li>
<li>Database system: MySQL, MS SQL Server, …etc</li>
</ul></li>
<li>DuckDB
<ul>
<li>Using file system</li>
<li>select data with SQL and pandas!</li>
</ul></li>
</ul>
</section>
<section id="databases-access---sqlite" class="slide level2">
<h2>Databases access - SQLite</h2>
<p>File system以SQLite為例，需要先安裝<code>sqlite3</code>套件</p>
<div id="f1a57469" class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href=""></a><span class="op">!</span>pip3 install sqlite3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="databases-access---sqlite-1" class="slide level2">
<h2>Databases access - SQLite</h2>
<ul>
<li><code>dbfile</code> local path for db file or url</li>
<li><code>sqlite3.connect(dbfile)</code> connect to the db file
<ul>
<li><code>dbfile</code> can be local path or url</li>
</ul></li>
<li><code>conn.execute("SQL")</code> execute <code>SQL</code></li>
<li><code>pd.read_sql_query("SQL")</code> retrieve data with <code>SQL</code> and save as dataframe</li>
<li><code>conn.close()</code> close the connection</li>
</ul>
<div id="d3e6e53f" class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href=""></a><span class="im">import</span> sqlite3</span>
<span id="cb37-2"><a href=""></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb37-3"><a href=""></a>dbfile <span class="op">=</span> <span class="st">"chinook.db"</span></span>
<span id="cb37-4"><a href=""></a>conn <span class="op">=</span> sqlite3.<span class="ex">connect</span>(dbfile)</span>
<span id="cb37-5"><a href=""></a>df <span class="op">=</span> pd.read_sql_query(<span class="st">"select * from artists"</span>, conn)</span>
<span id="cb37-6"><a href=""></a>conn.close()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="databases-access---sqlite-2" class="slide level2">
<h2>Databases access - SQLite</h2>
<div id="9fa647ca" class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href=""></a><span class="bu">print</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     ArtistId                                               Name
0           1                                              AC/DC
1           2                                             Accept
2           3                                          Aerosmith
3           4                                  Alanis Morissette
4           5                                    Alice In Chains
..        ...                                                ...
270       271   Mela Tenenbaum, Pro Musica Prague &amp; Richard Kapp
271       272                             Emerson String Quartet
272       273  C. Monteverdi, Nigel Rogers - Chiaroscuro; Lon...
273       274                                      Nash Ensemble
274       275                              Philip Glass Ensemble

[275 rows x 2 columns]</code></pre>
</div>
</div>
</section>
<section id="databases-access---mysql-fyr" class="slide level2">
<h2>Databases access - MySQL (FYR)</h2>
<p>以MySQL為例，需要先安裝<code>mysql-connector-python</code>套件</p>
<div id="6b005faa" class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href=""></a><span class="op">!</span>pip3 install mysql<span class="op">-</span>connector<span class="op">-</span>python</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="databases-access---mysql-fyr-1" class="slide level2">
<h2>Databases access - MySQL (FYR)</h2>
<div id="8324bd2a" class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href=""></a><span class="im">import</span> mysql.connector</span>
<span id="cb41-2"><a href=""></a>mydb <span class="op">=</span> mysql.connector.<span class="ex">connect</span>(</span>
<span id="cb41-3"><a href=""></a>  host<span class="op">=</span><span class="st">"localhost"</span>,</span>
<span id="cb41-4"><a href=""></a>  user<span class="op">=</span><span class="st">"yourusername"</span>,</span>
<span id="cb41-5"><a href=""></a>  password<span class="op">=</span><span class="st">"yourpassword"</span>,</span>
<span id="cb41-6"><a href=""></a>  database<span class="op">=</span><span class="st">"mydatabase"</span></span>
<span id="cb41-7"><a href=""></a>)</span>
<span id="cb41-8"><a href=""></a>mycursor <span class="op">=</span> mydb.cursor()</span>
<span id="cb41-9"><a href=""></a>mycursor.execute(<span class="st">"SELECT name, address FROM table_name"</span>)</span>
<span id="cb41-10"><a href=""></a>myresult <span class="op">=</span> mycursor.fetchall()</span>
<span id="cb41-11"><a href=""></a>df <span class="op">=</span> pd.DataFrame(myresult)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="duckdb" class="slide level2">
<h2>DuckDB</h2>
<ul>
<li>https://duckdb.org/</li>
<li>an open-source column-oriented relational database management system</li>
<li>Unlike other embedded databases (SQLite) DuckDB is not focusing on transactional (OLTP) applications and instead is specialized for online analytical processing (OLAP) workloads</li>
<li>需要先安裝<code>pandas</code>和<code>duckdb</code>套件</li>
</ul>
<div id="e5194f30" class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href=""></a><span class="op">!</span>pip3 install pandas duckdb</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="duckdb-1" class="slide level2">
<h2>DuckDB</h2>
<ul>
<li>Load any file with DuckDB</li>
<li>Use <code>.csv</code> as an example
<ul>
<li>TSMC stock price</li>
<li>Download from <a href="https://www.marketwatch.com/investing/stock/2330/download-data?startDate=2/1/2022&amp;endDate=2/18/2025&amp;countryCode=tw">MarketWatch</a></li>
</ul></li>
<li><code>file_path</code> can be <code>local file path</code> or <code>url</code></li>
</ul>
<div id="022dce47" class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href=""></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb43-2"><a href=""></a><span class="im">import</span> duckdb</span>
<span id="cb43-3"><a href=""></a>file_path <span class="op">=</span> <span class="st">"STOCK_TW_XTAI_2330.csv"</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="duckdb-2" class="slide level2">
<h2>DuckDB</h2>
<ul>
<li><code>duckdb.connect(database=':memory:')</code> open the connection</li>
<li><code>conn.execute(SQL)</code> execute <code>SQL</code>
<ul>
<li><code>CREATE</code>, <code>SELECT</code>, etc</li>
</ul></li>
<li><code>conn.close()</code> close the connection</li>
</ul>
<div id="f9b5f5d5" class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href=""></a>conn <span class="op">=</span> duckdb.<span class="ex">connect</span>(database<span class="op">=</span><span class="st">':memory:'</span>)   </span>
<span id="cb44-2"><a href=""></a>conn.execute(<span class="ss">f"""</span></span>
<span id="cb44-3"><a href=""></a><span class="ss">    CREATE TABLE TSMC_stock AS </span></span>
<span id="cb44-4"><a href=""></a><span class="ss">    SELECT *</span></span>
<span id="cb44-5"><a href=""></a><span class="ss">    FROM read_csv_auto('</span><span class="sc">{</span>file_path<span class="sc">}</span><span class="ss">')</span></span>
<span id="cb44-6"><a href=""></a><span class="ss">"""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="132">
<pre><code>&lt;duckdb.duckdb.DuckDBPyConnection at 0x11cbbd1b0&gt;</code></pre>
</div>
</div>
</section>
<section id="duckdb-3" class="slide level2">
<h2>DuckDB</h2>
<ul>
<li><code>conn.execute(SQL)</code> execute <code>SQL</code>
<ul>
<li><code>CREATE</code>, <code>SELECT</code>, etc</li>
<li><code>SELECT</code> retrieval can be stored in dataframe</li>
</ul></li>
<li><code>conn.close()</code> close the connection</li>
<li>We need more than a <code>*</code>…. for data preprocessing</li>
</ul>
<div id="c39e0646" class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href=""></a>df_duckdb <span class="op">=</span> conn.execute(<span class="st">"SELECT * FROM TSMC_stock"</span>).fetchdf()</span>
<span id="cb46-2"><a href=""></a>conn.close()     </span>
<span id="cb46-3"><a href=""></a><span class="bu">print</span>(df_duckdb)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          Date      Open      High       Low     Close      Volume
0   2025-02-18  1,085.00  1,100.00  1,080.00  1,100.00  22,357,939
1   2025-02-17  1,065.00  1,085.00  1,065.00  1,085.00  36,903,859
2   2025-02-14  1,065.00  1,070.00  1,060.00  1,060.00  70,775,922
3   2025-02-13  1,090.00  1,095.00  1,080.00  1,090.00  34,840,520
4   2025-02-12  1,110.00  1,115.00  1,100.00  1,100.00  24,977,391
..         ...       ...       ...       ...       ...         ...
237 2024-02-23    701.00    703.00    696.00    697.00  47,810,473
238 2024-02-22    695.00    695.00    685.00    692.00  34,122,391
239 2024-02-21    678.00    683.00    678.00    681.00  31,417,539
240 2024-02-20    675.00    688.00    675.00    687.00  30,897,730
241 2024-02-19    674.00    682.00    674.00    678.00  35,158,832

[242 rows x 6 columns]</code></pre>
</div>
</div>
</section>
<section id="duckdb-4" class="slide level2">
<h2>DuckDB</h2>
<p>We need more than a <code>*</code>…. for data preprocessing</p>
<div id="dfd29b5f" class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href=""></a>conn <span class="op">=</span> duckdb.<span class="ex">connect</span>(database<span class="op">=</span><span class="st">':memory:'</span>)   </span>
<span id="cb48-2"><a href=""></a>conn.execute(<span class="ss">f"""</span></span>
<span id="cb48-3"><a href=""></a><span class="ss">    CREATE TABLE TSMC_stock AS </span></span>
<span id="cb48-4"><a href=""></a><span class="ss">    SELECT </span></span>
<span id="cb48-5"><a href=""></a><span class="ss">        Date,  -- Keep the Date column unchanged</span></span>
<span id="cb48-6"><a href=""></a><span class="ss">        CAST(REPLACE(Open, ',', '') AS DOUBLE) AS Open,</span></span>
<span id="cb48-7"><a href=""></a><span class="ss">        CAST(REPLACE(High, ',', '') AS DOUBLE) AS High,</span></span>
<span id="cb48-8"><a href=""></a><span class="ss">        CAST(REPLACE(Low, ',', '') AS DOUBLE) AS Low,</span></span>
<span id="cb48-9"><a href=""></a><span class="ss">        CAST(REPLACE(Close, ',', '') AS DOUBLE) AS Close,</span></span>
<span id="cb48-10"><a href=""></a><span class="ss">        CAST(REPLACE(Volume, ',', '') AS BIGINT) AS Volume</span></span>
<span id="cb48-11"><a href=""></a><span class="ss">    FROM read_csv_auto('</span><span class="sc">{</span>file_path<span class="sc">}</span><span class="ss">')</span></span>
<span id="cb48-12"><a href=""></a><span class="ss">"""</span>)</span>
<span id="cb48-13"><a href=""></a>df_duckdb <span class="op">=</span> conn.execute(<span class="st">"SELECT * FROM TSMC_stock"</span>).fetchdf()</span>
<span id="cb48-14"><a href=""></a>conn.close()     </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="duckdb-5" class="slide level2">
<h2>DuckDB</h2>
<div id="7fa27193" class="cell" data-execution_count="37">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href=""></a><span class="bu">print</span>(df_duckdb) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          Date    Open    High     Low   Close    Volume
0   2025-02-18  1085.0  1100.0  1080.0  1100.0  22357939
1   2025-02-17  1065.0  1085.0  1065.0  1085.0  36903859
2   2025-02-14  1065.0  1070.0  1060.0  1060.0  70775922
3   2025-02-13  1090.0  1095.0  1080.0  1090.0  34840520
4   2025-02-12  1110.0  1115.0  1100.0  1100.0  24977391
..         ...     ...     ...     ...     ...       ...
237 2024-02-23   701.0   703.0   696.0   697.0  47810473
238 2024-02-22   695.0   695.0   685.0   692.0  34122391
239 2024-02-21   678.0   683.0   678.0   681.0  31417539
240 2024-02-20   675.0   688.0   675.0   687.0  30897730
241 2024-02-19   674.0   682.0   674.0   678.0  35158832

[242 rows x 6 columns]</code></pre>
</div>
</div>
</section>
<section id="duckdb-6" class="slide level2">
<h2>DuckDB</h2>
<p>You can also use <code>duckdb.query(SQL).to_df()</code> for data retrieval</p>
<div id="f69e66d0" class="cell" data-execution_count="38">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href=""></a>Query <span class="op">=</span> <span class="st">'''</span></span>
<span id="cb51-2"><a href=""></a><span class="st">SELECT YEAR(Date) AS Year, MONTH(Date) AS Month, AVG(Open) as avg_price, COUNT(Open) AS count </span></span>
<span id="cb51-3"><a href=""></a><span class="st">FROM df_duckdb </span></span>
<span id="cb51-4"><a href=""></a><span class="st">GROUP BY Year, Month</span></span>
<span id="cb51-5"><a href=""></a><span class="st">ORDER BY avg_price DESC</span></span>
<span id="cb51-6"><a href=""></a><span class="st">'''</span></span>
<span id="cb51-7"><a href=""></a>df_duckdb2 <span class="op">=</span> duckdb.query(Query).to_df()</span>
<span id="cb51-8"><a href=""></a>df_duckdb2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="136">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe caption-top" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header" style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Year</th>
<th data-quarto-table-cell-role="th">Month</th>
<th data-quarto-table-cell-role="th">avg_price</th>
<th data-quarto-table-cell-role="th">count</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>2025</td>
<td>1</td>
<td>1106.000000</td>
<td>15</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2025</td>
<td>2</td>
<td>1095.000000</td>
<td>12</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>2024</td>
<td>12</td>
<td>1070.681818</td>
<td>22</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>2024</td>
<td>10</td>
<td>1041.105263</td>
<td>19</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>2024</td>
<td>11</td>
<td>1034.571429</td>
<td>21</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>2024</td>
<td>7</td>
<td>990.476190</td>
<td>21</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>2024</td>
<td>9</td>
<td>948.850000</td>
<td>20</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>2024</td>
<td>8</td>
<td>937.454545</td>
<td>22</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>2024</td>
<td>6</td>
<td>916.000000</td>
<td>19</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>2024</td>
<td>5</td>
<td>829.909091</td>
<td>22</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10</td>
<td>2024</td>
<td>4</td>
<td>788.400000</td>
<td>20</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">11</td>
<td>2024</td>
<td>3</td>
<td>762.380952</td>
<td>21</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">12</td>
<td>2024</td>
<td>2</td>
<td>689.250000</td>
<td>8</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="data-input-and-output-5" class="slide level2">
<h2>Data input and output</h2>
<ul>
<li><strong>Data input</strong>
<ul>
<li>From file</li>
<li>From google drive</li>
<li>From API</li>
<li>From database</li>
<li><strong>Webscrapping</strong></li>
</ul></li>
<li>Data output</li>
</ul>
</section></section>
<section>
<section id="網頁爬蟲-webscraping" class="title-slide slide level1 center">
<h1>網頁爬蟲 Webscraping</h1>

</section>
<section id="網頁爬蟲-webscraping-1" class="slide level2">
<h2>網頁爬蟲 Webscraping</h2>
<ul>
<li>不是每個網站都提供API</li>
<li>人工複製貼上?!</li>
<li>程式化的方式擷取網頁資料: <strong>網頁爬蟲（Webscraping）</strong>（<a href="http://en.wikipedia.org/wiki/Web_scraping">Webscraping Wiki</a>）</li>
<li>可能耗費很多網頁流量和資源 －很可能被鎖IP</li>
<li>使用<code>beautifulsoup4</code> 套件輔助</li>
</ul>
</section>
<section id="網頁爬蟲-webscraping-beautifulsoup4" class="slide level2">
<h2>網頁爬蟲 Webscraping-beautifulsoup4</h2>
<p>需要先安裝<code>beautifulsoup4</code>以及<code>requests</code>套件。</p>
<div id="88049ae4" class="cell" data-execution_count="39">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href=""></a><span class="op">!</span>pip3 install beautifulsoup4 requests</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>擷取條件的撰寫會因網頁語法不同而有差異</li>
<li>使用<strong>Google Chrome開發工具</strong>輔助觀察擷取資料的條件
<ul>
<li>或是按右鍵，點選“檢查”</li>
<li>或使用<strong>SelectorGadget</strong>輔助</li>
</ul></li>
<li>觀察需要擷取的資料所在HTML片段
<ul>
<li>css class, id 等</li>
</ul></li>
</ul>
</section>
<section id="即時股價爬取" class="slide level2">
<h2>即時股價爬取</h2>
<ul>
<li><a href="ttps://www.google.com/finance/">Google 財經</a></li>
<li><a href="https://www.google.com/finance/quote/2330:TPE?hl=zh-TW">Google 財經 - 台積電</a></li>
</ul>
<div id="aab6a9f8" class="cell" data-execution_count="40">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href=""></a><span class="im">from</span> bs4 <span class="im">import</span> BeautifulSoup</span>
<span id="cb53-2"><a href=""></a><span class="im">import</span> requests</span>
<span id="cb53-3"><a href=""></a>StockUrl <span class="op">=</span> <span class="st">"https://www.google.com/finance/quote/2330:TPE?hl=zh-TW"</span></span>
<span id="cb53-4"><a href=""></a>res <span class="op">=</span> requests.get(StockUrl)</span>
<span id="cb53-5"><a href=""></a>soup <span class="op">=</span> BeautifulSoup(res.text, <span class="st">"html.parser"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="87396cf4" class="cell" data-execution_count="41">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href=""></a>price <span class="op">=</span> soup.select(<span class="st">".fxKbKc"</span>)</span>
<span id="cb54-2"><a href=""></a>price[<span class="dv">0</span>].get_text()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="138">
<pre><code>'$980.00'</code></pre>
</div>
</div>
</section>
<section id="htmlxml-101" class="slide level2">
<h2>HTML/XML 101</h2>
<ul>
<li>Element: <code>&lt;a class=’link’ href=’url’&gt;29.99&lt;/a&gt;</code></li>
<li>Start tag: <code>&lt;a&gt;</code></li>
<li>End tag: <code>&lt;/a&gt;</code></li>
<li>Attribute屬性: <code>href=’url’</code>, <code>class=’link’</code></li>
<li>Text文字: <code>29.99</code></li>
</ul>
</section>
<section id="即時股價爬取---下載html" class="slide level2">
<h2>即時股價爬取 - 下載html</h2>
<ul>
<li>使用<code>requests</code>套件的<code>get(網址)</code>函數，輸入網址，將網頁載入python分析環境。</li>
<li>成功載入網頁後，針對該物件，使用<code>.text</code>取得網頁原始碼 (.html)</li>
</ul>
<div id="327c0df5" class="cell" data-execution_count="42">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a href=""></a>StockUrl <span class="op">=</span> <span class="st">"https://www.google.com/finance/quote/2330:TPE?hl=zh-TW"</span></span>
<span id="cb56-2"><a href=""></a>res <span class="op">=</span> requests.get(StockUrl)</span>
<span id="cb56-3"><a href=""></a>res.text[<span class="dv">0</span>:<span class="dv">1000</span>] <span class="co">## print first 1000 chars</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="139">
<pre><code>'&lt;!doctype html&gt;&lt;html lang="zh-TW" dir="ltr"&gt;&lt;head&gt;&lt;base href="https://www.google.com/finance/"&gt;&lt;link rel="preconnect" href="//www.gstatic.com"&gt;&lt;meta name="referrer" content="origin"&gt;&lt;script nonce="jSD9fSEP9mMtZXGWqlQv3Q"&gt;window[\'ppConfig\'] = {productName: \'GoogleFinanceUi\', deleteIsEnforced:  true , sealIsEnforced:  true , heartbeatRate:  0.5 , periodicReportingRateMillis:  60000.0 , disableAllReporting:  false };(function(){\'use strict\';function k(a){var b=0;return function(){return b&lt;a.length?{done:!1,value:a[b++]}:{done:!0}}}var l=typeof Object.defineProperties=="function"?Object.defineProperty:function(a,b,c){if(a==Array.prototype||a==Object.prototype)return a;a[b]=c.value;return a};\nfunction m(a){a=["object"==typeof globalThis&amp;&amp;globalThis,a,"object"==typeof window&amp;&amp;window,"object"==typeof self&amp;&amp;self,"object"==typeof global&amp;&amp;global];for(var b=0;b&lt;a.length;++b){var c=a[b];if(c&amp;&amp;c.Math==Math)return c}throw Error("Cannot find global object");}var n=m(this);function p(a,b){if(b)a:{var '</code></pre>
</div>
</div>
</section>
<section id="即時股價爬取---解析html" class="slide level2">
<h2>即時股價爬取 - 解析html</h2>
<ul>
<li>使用<code>BeautifulSoup</code>套件提供的解析方法<code>BeautifulSoup(html檔案,格式)</code>
<ul>
<li>輸入剛剛載回來的html檔案<code>res.text</code>，以及設定格式<code>"html.parser"</code>，完成HTML解析</li>
</ul></li>
<li>解析後可使用<code>解析後內容.prettify</code>取得排版後的網頁原始碼</li>
</ul>
<div id="2e93168c" class="cell" data-execution_count="43">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a href=""></a>soup <span class="op">=</span> BeautifulSoup(res.text, <span class="st">"html.parser"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="即時股價爬取---搜尋所需element--1" class="slide level2">
<h2>即時股價爬取 - 搜尋所需element -1</h2>
<p>Python 搜尋法，多用於搜尋<code>&lt;&gt;</code>tag內的內容</p>
<ul>
<li><code>find(tag名稱)</code>:
<ul>
<li>取得第一個符合條件的element</li>
</ul></li>
<li><code>find_all(tag名稱)</code>
<ul>
<li>取得所有符合條件的elements</li>
</ul></li>
</ul>
</section>
<section id="即時股價爬取---搜尋所需element--1-1" class="slide level2">
<h2>即時股價爬取 - 搜尋所需element -1</h2>
<p>CCS selector 搜尋法，有較多彈性</p>
<ul>
<li><code>select_one()</code>
<ul>
<li>取得第一個符合CSS條件的element (<code>class</code> or <code>id</code>等屬性)</li>
</ul></li>
<li><code>select()</code>
<ul>
<li>取得所有符合CSS條件的elements (<code>class</code> or <code>id</code>等屬性)</li>
</ul></li>
</ul>
</section>
<section id="即時股價爬取---搜尋所需element--1-2" class="slide level2">
<h2>即時股價爬取 - 搜尋所需element -1</h2>
<p>範例：class 包含 <code>fxKbKc</code></p>
<ul>
<li><code>select()</code>
<ul>
<li>取得所有符合CSS條件的elements (<code>class</code> or <code>id</code>等屬性)</li>
</ul></li>
<li><code>class=</code>可用<code>.</code>代表</li>
<li><code>id=</code>可用<code>#</code>代表</li>
</ul>
<div id="72c69aa5" class="cell" data-execution_count="44">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb59-1"><a href=""></a>soup <span class="op">=</span> BeautifulSoup(res.text, <span class="st">"html.parser"</span>)</span>
<span id="cb59-2"><a href=""></a>price <span class="op">=</span> soup.select(<span class="st">".fxKbKc"</span>)</span>
<span id="cb59-3"><a href=""></a>price</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="141">
<pre><code>[&lt;div class="YMlKec fxKbKc"&gt;$980.00&lt;/div&gt;]</code></pre>
</div>
</div>
</section>
<section id="即時股價爬取---取出需要的資料--1" class="slide level2">
<h2>即時股價爬取 - 取出需要的資料 -1</h2>
<ul>
<li><code>.get_text()</code>可抓取element內文字</li>
<li><code>.get("屬性名稱")</code>可抓取屬性內容</li>
</ul>
<div id="7777b83a" class="cell" data-execution_count="45">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb61-1"><a href=""></a>price[<span class="dv">0</span>].get_text()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="142">
<pre><code>'$980.00'</code></pre>
</div>
</div>
</section>
<section id="即時股價爬取---搜尋所需element--2" class="slide level2">
<h2>即時股價爬取 - 搜尋所需element -2</h2>
<p>範例：class 包含 <code>gyFHrc</code></p>
<ul>
<li><code>select()</code>
<ul>
<li>取得所有符合CSS條件的elements (<code>class</code> or <code>id</code>等屬性)</li>
</ul></li>
</ul>
<div id="e6673cbc" class="cell" data-execution_count="46">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb63-1"><a href=""></a>soup <span class="op">=</span> BeautifulSoup(res.text, <span class="st">"html.parser"</span>)</span>
<span id="cb63-2"><a href=""></a>price_detail <span class="op">=</span> soup.select(<span class="st">".gyFHrc"</span>)</span>
<span id="cb63-3"><a href=""></a>price_detail</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="143">
<pre><code>[&lt;div class="gyFHrc"&gt;&lt;span data-is-tooltip-wrapper="true"&gt;&lt;div aria-describedby="i15" class="mfs7Fc" data-tooltip-anchor-boundary-type="2" data-tooltip-x-position="2" jsaction="mouseenter:tfO1Yc; focus:AHmuwe; blur:O22p3e; mouseleave:JywGue; touchstart:p6p2H; touchend:yfqBxc;mlnRJb:fLiPzd;" jscontroller="e2jnoe"&gt;前次收盤價&lt;/div&gt;&lt;div aria-hidden="true" class="EY8ABd-OWXEXe-TAWMXe" id="i15" role="tooltip"&gt;最後收盤價&lt;/div&gt;&lt;/span&gt;&lt;div class="P6K39c"&gt;$990.00&lt;/div&gt;&lt;/div&gt;,
 &lt;div class="gyFHrc"&gt;&lt;span data-is-tooltip-wrapper="true"&gt;&lt;div aria-describedby="i16" class="mfs7Fc" data-tooltip-anchor-boundary-type="2" data-tooltip-x-position="2" jsaction="mouseenter:tfO1Yc; focus:AHmuwe; blur:O22p3e; mouseleave:JywGue; touchstart:p6p2H; touchend:yfqBxc;mlnRJb:fLiPzd;" jscontroller="e2jnoe"&gt;單日股價範圍&lt;/div&gt;&lt;div aria-hidden="true" class="EY8ABd-OWXEXe-TAWMXe" id="i16" role="tooltip"&gt;過去一天內最高價與最低價之間的價格範圍&lt;/div&gt;&lt;/span&gt;&lt;div class="P6K39c"&gt;$980.00 - $995.00&lt;/div&gt;&lt;/div&gt;,
 &lt;div class="gyFHrc"&gt;&lt;span data-is-tooltip-wrapper="true"&gt;&lt;div aria-describedby="i17" class="mfs7Fc" data-tooltip-anchor-boundary-type="2" data-tooltip-x-position="2" jsaction="mouseenter:tfO1Yc; focus:AHmuwe; blur:O22p3e; mouseleave:JywGue; touchstart:p6p2H; touchend:yfqBxc;mlnRJb:fLiPzd;" jscontroller="e2jnoe"&gt;一年股價範圍&lt;/div&gt;&lt;div aria-hidden="true" class="EY8ABd-OWXEXe-TAWMXe" id="i17" role="tooltip"&gt;過去 52 週內最高價與最低價之間的價格範圍&lt;/div&gt;&lt;/span&gt;&lt;div class="P6K39c"&gt;$740.00 - $1,160.00&lt;/div&gt;&lt;/div&gt;,
 &lt;div class="gyFHrc"&gt;&lt;span data-is-tooltip-wrapper="true"&gt;&lt;div aria-describedby="i18" class="mfs7Fc" data-tooltip-anchor-boundary-type="2" data-tooltip-x-position="2" jsaction="mouseenter:tfO1Yc; focus:AHmuwe; blur:O22p3e; mouseleave:JywGue; touchstart:p6p2H; touchend:yfqBxc;mlnRJb:fLiPzd;" jscontroller="e2jnoe"&gt;總市值&lt;/div&gt;&lt;div aria-hidden="true" class="EY8ABd-OWXEXe-TAWMXe" id="i18" role="tooltip"&gt;一種估價方法，將公司股價乘以在外流通總股數。&lt;/div&gt;&lt;/span&gt;&lt;div class="P6K39c"&gt;25.41兆 TWD&lt;/div&gt;&lt;/div&gt;,
 &lt;div class="gyFHrc"&gt;&lt;span data-is-tooltip-wrapper="true"&gt;&lt;div aria-describedby="i19" class="mfs7Fc" data-tooltip-anchor-boundary-type="2" data-tooltip-x-position="2" jsaction="mouseenter:tfO1Yc; focus:AHmuwe; blur:O22p3e; mouseleave:JywGue; touchstart:p6p2H; touchend:yfqBxc;mlnRJb:fLiPzd;" jscontroller="e2jnoe"&gt;平均交易量&lt;/div&gt;&lt;div aria-hidden="true" class="EY8ABd-OWXEXe-TAWMXe" id="i19" role="tooltip"&gt;過去 30 天內平均每天的成交股數&lt;/div&gt;&lt;/span&gt;&lt;div class="P6K39c"&gt;3956.76萬&lt;/div&gt;&lt;/div&gt;,
 &lt;div class="gyFHrc"&gt;&lt;span data-is-tooltip-wrapper="true"&gt;&lt;div aria-describedby="i20" class="mfs7Fc" data-tooltip-anchor-boundary-type="2" data-tooltip-x-position="2" jsaction="mouseenter:tfO1Yc; focus:AHmuwe; blur:O22p3e; mouseleave:JywGue; touchstart:p6p2H; touchend:yfqBxc;mlnRJb:fLiPzd;" jscontroller="e2jnoe"&gt;本益比&lt;/div&gt;&lt;div aria-hidden="true" class="EY8ABd-OWXEXe-TAWMXe" id="i20" role="tooltip"&gt;目前股價與過去十二個月每股盈餘總和兩者之間的比率，這個比率可反映某檔股票的價格相較於其他股票是高還低&lt;/div&gt;&lt;/span&gt;&lt;div class="P6K39c"&gt;21.66&lt;/div&gt;&lt;/div&gt;,
 &lt;div class="gyFHrc"&gt;&lt;span data-is-tooltip-wrapper="true"&gt;&lt;div aria-describedby="i21" class="mfs7Fc" data-tooltip-anchor-boundary-type="2" data-tooltip-x-position="2" jsaction="mouseenter:tfO1Yc; focus:AHmuwe; blur:O22p3e; mouseleave:JywGue; touchstart:p6p2H; touchend:yfqBxc;mlnRJb:fLiPzd;" jscontroller="e2jnoe"&gt;股利收益率&lt;/div&gt;&lt;div aria-hidden="true" class="EY8ABd-OWXEXe-TAWMXe" id="i21" role="tooltip"&gt;年股利與目前股價兩者之間的比率，這個比率可用於估計某檔股票的股利報酬率&lt;/div&gt;&lt;/span&gt;&lt;div class="P6K39c"&gt;1.73%&lt;/div&gt;&lt;/div&gt;,
 &lt;div class="gyFHrc"&gt;&lt;span data-is-tooltip-wrapper="true"&gt;&lt;div aria-describedby="i22" class="mfs7Fc" data-tooltip-anchor-boundary-type="2" data-tooltip-x-position="2" jsaction="mouseenter:tfO1Yc; focus:AHmuwe; blur:O22p3e; mouseleave:JywGue; touchstart:p6p2H; touchend:yfqBxc;mlnRJb:fLiPzd;" jscontroller="e2jnoe"&gt;主要交易所&lt;/div&gt;&lt;div aria-hidden="true" class="EY8ABd-OWXEXe-TAWMXe" id="i22" role="tooltip"&gt;這檔證券的上市交易所&lt;/div&gt;&lt;/span&gt;&lt;div class="P6K39c"&gt;TPE&lt;/div&gt;&lt;/div&gt;,
 &lt;div class="gyFHrc"&gt;&lt;div class="mfs7Fc"&gt;&lt;span aria-hidden="true" class="notranslate gnzz8b"&gt;&lt;svg class="NMm5M" focusable="false" height="14" viewbox="0 0 24 24" width="14"&gt;&lt;path d="M12 6c1.1 0 2 .9 2 2s-.9 2-2 2-2-.9-2-2 .9-2 2-2m0 9c2.7 0 5.8 1.29 6 2v1H6v-.99c.2-.72 3.3-2.01 6-2.01m0-11C9.79 4 8 5.79 8 8s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4zm0 9c-2.67 0-8 1.34-8 4v3h16v-3c0-2.66-5.33-4-8-4z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/span&gt;執行長&lt;/div&gt;&lt;div class="P6K39c"&gt;&lt;ul class="OEHt4c"&gt;&lt;li&gt;&lt;a class="tBHE4e" href="https://www.google.com/search?q=%E9%AD%8F%E5%93%B2%E5%AE%B6&amp;amp;hl=zh-TW" jslog="166166;ved:2ahUKEwj13oimtaeMAxWHBnsHHRPcMDYQlpIKegQIAhBa;track:click" target="_blank"&gt;魏哲家&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&lt;/div&gt;,
 &lt;div class="gyFHrc"&gt;&lt;div class="mfs7Fc"&gt;&lt;span aria-hidden="true" class="notranslate gnzz8b"&gt;&lt;svg class="NMm5M" focusable="false" height="14" viewbox="0 0 24 24" width="14"&gt;&lt;path d="M19 4h-1V2h-2v2H8V2H6v2H5c-1.11 0-1.99.9-1.99 2L3 20a2 2 0 0 0 2 2h14c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 16H5V10h14v10z"&gt;&lt;/path&gt;&lt;path d="M14.5 13a2.5 2.5 0 0 0 0 5 2.5 2.5 0 0 0 0-5z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/span&gt;成立時間&lt;/div&gt;&lt;div class="P6K39c"&gt;1987年2月21日&lt;/div&gt;&lt;/div&gt;,
 &lt;div class="gyFHrc"&gt;&lt;div class="mfs7Fc"&gt;&lt;span aria-hidden="true" class="notranslate gnzz8b"&gt;&lt;svg class="NMm5M" focusable="false" height="14" viewbox="0 0 24 24" width="14"&gt;&lt;path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zM7 9c0-2.76 2.24-5 5-5s5 2.24 5 5c0 2.88-2.88 7.19-5 9.88C9.92 16.21 7 11.85 7 9z"&gt;&lt;/path&gt;&lt;circle cx="12" cy="9" r="2.5"&gt;&lt;/circle&gt;&lt;/svg&gt;&lt;/span&gt;總部&lt;/div&gt;&lt;div class="P6K39c"&gt;&lt;a class="tBHE4e" href="https://www.google.com/maps/place/8%2C%20Li-Hsin%20Rd.%206%2C%20%E6%96%B0%E7%AB%B9%2C%20%E8%87%BA%E7%81%A3%E7%9C%81%2C%20%E5%8F%B0%E7%81%A3?hl=zh-TW" jslog="166166;ved:2ahUKEwj13oimtaeMAxWHBnsHHRPcMDYQlpIKegQIAhBa;track:click" target="_blank"&gt;臺灣省新竹&lt;br/&gt;台灣&lt;/a&gt;&lt;/div&gt;&lt;/div&gt;,
 &lt;div class="gyFHrc"&gt;&lt;div class="mfs7Fc"&gt;&lt;span aria-hidden="true" class="notranslate gnzz8b"&gt;&lt;svg class="NMm5M" focusable="false" height="14" viewbox="0 0 24 24" width="14"&gt;&lt;path d="M20 4H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h16c1.1 0 2-.9 2-2V6a2 2 0 0 0-2-2zm0 14H4V8h16v10z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/span&gt;網站&lt;/div&gt;&lt;div class="P6K39c"&gt;&lt;a class="tBHE4e" href="http://www.tsmc.com/" jslog="166166;ved:2ahUKEwj13oimtaeMAxWHBnsHHRPcMDYQlpIKegQIAhBa;track:click" rel="noopener noreferrer" target="_blank"&gt;tsmc.com&lt;/a&gt;&lt;/div&gt;&lt;/div&gt;,
 &lt;div class="gyFHrc"&gt;&lt;div class="mfs7Fc"&gt;&lt;span aria-hidden="true" class="notranslate gnzz8b"&gt;&lt;svg class="NMm5M" focusable="false" height="14" viewbox="0 0 24 24" width="14"&gt;&lt;path d="M15 8c0-1.42-.5-2.73-1.33-3.76.42-.14.86-.24 1.33-.24 2.21 0 4 1.79 4 4s-1.79 4-4 4c-.43 0-.84-.09-1.23-.21-.03-.01-.06-.02-.1-.03A5.98 5.98 0 0 0 15 8zm1.66 5.13C18.03 14.06 19 15.32 19 17v3h4v-3c0-2.18-3.58-3.47-6.34-3.87zM9 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2m0 9c-2.7 0-5.8 1.29-6 2.01V18h12v-1c-.2-.71-3.3-2-6-2M9 4c2.21 0 4 1.79 4 4s-1.79 4-4 4-4-1.79-4-4 1.79-4 4-4zm0 9c2.67 0 8 1.34 8 4v3H1v-3c0-2.66 5.33-4 8-4z"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/span&gt;員工數&lt;/div&gt;&lt;div class="P6K39c"&gt;65,152&lt;/div&gt;&lt;/div&gt;]</code></pre>
</div>
</div>
</section>
<section id="即時股價爬取---取出需要的資料--2" class="slide level2">
<h2>即時股價爬取 - 取出需要的資料 -2</h2>
<ul>
<li><code>.get_text()</code>可抓取element內文字</li>
<li><code>.get("屬性名稱")</code>可抓取屬性內容</li>
</ul>
<div id="c56f185e" class="cell" data-execution_count="47">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb65-1"><a href=""></a><span class="bu">len</span>(price_detail)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="144">
<pre><code>13</code></pre>
</div>
</div>
<div id="395673ad" class="cell" data-execution_count="48">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb67-1"><a href=""></a><span class="cf">for</span> price <span class="kw">in</span> price_detail:</span>
<span id="cb67-2"><a href=""></a>  <span class="bu">print</span>(price.get_text())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>前次收盤價最後收盤價$990.00
單日股價範圍過去一天內最高價與最低價之間的價格範圍$980.00 - $995.00
一年股價範圍過去 52 週內最高價與最低價之間的價格範圍$740.00 - $1,160.00
總市值一種估價方法，將公司股價乘以在外流通總股數。25.41兆 TWD
平均交易量過去 30 天內平均每天的成交股數3956.76萬
本益比目前股價與過去十二個月每股盈餘總和兩者之間的比率，這個比率可反映某檔股票的價格相較於其他股票是高還低21.66
股利收益率年股利與目前股價兩者之間的比率，這個比率可用於估計某檔股票的股利報酬率1.73%
主要交易所這檔證券的上市交易所TPE
執行長魏哲家
成立時間1987年2月21日
總部臺灣省新竹台灣
網站tsmc.com
員工數65,152</code></pre>
</div>
</div>
</section>
<section id="即時股價爬取---搜尋所需element--3" class="slide level2">
<h2>即時股價爬取 - 搜尋所需element -3</h2>
<p>範例：class 包含 <code>z4rs2b</code></p>
<ul>
<li><code>select()</code>: 取得所有符合CSS條件的element (<code>class</code> or <code>id</code>等屬性)</li>
</ul>
<div id="b404ab79" class="cell" data-execution_count="49">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb69-1"><a href=""></a>soup <span class="op">=</span> BeautifulSoup(res.text, <span class="st">"html.parser"</span>)</span>
<span id="cb69-2"><a href=""></a>news <span class="op">=</span> soup.select(<span class="st">".z4rs2b"</span>)</span>
<span id="cb69-3"><a href=""></a>news</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="146">
<pre><code>[&lt;div class="z4rs2b"&gt;&lt;a data-ved="2ahUKEwj13oimtaeMAxWHBnsHHRPcMDYQuL8GegQIAhAx" href="https://tw.news.yahoo.com/%E8%AA%AA%E5%87%BA%E7%9C%9F%E7%9B%B8-%E9%87%91%E7%AE%A1%E6%9C%83%E4%B8%BB%E5%A7%94%E5%BD%AD%E9%87%91%E9%9A%86-%E5%8F%B0%E7%A9%8D%E9%9B%BB%E8%B5%B4%E7%BE%8E%E6%8A%95%E8%B3%87-%E6%88%91%E7%9C%8B%E9%87%8D%E8%A8%8A%E6%89%8D%E7%9F%A5%E9%81%93-063600663.html" jslog="106424;ved:2ahUKEwj13oimtaeMAxWHBnsHHRPcMDYQuL8GegQIAhAx;track:click" rel="noopener noreferrer" target="_blank"&gt;&lt;div class="Tfehrf"&gt;&lt;div class="nkXTJ W8knGc" jsname="GvmPSb"&gt;&lt;div class="sfyJob"&gt;奇摩新聞&lt;/div&gt;&lt;div class="cCEUJe"&gt;&lt;div class="Adak"&gt;2 小時前&lt;/div&gt;&lt;div class="hVmHve" jsname="iwaAEc"&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class="Yfwt5"&gt;說出真相？金管會主委彭金隆：台積電赴美投資「我看重訊才知道」&lt;/div&gt;&lt;/div&gt;&lt;/a&gt;&lt;/div&gt;,
 &lt;div class="z4rs2b"&gt;&lt;a data-ved="2ahUKEwj13oimtaeMAxWHBnsHHRPcMDYQuL8GegQIAhAz" href="https://udn.com/news/story/7240/8632099" jslog="106424;ved:2ahUKEwj13oimtaeMAxWHBnsHHRPcMDYQuL8GegQIAhAz;track:click" rel="noopener noreferrer" target="_blank"&gt;&lt;div class="Tfehrf"&gt;&lt;div class="nkXTJ W8knGc" jsname="GvmPSb"&gt;&lt;div class="sfyJob"&gt;聯合新聞網&lt;/div&gt;&lt;div class="cCEUJe"&gt;&lt;div class="Adak"&gt;15 小時前&lt;/div&gt;&lt;div class="hVmHve" jsname="iwaAEc"&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class="Yfwt5"&gt;「晶片戰爭」作者米勒：台積投資美 非凡成功&lt;/div&gt;&lt;/div&gt;&lt;/a&gt;&lt;/div&gt;,
 &lt;div class="z4rs2b"&gt;&lt;a data-ved="2ahUKEwj13oimtaeMAxWHBnsHHRPcMDYQuL8GegQIAhA1" href="https://www.hwa-guan.com.tw/Wealth/ViewPoint/ArticleContent?C_id=10714" jslog="106424;ved:2ahUKEwj13oimtaeMAxWHBnsHHRPcMDYQuL8GegQIAhA1;track:click" rel="noopener noreferrer" target="_blank"&gt;&lt;div class="Tfehrf"&gt;&lt;div class="nkXTJ W8knGc" jsname="GvmPSb"&gt;&lt;div class="sfyJob"&gt;華冠投顧&lt;/div&gt;&lt;div class="cCEUJe"&gt;&lt;div class="Adak"&gt;1 小時前&lt;/div&gt;&lt;div class="hVmHve" jsname="iwaAEc"&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class="Yfwt5"&gt;台積電逼近1005元，3680家登率先發動&lt;/div&gt;&lt;/div&gt;&lt;/a&gt;&lt;/div&gt;,
 &lt;div class="z4rs2b"&gt;&lt;a data-ved="2ahUKEwj13oimtaeMAxWHBnsHHRPcMDYQuL8GegQIAhA3" href="https://www.msn.com/zh-tw/money/topstories/%E5%8F%B0%E8%82%A1%E9%96%8B%E7%B4%85-%E5%A4%A7%E7%9B%A4%E5%B0%8F%E6%BC%B2-%E4%B8%AD%E5%B0%8F%E8%82%A1-%E9%87%91%E8%9E%8D%E6%8F%9A%E5%8D%87-%E5%8F%B0%E7%A9%8D%E9%9B%BB%E4%B9%8F%E5%8A%9B/ar-AA1BEXW3?ocid=finance-verthp-feeds" jslog="106424;ved:2ahUKEwj13oimtaeMAxWHBnsHHRPcMDYQuL8GegQIAhA3;track:click" rel="noopener noreferrer" target="_blank"&gt;&lt;div class="Tfehrf"&gt;&lt;div class="nkXTJ W8knGc" jsname="GvmPSb"&gt;&lt;div class="sfyJob"&gt;MSN&lt;/div&gt;&lt;div class="cCEUJe"&gt;&lt;div class="Adak"&gt;7 小時前&lt;/div&gt;&lt;div class="hVmHve" jsname="iwaAEc"&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class="Yfwt5"&gt;台股開紅》大盤小漲、中小股、金融揚升、 台積電乏力&lt;/div&gt;&lt;/div&gt;&lt;/a&gt;&lt;/div&gt;,
 &lt;div class="z4rs2b"&gt;&lt;a data-ved="2ahUKEwj13oimtaeMAxWHBnsHHRPcMDYQuL8GegQIAhA7" href="https://theinitium.com/opinion/20250326-taiwan-tsmc-us-strategy" jslog="106424;ved:2ahUKEwj13oimtaeMAxWHBnsHHRPcMDYQuL8GegQIAhA7;track:click" rel="noopener noreferrer" target="_blank"&gt;&lt;div class="Tfehrf"&gt;&lt;div class="nkXTJ W8knGc" jsname="GvmPSb"&gt;&lt;div class="sfyJob"&gt;端傳媒Initium Media&lt;/div&gt;&lt;div class="cCEUJe"&gt;&lt;div class="Adak"&gt;10 小時前&lt;/div&gt;&lt;div class="hVmHve" jsname="iwaAEc"&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class="Yfwt5"&gt;評論｜ 台積電千億赴美投資：技術外流隱憂與利益拉鋸下，台灣如何取得主動權？&lt;/div&gt;&lt;/div&gt;&lt;/a&gt;&lt;/div&gt;,
 &lt;div class="z4rs2b"&gt;&lt;a data-ved="2ahUKEwj13oimtaeMAxWHBnsHHRPcMDYQuL8GegQIAhA9" href="https://www.rti.org.tw/news/view/id/2243244" jslog="106424;ved:2ahUKEwj13oimtaeMAxWHBnsHHRPcMDYQuL8GegQIAhA9;track:click" rel="noopener noreferrer" target="_blank"&gt;&lt;div class="Tfehrf"&gt;&lt;div class="nkXTJ W8knGc" jsname="GvmPSb"&gt;&lt;div class="sfyJob"&gt;Rti 中央廣播電臺&lt;/div&gt;&lt;div class="cCEUJe"&gt;&lt;div class="Adak"&gt;5 小時前&lt;/div&gt;&lt;div class="hVmHve" jsname="iwaAEc"&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class="Yfwt5"&gt;台積電擴大在美投資千億美元彭金隆：看重訊才知道- 新聞&lt;/div&gt;&lt;/div&gt;&lt;/a&gt;&lt;/div&gt;]</code></pre>
</div>
</div>
</section>
<section id="即時股價爬取---取出需要的資料--3" class="slide level2">
<h2>即時股價爬取 - 取出需要的資料 -3</h2>
<ul>
<li><code>.get_text()</code>可抓取element內文字</li>
<li><code>.get("屬性名稱")</code>可抓取屬性內容</li>
</ul>
<div id="96d998d8" class="cell" data-execution_count="50">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb71-1"><a href=""></a><span class="bu">len</span>(news)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="147">
<pre><code>6</code></pre>
</div>
</div>
<div id="1e5720d5" class="cell" data-execution_count="51">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb73-1"><a href=""></a><span class="cf">for</span> title_click <span class="kw">in</span> news:</span>
<span id="cb73-2"><a href=""></a>  <span class="bu">print</span>(title_click.get_text())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>奇摩新聞2 小時前說出真相？金管會主委彭金隆：台積電赴美投資「我看重訊才知道」
聯合新聞網15 小時前「晶片戰爭」作者米勒：台積投資美 非凡成功
華冠投顧1 小時前台積電逼近1005元，3680家登率先發動
MSN7 小時前台股開紅》大盤小漲、中小股、金融揚升、 台積電乏力
端傳媒Initium Media10 小時前評論｜ 台積電千億赴美投資：技術外流隱憂與利益拉鋸下，台灣如何取得主動權？
Rti 中央廣播電臺5 小時前台積電擴大在美投資千億美元彭金隆：看重訊才知道- 新聞</code></pre>
</div>
</div>
</section>
<section id="hands-on-爬蟲練習" class="slide level2">
<h2>Hands-on 爬蟲練習</h2>
<ul>
<li><a href="https://www.ptt.cc/bbs/Tech_Job/index.html">Ptt Tech_Job 版</a></li>
<li>試著爬出所有<strong>標題</strong></li>
<li>爬出的第三個標題是？</li>
<li>提示：
<ul>
<li>下載html <code>requests.get(網址)</code></li>
<li>解析html <code>BeautifulSoup(下載網頁.text, "html.parser")</code><br>
</li>
<li>搜尋所需element <code>find(tag name)</code>, <code>select(css條件)</code></li>
<li>取出需要的資料 <code>get_text()</code>, <code>get(屬性名稱)</code></li>
</ul></li>
</ul>
</section>
<section id="即時股價爬取---取出需要的資料--4" class="slide level2">
<h2>即時股價爬取 - 取出需要的資料 -4</h2>
<ul>
<li><code>.get_text()</code>可抓取element內文字</li>
<li><code>.get("屬性名稱")</code>可抓取屬性內容</li>
</ul>
<div id="e47b5300" class="cell" data-execution_count="52">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb75-1"><a href=""></a><span class="cf">for</span> title_click <span class="kw">in</span> news:</span>
<span id="cb75-2"><a href=""></a>  <span class="bu">print</span>(title_click.find(<span class="st">"a"</span>).get(<span class="st">"href"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>https://tw.news.yahoo.com/%E8%AA%AA%E5%87%BA%E7%9C%9F%E7%9B%B8-%E9%87%91%E7%AE%A1%E6%9C%83%E4%B8%BB%E5%A7%94%E5%BD%AD%E9%87%91%E9%9A%86-%E5%8F%B0%E7%A9%8D%E9%9B%BB%E8%B5%B4%E7%BE%8E%E6%8A%95%E8%B3%87-%E6%88%91%E7%9C%8B%E9%87%8D%E8%A8%8A%E6%89%8D%E7%9F%A5%E9%81%93-063600663.html
https://udn.com/news/story/7240/8632099
https://www.hwa-guan.com.tw/Wealth/ViewPoint/ArticleContent?C_id=10714
https://www.msn.com/zh-tw/money/topstories/%E5%8F%B0%E8%82%A1%E9%96%8B%E7%B4%85-%E5%A4%A7%E7%9B%A4%E5%B0%8F%E6%BC%B2-%E4%B8%AD%E5%B0%8F%E8%82%A1-%E9%87%91%E8%9E%8D%E6%8F%9A%E5%8D%87-%E5%8F%B0%E7%A9%8D%E9%9B%BB%E4%B9%8F%E5%8A%9B/ar-AA1BEXW3?ocid=finance-verthp-feeds
https://theinitium.com/opinion/20250326-taiwan-tsmc-us-strategy
https://www.rti.org.tw/news/view/id/2243244</code></pre>
</div>
</div>
</section>
<section id="即時股價爬取---爬連結內的新聞" class="slide level2">
<h2>即時股價爬取 - 爬連結內的新聞</h2>
<ul>
<li>得到連結後，重複上述步驟
<ul>
<li>下載html <code>requests.get(網址)</code></li>
<li>解析html <code>BeautifulSoup(下載網頁.text, "html.parser")</code><br>
</li>
<li>搜尋所需element <code>find(tag名稱)</code>, <code>select(css條件)</code></li>
<li>取出需要的資料 <code>get_text()</code>, <code>get(屬性名稱)</code></li>
</ul></li>
</ul>
</section>
<section id="即時股價爬取---爬連結內的新聞-1" class="slide level2">
<h2>即時股價爬取 - 爬連結內的新聞</h2>
<p>首先取得連結list。</p>
<p>補充內容：</p>
<ul>
<li><code>sequence物件.append()</code>可新增內容至sequence中</li>
</ul>
<div id="5339bfec" class="cell" data-execution_count="53">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb77-1"><a href=""></a>url_list <span class="op">=</span> []</span>
<span id="cb77-2"><a href=""></a>title_list <span class="op">=</span> []</span>
<span id="cb77-3"><a href=""></a><span class="cf">for</span> title_click <span class="kw">in</span> news:</span>
<span id="cb77-4"><a href=""></a>  url_list.append(title_click.find(<span class="st">"a"</span>).get(<span class="st">"href"</span>))</span>
<span id="cb77-5"><a href=""></a>  title_list.append(title_click.get_text())</span>
<span id="cb77-6"><a href=""></a><span class="bu">print</span>(url_list)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>['https://tw.news.yahoo.com/%E8%AA%AA%E5%87%BA%E7%9C%9F%E7%9B%B8-%E9%87%91%E7%AE%A1%E6%9C%83%E4%B8%BB%E5%A7%94%E5%BD%AD%E9%87%91%E9%9A%86-%E5%8F%B0%E7%A9%8D%E9%9B%BB%E8%B5%B4%E7%BE%8E%E6%8A%95%E8%B3%87-%E6%88%91%E7%9C%8B%E9%87%8D%E8%A8%8A%E6%89%8D%E7%9F%A5%E9%81%93-063600663.html', 'https://udn.com/news/story/7240/8632099', 'https://www.hwa-guan.com.tw/Wealth/ViewPoint/ArticleContent?C_id=10714', 'https://www.msn.com/zh-tw/money/topstories/%E5%8F%B0%E8%82%A1%E9%96%8B%E7%B4%85-%E5%A4%A7%E7%9B%A4%E5%B0%8F%E6%BC%B2-%E4%B8%AD%E5%B0%8F%E8%82%A1-%E9%87%91%E8%9E%8D%E6%8F%9A%E5%8D%87-%E5%8F%B0%E7%A9%8D%E9%9B%BB%E4%B9%8F%E5%8A%9B/ar-AA1BEXW3?ocid=finance-verthp-feeds', 'https://theinitium.com/opinion/20250326-taiwan-tsmc-us-strategy', 'https://www.rti.org.tw/news/view/id/2243244']</code></pre>
</div>
</div>
</section>
<section id="即時股價爬取---爬連結內的新聞-2" class="slide level2">
<h2>即時股價爬取 - 爬連結內的新聞</h2>
<p>以第一個新聞連結為例，下載html後，重複步驟，取得本文</p>
<div id="c14c31e5" class="cell" data-execution_count="54">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb79-1"><a href=""></a>res <span class="op">=</span> requests.get(url_list[<span class="dv">1</span>])</span>
<span id="cb79-2"><a href=""></a>soup <span class="op">=</span> BeautifulSoup(res.text, <span class="st">"html.parser"</span>)</span>
<span id="cb79-3"><a href=""></a>news_full <span class="op">=</span> soup.select(<span class="st">"p"</span>)</span>
<span id="cb79-4"><a href=""></a>full_text <span class="op">=</span> <span class="st">""</span></span>
<span id="cb79-5"><a href=""></a><span class="cf">for</span> news_para <span class="kw">in</span> news_full:</span>
<span id="cb79-6"><a href=""></a>  full_text <span class="op">=</span> full_text <span class="op">+</span> news_para.get_text()</span>
<span id="cb79-7"><a href=""></a><span class="bu">print</span>(<span class="st">"標題: "</span><span class="op">+</span>title_list[<span class="dv">1</span>] <span class="op">+</span><span class="st">", 內文:"</span> <span class="op">+</span> full_text)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>標題: 聯合新聞網15 小時前「晶片戰爭」作者米勒：台積投資美 非凡成功, 內文:「晶片戰爭」作者米勒（Chris Miller）昨天表示，台積電董事長魏哲家在白宮宣布加碼投資美國一千億美元，可說是獲得「非凡的成功（extraordinary success）」，他認為台積電成功地與川普政府建立很好合作關係，不過是否能因此避開擾人的反壟斷問題，仍是未定之天，有待觀察。

米勒此行是應國科會轄下政策研究機構科技、民主與社會研究中心（ＤＳＥＴ）邀請來台，他在演說中回顧過去兩年全球科技戰進程，也探討美國川普新政下台美半導體合作的新方向。米勒昨天凌晨抵達台灣，經過忙碌的演講和拜會，今天將拜會台積電創辦人張忠謀，交換對地緣政治的看法。

現場與會者聚焦川普二點○台美關係如何維持、如何面對川普狂亂的節奏，但米勒認為，川普仍延續他在前一任未完成的事，只是由於川普沒有連任顧慮，因此出手又急又重。

針對台積電宣布在美國增加千億美元投資案，米勒說，這場記者會讓台積電取得川普總統的支持，川普稱讚台積電、稱讚它的技術，稱讚它的中心地位和美國的ＡＩ供應鏈，「我認為這些對於台積電來說都是勝利」。

米勒說：「我認為這對我們（指美國）來說是勝利，對台灣關係也是如此」。

米勒表示，希望台積電的投資聲明有助於穩定台積電與美國政府和雙邊關係，但他不認為這會消除川普政府針對雙邊關係所有其他問題採取行動的必要性。

他指出，在川普任期內，台灣的投資政策將面臨挑戰，仍會有業者因為政策因素到美國投資，川普政策對台灣的影響將出現在ＡＩ服務和供應鏈方面。

另外，因為中國大陸官方重金補助本土半導體成熟製程業者，讓美國在供應鏈安全上有挑戰，因此台灣的半導體以台積電為首，格外面臨競爭政策的挑戰，美國政策需要保障半導體的產能，提升自身供應鏈的安全，台灣與美國必須密切的合作。

針對川普的關稅政策，米勒指出，以政策連續性來看，川普在第一任期內對大陸商品加徵關稅，繼任的拜登政府將這些關稅提高了一倍甚至更多，他認為這是延續性的政策，即使川普政府目前出口管制方面還沒有新的動作，但可以預期下一步可能會更嚴格，而不是更寬鬆。
　訂閱《科技玩家》YouTube頻道！
💡 追新聞》》在Google News按下追蹤，科技玩家好文不漏接！
 📢 LINE開放多裝置登入！看「追加裝置」教學、規則 安卓蘋果可混搭
 📢 LINE免費貼圖4款！精品款推動物「動動貼圖」超Q、小惡鱷諧音哏滿滿
 📢 蘋果AI Siri延到2026…1舉動陷公關危機！他建議學賈伯斯解決範本
 📢 Skype五月說掰掰！轉移Microsoft Teams教學 「上班專用」可聊天建社群
 📢 3月便宜資費懶人包／5G上網吃到飽388！4G不限速500有找
 📢 旗艦AI洗地機開箱！輕鬆拖地、高溫洗布烘乾 還能遛狗甩尾

                    美國晶片大廠英特爾將於3月31日至4月1日舉辦Intel Vision活動，由新任執行長陳立武發表開幕演講，是他上任後首...                  
                    隨著AI技術的快速發展，全球資安環境面臨嚴峻威脅，各國政府與企業加快導入零信任架構、建立更完善的安全機制。根據美國網路安...                  
                    烏克蘭城市首長訪團一行36人來台，出席「2025 台北智慧城市展」，展現台烏友誼的深厚基礎與合作潛力。烏克蘭媒體「ICT...                  
                    緯創集團（3231）旗下雲端服務供應商緯謙科技26日宣布，與全球反洗錢系統品牌商Tookitaki建立夥伴結盟關係，雙方...                  
                    根據TrendForce最新調查，NAND Flash原廠自2024年第4季陸續減產，效應已逐步顯現。此外，消費性電子品...                  
                    倚天酷碁-創（2432）26日於2025台北國際自行車展發表多款全新電輔車與電動滑板車，透過數據驅動的智慧騎行與軟硬整合...                  </code></pre>
</div>
</div>
</section>
<section id="即時股價爬取---爬連結內的新聞-3" class="slide level2">
<h2>即時股價爬取 - 爬連結內的新聞</h2>
<p>用<code>for</code>迴圈一次做完所有連結，並轉成pandas data frame</p>
<div id="af767d7d" class="cell" data-execution_count="55">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb81-1"><a href=""></a>newdf <span class="op">=</span> []</span>
<span id="cb81-2"><a href=""></a><span class="cf">for</span> title_click <span class="kw">in</span> news:</span>
<span id="cb81-3"><a href=""></a>  title <span class="op">=</span> title_click.get_text()</span>
<span id="cb81-4"><a href=""></a>  url <span class="op">=</span> title_click.find(<span class="st">"a"</span>).get(<span class="st">"href"</span>)</span>
<span id="cb81-5"><a href=""></a>  res <span class="op">=</span> requests.get(url)</span>
<span id="cb81-6"><a href=""></a>  soup <span class="op">=</span> BeautifulSoup(res.text, <span class="st">"html.parser"</span>)</span>
<span id="cb81-7"><a href=""></a>  news_full <span class="op">=</span> soup.select(<span class="st">"p"</span>)</span>
<span id="cb81-8"><a href=""></a>  full_text <span class="op">=</span> <span class="st">""</span></span>
<span id="cb81-9"><a href=""></a>  <span class="cf">for</span> news_para <span class="kw">in</span> news_full:</span>
<span id="cb81-10"><a href=""></a>    full_text <span class="op">=</span> full_text <span class="op">+</span> news_para.get_text()</span>
<span id="cb81-11"><a href=""></a>  add_news <span class="op">=</span> pd.DataFrame({<span class="st">"title"</span>:[title],<span class="st">"content"</span>:[full_text]})</span>
<span id="cb81-12"><a href=""></a>  newdf.append(add_news)</span>
<span id="cb81-13"><a href=""></a></span>
<span id="cb81-14"><a href=""></a>newdf_pd<span class="op">=</span>pd.concat(newdf)</span>
<span id="cb81-15"><a href=""></a>newdf_pd</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="152">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe caption-top" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header" style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">title</th>
<th data-quarto-table-cell-role="th">content</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>奇摩新聞2 小時前說出真相？金管會主委彭金隆：台積電赴美投資「我看重訊才知道」</td>
<td>[FTNN新聞網]記者陳弘志／台北報導台積電宣布加碼投資美國1000億元，舉世矚目，到底有沒...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">0</td>
<td>聯合新聞網15 小時前「晶片戰爭」作者米勒：台積投資美 非凡成功</td>
<td>「晶片戰爭」作者米勒（Chris Miller）昨天表示，台積電董事長魏哲家在白宮宣布加碼投...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>華冠投顧1 小時前台積電逼近1005元，3680家登率先發動</td>
<td>\n台股本月份利空紛擾，台積電先是加碼1000億美元投資美國，而後又有路透報導台積電將與輝達...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">0</td>
<td>MSN7 小時前台股開紅》大盤小漲、中小股、金融揚升、 台積電乏力</td>
<td></td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>端傳媒Initium Media10 小時前評論｜ 台積電千億赴美投資：技術外流隱憂與利益拉...</td>
<td>\n\t\t\t何明彥 江旻諺 \t\t\n\t\t\t加州大學柏克萊分校商學與公共政策博...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">0</td>
<td>Rti 中央廣播電臺5 小時前台積電擴大在美投資千億美元彭金隆：看重訊才知道- 新聞</td>
<td>This website is using a security service to pr...</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="即時股價爬取---爬連結內的新聞-4" class="slide level2">
<h2>即時股價爬取 - 爬連結內的新聞</h2>
<div id="8caa291c" class="cell" data-execution_count="56">
<div class="cell-output cell-output-display" data-execution_count="153">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe caption-top" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header" style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">title</th>
<th data-quarto-table-cell-role="th">content</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>奇摩新聞2 小時前說出真相？金管會主委彭金隆：台積電赴美投資「我看重訊才知道」</td>
<td>[FTNN新聞網]記者陳弘志／台北報導台積電宣布加碼投資美國1000億元，舉世矚目，到底有沒...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">0</td>
<td>聯合新聞網15 小時前「晶片戰爭」作者米勒：台積投資美 非凡成功</td>
<td>「晶片戰爭」作者米勒（Chris Miller）昨天表示，台積電董事長魏哲家在白宮宣布加碼投...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>華冠投顧1 小時前台積電逼近1005元，3680家登率先發動</td>
<td>\n台股本月份利空紛擾，台積電先是加碼1000億美元投資美國，而後又有路透報導台積電將與輝達...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">0</td>
<td>MSN7 小時前台股開紅》大盤小漲、中小股、金融揚升、 台積電乏力</td>
<td></td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>端傳媒Initium Media10 小時前評論｜ 台積電千億赴美投資：技術外流隱憂與利益拉...</td>
<td>\n\t\t\t何明彥 江旻諺 \t\t\n\t\t\t加州大學柏克萊分校商學與公共政策博...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">0</td>
<td>Rti 中央廣播電臺5 小時前台積電擴大在美投資千億美元彭金隆：看重訊才知道- 新聞</td>
<td>This website is using a security service to pr...</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="hands-on-爬蟲練習-1" class="slide level2">
<h2>Hands-on 爬蟲練習</h2>
<ul>
<li><a href="https://www.ptt.cc/bbs/Tech_Job/index.html">Ptt Tech_Job 版</a></li>
<li>試著爬出<strong>最新的一頁</strong>、<strong>前一頁</strong>以及<strong>前前一頁</strong>的所有<strong>標題</strong>和<strong>內文網址</strong></li>
<li>總共爬出幾個標題？</li>
<li>提示：
<ul>
<li>下載html <code>requests.get(網址)</code></li>
<li>解析html <code>BeautifulSoup(下載網頁.text, "html.parser")</code><br>
</li>
<li>搜尋所需element <code>find(tag名稱)</code>, <code>select(css條件)</code></li>
<li>取出需要的資料 <code>get_text()</code>, <code>get(屬性名稱)</code></li>
</ul></li>
<li>一頁一頁爬 or for 迴圈都可以</li>
</ul>
</section>
<section id="網頁爬蟲-進階版" class="slide level2">
<h2>網頁爬蟲 進階版</h2>
<ul>
<li>滾動式等動態網頁網頁，如剛剛的新聞
<ul>
<li><a href="https://hackmd.io/@AndyChiang/DynamicCrawler">Python 進階爬蟲 by Andy Chiang</a></li>
</ul></li>
</ul>
</section>
<section id="網頁爬蟲-再想想" class="slide level2">
<h2>網頁爬蟲 再想想？</h2>
<ul>
<li>其實… 很多資料有其他存取方式，像API</li>
<li>隱私問題 （OkCupid事件）
<ul>
<li><a href="https://motherboard.vice.com/en_us/article/70000-okcupid-users-just-had-their-data-published">70,000 OkCupid Users Just Had Their Data Published</a></li>
</ul></li>
</ul>
</section>
<section id="網頁爬蟲-webscraping---recap" class="slide level2">
<h2>網頁爬蟲 Webscraping - Recap</h2>
<ul>
<li>下載html <code>requests.get(網址)</code></li>
<li>解析html <code>BeautifulSoup(下載網頁.text, "html.parser")</code></li>
<li>搜尋所需element <code>find(tag名稱)</code>, <code>select(css條件)</code></li>
<li>取出需要的資料 <code>get_text()</code>, <code>get(屬性名稱)</code></li>
</ul>
</section>
<section id="data-input-and-output-6" class="slide level2">
<h2>Data input and output</h2>
<ul>
<li>Data input
<ul>
<li>From file</li>
<li>From google drive</li>
<li>From API</li>
<li>From database</li>
<li>Webscrapping</li>
</ul></li>
<li><strong>Data output</strong></li>
</ul>
</section></section>
<section>
<section id="資料匯出" class="title-slide slide level1 center">
<h1>資料匯出</h1>

</section>
<section id="資料匯出-1" class="slide level2">
<h2>資料匯出</h2>
<ul>
<li>文字檔 .txt</li>
<li>CSV檔 .csv</li>
<li>json檔 .json</li>
<li>pickle檔 .pkl</li>
</ul>
</section>
<section id="資料匯出---文字檔-.txt" class="slide level2">
<h2>資料匯出 - 文字檔 .txt</h2>
<ul>
<li>首先使用<code>open(檔案名稱)</code>開啟檔案</li>
<li>使用<code>檔案.writelines(資料)</code>寫入內容</li>
<li><code>檔案.writelines(資料)</code>的資料可以是列表</li>
</ul>
<div id="1d53f754" class="cell" data-execution_count="57">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb82-1"><a href=""></a>path <span class="op">=</span> <span class="st">'output_writeline.txt'</span></span>
<span id="cb82-2"><a href=""></a>f <span class="op">=</span> <span class="bu">open</span>(path, <span class="st">'w'</span>)</span>
<span id="cb82-3"><a href=""></a>lines1 <span class="op">=</span> [<span class="st">'Hello World'</span>, <span class="st">'123'</span>, <span class="st">'456'</span>, <span class="st">'789'</span>]</span>
<span id="cb82-4"><a href=""></a>lines2 <span class="op">=</span> [<span class="st">'Hello World</span><span class="ch">\n</span><span class="st">'</span>, <span class="st">'123</span><span class="ch">\n</span><span class="st">'</span>, <span class="st">'456</span><span class="ch">\n</span><span class="st">'</span>, <span class="st">'789</span><span class="ch">\n</span><span class="st">'</span>]</span>
<span id="cb82-5"><a href=""></a>f.writelines(lines1)</span>
<span id="cb82-6"><a href=""></a>f.writelines(lines2)</span>
<span id="cb82-7"><a href=""></a>f.close()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="資料匯出---文字檔-.txt-1" class="slide level2">
<h2>資料匯出 - 文字檔 .txt</h2>
<ul>
<li>首先使用<code>open(檔案名稱)</code>開啟檔案</li>
<li>使用<code>檔案.write(資料)</code>寫入內容</li>
<li><code>檔案.write(資料)</code>的資料必須是文字</li>
</ul>
<div id="4c1307e2" class="cell" data-execution_count="58">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb83-1"><a href=""></a>path <span class="op">=</span> <span class="st">'output_write.txt'</span></span>
<span id="cb83-2"><a href=""></a>f <span class="op">=</span> <span class="bu">open</span>(path, <span class="st">'w'</span>)</span>
<span id="cb83-3"><a href=""></a><span class="cf">for</span> t <span class="kw">in</span> lines1:</span>
<span id="cb83-4"><a href=""></a>  f.write(t)</span>
<span id="cb83-5"><a href=""></a>  </span>
<span id="cb83-6"><a href=""></a><span class="cf">for</span> t <span class="kw">in</span> lines2:</span>
<span id="cb83-7"><a href=""></a>  f.write(t)</span>
<span id="cb83-8"><a href=""></a></span>
<span id="cb83-9"><a href=""></a>f.close()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="資料匯出---csv檔-.csv" class="slide level2">
<h2>資料匯出 - CSV檔 .csv</h2>
<p>使用<code>pandas</code> Data frame物件中的<code>.to_csv(檔名)</code>儲存檔案。</p>
<div id="95462b05" class="cell" data-execution_count="59">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb84-1"><a href=""></a>house.to_csv(<span class="st">"house.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="資料匯出---json檔-.json" class="slide level2">
<h2>資料匯出 - json檔 .json</h2>
<p>使用<code>pandas</code> Data frame物件中的<code>.to_json(檔名)</code>儲存檔案。</p>
<p>DataFrame中一定要有index</p>
<div id="e3bc1e9a" class="cell" data-execution_count="60">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb85-1"><a href=""></a>house.to_json(<span class="st">"house.json"</span>)</span>
<span id="cb85-2"><a href=""></a>house</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="157">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe caption-top" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header" style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">鄉鎮市區</th>
<th data-quarto-table-cell-role="th">交易標的</th>
<th data-quarto-table-cell-role="th">土地位置建物門牌</th>
<th data-quarto-table-cell-role="th">土地移轉總面積平方公尺</th>
<th data-quarto-table-cell-role="th">都市土地使用分區</th>
<th data-quarto-table-cell-role="th">非都市土地使用分區</th>
<th data-quarto-table-cell-role="th">非都市土地使用編定</th>
<th data-quarto-table-cell-role="th">交易年月日</th>
<th data-quarto-table-cell-role="th">交易筆棟數</th>
<th data-quarto-table-cell-role="th">移轉層次</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">總價元</th>
<th data-quarto-table-cell-role="th">單價元平方公尺</th>
<th data-quarto-table-cell-role="th">車位類別</th>
<th data-quarto-table-cell-role="th">車位移轉總面積平方公尺</th>
<th data-quarto-table-cell-role="th">車位總價元</th>
<th data-quarto-table-cell-role="th">備註</th>
<th data-quarto-table-cell-role="th">主建物面積</th>
<th data-quarto-table-cell-role="th">附屬建物面積</th>
<th data-quarto-table-cell-role="th">陽台面積</th>
<th data-quarto-table-cell-role="th">電梯</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>新竹市</td>
<td>土地</td>
<td>明湖段840地號</td>
<td>18.74</td>
<td>NaN</td>
<td>山坡地保育區</td>
<td>農牧用地</td>
<td>1121101</td>
<td>土地1建物0車位0</td>
<td>NaN</td>
<td>...</td>
<td>150000</td>
<td>8004.0</td>
<td>NaN</td>
<td>0.00</td>
<td>0</td>
<td>NaN</td>
<td>0.00</td>
<td>0.00</td>
<td>0.00</td>
<td>無</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>新竹市</td>
<td>土地</td>
<td>新莊段198地號</td>
<td>42.95</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>1121101</td>
<td>土地12建物0車位0</td>
<td>NaN</td>
<td>...</td>
<td>4576000</td>
<td>106542.0</td>
<td>NaN</td>
<td>0.00</td>
<td>0</td>
<td>親友、員工、共有人或其他特殊關係間之交易；</td>
<td>0.00</td>
<td>0.00</td>
<td>0.00</td>
<td>無</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>新竹市</td>
<td>房地(土地+建物)</td>
<td>新竹市新竹市光華街９５巷３號５樓之３</td>
<td>6.72</td>
<td>住</td>
<td>NaN</td>
<td>NaN</td>
<td>1121101</td>
<td>土地1建物1車位0</td>
<td>五層</td>
<td>...</td>
<td>3630000</td>
<td>81665.0</td>
<td>NaN</td>
<td>0.00</td>
<td>0</td>
<td>NaN</td>
<td>31.62</td>
<td>0.00</td>
<td>3.74</td>
<td>有</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>新竹市</td>
<td>土地</td>
<td>南門段四小段177-25地號</td>
<td>29.67</td>
<td>都市：其他:道路用地</td>
<td>NaN</td>
<td>NaN</td>
<td>1121103</td>
<td>土地1建物0車位0</td>
<td>NaN</td>
<td>...</td>
<td>1316221</td>
<td>44362.0</td>
<td>NaN</td>
<td>0.00</td>
<td>0</td>
<td>包含公共設施保留地用地；</td>
<td>0.00</td>
<td>0.00</td>
<td>0.00</td>
<td>無</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>新竹市</td>
<td>土地</td>
<td>東山段一小段189-11地號</td>
<td>357.38</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>1121107</td>
<td>土地1建物0車位0</td>
<td>NaN</td>
<td>...</td>
<td>5038989</td>
<td>14100.0</td>
<td>NaN</td>
<td>0.00</td>
<td>0</td>
<td>協議價購；</td>
<td>0.00</td>
<td>0.00</td>
<td>0.00</td>
<td>無</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2864</td>
<td>新竹市</td>
<td>房地(土地+建物)+車位</td>
<td>新竹市新竹市埔頂三路３２號十八樓之９</td>
<td>6.53</td>
<td>商</td>
<td>NaN</td>
<td>NaN</td>
<td>1080326</td>
<td>土地1建物1車位1</td>
<td>十八層</td>
<td>...</td>
<td>7360000</td>
<td>77553.0</td>
<td>坡道平面</td>
<td>28.88</td>
<td>1200000</td>
<td>預售屋、或土地及建物分件登記案件；</td>
<td>45.68</td>
<td>1.78</td>
<td>4.48</td>
<td>有</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2865</td>
<td>新竹市</td>
<td>房地(土地+建物)+車位</td>
<td>新竹市新竹市埔頂三路３６號二十八樓之１０</td>
<td>6.44</td>
<td>商</td>
<td>NaN</td>
<td>NaN</td>
<td>1080324</td>
<td>土地1建物1車位1</td>
<td>二十八層</td>
<td>...</td>
<td>6980000</td>
<td>75472.0</td>
<td>坡道平面</td>
<td>24.86</td>
<td>1100000</td>
<td>預售屋權利轉售，讓渡日期:110年05月13日，權利買賣契約成交價格980萬元。預售屋、或土...</td>
<td>44.84</td>
<td>1.78</td>
<td>4.33</td>
<td>有</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2866</td>
<td>新竹市</td>
<td>房地(土地+建物)+車位</td>
<td>新竹市新竹市埔頂三路２號</td>
<td>20.23</td>
<td>商</td>
<td>NaN</td>
<td>NaN</td>
<td>1080317</td>
<td>土地1建物1車位2</td>
<td>一層，二層</td>
<td>...</td>
<td>55280000</td>
<td>222072.0</td>
<td>坡道平面</td>
<td>57.76</td>
<td>2700000</td>
<td>預售屋權利轉讓，讓渡日期：108年07月13日，權利買賣契約成交價 5880 萬元。預售屋、...</td>
<td>170.24</td>
<td>0.00</td>
<td>0.00</td>
<td>有</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2867</td>
<td>新竹市</td>
<td>房地(土地+建物)+車位</td>
<td>新竹市新竹市埔頂三路６６號</td>
<td>19.96</td>
<td>商</td>
<td>NaN</td>
<td>NaN</td>
<td>1080317</td>
<td>土地1建物1車位2</td>
<td>一層，二層</td>
<td>...</td>
<td>52180000</td>
<td>212854.0</td>
<td>坡道平面</td>
<td>57.76</td>
<td>2700000</td>
<td>預售屋、或土地及建物分件登記案件；</td>
<td>167.16</td>
<td>0.00</td>
<td>0.00</td>
<td>有</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2868</td>
<td>新竹市</td>
<td>房地(土地+建物)+車位</td>
<td>新竹市新竹市埔頂三路６８號</td>
<td>20.23</td>
<td>商</td>
<td>NaN</td>
<td>NaN</td>
<td>1080324</td>
<td>土地1建物1車位2</td>
<td>一層，二層</td>
<td>...</td>
<td>53280000</td>
<td>213625.0</td>
<td>坡道平面</td>
<td>57.76</td>
<td>2700000</td>
<td>預售屋、或土地及建物分件登記案件；</td>
<td>170.24</td>
<td>0.00</td>
<td>0.00</td>
<td>有</td>
</tr>
</tbody>
</table>

<p>2869 rows × 31 columns</p>
</div>
</div>
</div>
</section>
<section id="資料匯出---pickle檔-.pkl" class="slide level2">
<h2>資料匯出 - pickle檔 .pkl</h2>
<ul>
<li>python專用，可儲存 python 的工作階段與變數</li>
<li>常用functions
<ul>
<li><code>dumps</code>, <code>dump</code>:儲存</li>
<li><code>loads</code>, <code>load</code>:讀取</li>
</ul></li>
</ul>
<div id="54f77be6" class="cell" data-execution_count="61">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb86-1"><a href=""></a><span class="cf">with</span> <span class="bu">open</span>(<span class="st">"house.pkl"</span>, <span class="st">"wb"</span>) <span class="im">as</span> <span class="bu">file</span>:</span>
<span id="cb86-2"><a href=""></a>    pickle.dump(house, <span class="bu">file</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="hands-on-資料匯出" class="slide level2">
<h2>Hands-on 資料匯出</h2>
<ul>
<li><a href="https://www.ptt.cc/bbs/Tech_Job/index.html">Ptt Tech_Job 版</a></li>
<li>試著爬出最新一頁的所有<strong>標題</strong> (Hint!)</li>
<li>將標題存成一個資料框</li>
<li>儲存標題資料框，檔名為ptt.csv</li>
</ul>
</section>
<section id="hands-on-資料匯出-1" class="slide level2">
<h2>Hands-on 資料匯出</h2>
<div id="653b9685" class="cell" data-execution_count="62">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb87-1"><a href=""></a><span class="im">from</span> bs4 <span class="im">import</span> BeautifulSoup</span>
<span id="cb87-2"><a href=""></a><span class="im">import</span> requests</span>
<span id="cb87-3"><a href=""></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb87-4"><a href=""></a><span class="co"># step 1 download url</span></span>
<span id="cb87-5"><a href=""></a>res <span class="op">=</span> requests.get(<span class="st">"https://www.ptt.cc/bbs/Tech_Job/index.html"</span>)</span>
<span id="cb87-6"><a href=""></a><span class="co"># step 2 parse html</span></span>
<span id="cb87-7"><a href=""></a>soup <span class="op">=</span> BeautifulSoup(res.text, <span class="st">"html.parser"</span>)</span>
<span id="cb87-8"><a href=""></a><span class="co"># step 3 select tags/css</span></span>
<span id="cb87-9"><a href=""></a>title_tags <span class="op">=</span> soup.select(<span class="st">".title a"</span>)</span>
<span id="cb87-10"><a href=""></a><span class="bu">print</span>(title_tags)</span>
<span id="cb87-11"><a href=""></a><span class="co"># step 4 get the data</span></span>
<span id="cb87-12"><a href=""></a>title_list<span class="op">=</span>[] </span>
<span id="cb87-13"><a href=""></a><span class="cf">for</span> title <span class="kw">in</span> title_tags:</span>
<span id="cb87-14"><a href=""></a>  title_list.append(title.get_text())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[&lt;a href="/bbs/Tech_Job/M.1742811719.A.856.html"&gt;[請益] 請問金士頓助工設備好嗎&lt;/a&gt;, &lt;a href="/bbs/Tech_Job/M.1742811844.A.CC0.html"&gt;[討論] 黃仁勳、蔡力行同框吃熱狗捲，有淵源？&lt;/a&gt;, &lt;a href="/bbs/Tech_Job/M.1742825362.A.5F4.html"&gt;[請益] 頂正科技&lt;/a&gt;, &lt;a href="/bbs/Tech_Job/M.1742835778.A.B04.html"&gt;[新聞] 軟體工程師「薪資結構」大揭密！美國、英&lt;/a&gt;, &lt;a href="/bbs/Tech_Job/M.1742864084.A.C92.html"&gt;[新聞] 超微進駐台南 黃偉哲：AI里程碑&lt;/a&gt;, &lt;a href="/bbs/Tech_Job/M.1742876683.A.737.html"&gt;[討論] 台達電的爆料文又消失了&lt;/a&gt;, &lt;a href="/bbs/Tech_Job/M.1742881206.A.46D.html"&gt;[討論] 台達 群聯 東京威力 都安全下莊了？&lt;/a&gt;, &lt;a href="/bbs/Tech_Job/M.1742893069.A.5B3.html"&gt;[新聞] 離開英特爾三個多月　季辛格找到工作了&lt;/a&gt;, &lt;a href="/bbs/Tech_Job/M.1742899078.A.8A8.html"&gt;小組:立意良善,口頭警告&amp;gt;[討論]joh版主竄改推文數(推/噓)進度&lt;/a&gt;, &lt;a href="/bbs/Tech_Job/M.1742899789.A.1BB.html"&gt;[請益] 竹南通勤竹科上班&lt;/a&gt;, &lt;a href="/bbs/Tech_Job/M.1742902244.A.089.html"&gt;[板務] 給立意良善的joh板主&lt;/a&gt;, &lt;a href="/bbs/Tech_Job/M.1742903028.A.1F3.html"&gt;[新聞] 印度伺服器呆帳 華碩：客戶積欠的貨款已&lt;/a&gt;, &lt;a href="/bbs/Tech_Job/M.1742905521.A.89E.html"&gt;[請益] 請教短網址圖片中線的接頭是什麼&lt;/a&gt;, &lt;a href="/bbs/Tech_Job/M.1742910587.A.F3A.html"&gt;[請益] 面試 請益_台亞半導體&lt;/a&gt;, &lt;a href="/bbs/Tech_Job/M.1742913877.A.8FA.html"&gt;[轉錄] 科技廠不能帶手機真的超不方便&lt;/a&gt;, &lt;a href="/bbs/Tech_Job/M.1742919190.A.9CC.html"&gt;[討論] 轉dcard ic廠何時結構調薪&lt;/a&gt;, &lt;a href="/bbs/Tech_Job/M.1742968954.A.C0D.html"&gt;[請益] 求umc南部內推&lt;/a&gt;, &lt;a href="/bbs/Tech_Job/M.1742980586.A.95C.html"&gt;[新聞] 印度認定三星「故意逃稅」，下令補繳近20&lt;/a&gt;, &lt;a href="/bbs/Tech_Job/M.1393646135.A.A28.html"&gt;[公告] Tech_Job板板規 2022.05.26更新&lt;/a&gt;, &lt;a href="/bbs/Tech_Job/M.1410062073.A.1B6.html"&gt;[公告] 置底 檢舉/推薦 文章&lt;/a&gt;, &lt;a href="/bbs/Tech_Job/M.1425268790.A.15E.html"&gt;[公告] 如何消除退文 轉自Ask板&lt;/a&gt;, &lt;a href="/bbs/Tech_Job/M.1585618843.A.D43.html"&gt;[情報] 薪資查詢平台&lt;/a&gt;, &lt;a href="/bbs/Tech_Job/M.1653574616.A.A15.html"&gt;[公告] 板規十五 offer請益文 m文解除申請&lt;/a&gt;]</code></pre>
</div>
</div>
</section>
<section id="資料匯出---recap" class="slide level2">
<h2>資料匯出 - Recap</h2>
<ul>
<li>文字檔 .txt <code>writelines(內容)</code></li>
<li>CSV檔 .csv <code>pandas_df.to_csv(檔名)</code></li>
<li>json檔 .json <code>pandas_df.to_json(檔名)</code></li>
</ul>
</section>
<section id="references" class="slide level2">
<h2>References</h2>
<ul>
<li><a href="https://www.py4e.com/">Python for Everybody</a>
<ul>
<li>Some contents are from Python for Everybody, and these contents are Copyright 2010- Charles R. Severance (www.dr-chuck.com) of the University of Michigan School of Information and open.umich.edu and made available under a Creative Commons Attribution 4.0 License.</li>
</ul></li>
<li><a href="https://jakevdp.github.io/PythonDataScienceHandbook/">Python Data Science Handbook</a></li>
</ul>
</section></section>
<section id="questions" class="title-slide slide level1 center">
<h1>Questions?</h1>
<div class="quarto-auto-generated-content">
<div class="footer footer-default">

</div>
</div>
</section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="4_DataIO_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="4_DataIO_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="4_DataIO_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="4_DataIO_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="4_DataIO_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="4_DataIO_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="4_DataIO_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="4_DataIO_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="4_DataIO_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="4_DataIO_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const onCopySuccess = function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      }
      const getTextToCopy = function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
        text: getTextToCopy
      });
      clipboard.on('success', onCopySuccess);
      if (window.document.getElementById('quarto-embedded-source-code-modal')) {
        // For code content inside modals, clipBoardJS needs to be initialized with a container option
        // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
        const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
          text: getTextToCopy,
          container: window.document.getElementById('quarto-embedded-source-code-modal')
        });
        clipboardModal.on('success', onCopySuccess);
      }
        var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
        var mailtoRegex = new RegExp(/^mailto:/);
          var filterRegex = new RegExp('/' + window.location.host + '/');
        var isInternal = (href) => {
            return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
        }
        // Inspect non-navigation links and adorn them if external
     	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
        for (var i=0; i<links.length; i++) {
          const link = links[i];
          if (!isInternal(link.href)) {
            // undo the damage that might have been done by quarto-nav.js in the case of
            // links that we want to consider external
            if (link.dataset.originalHref !== undefined) {
              link.href = link.dataset.originalHref;
            }
          }
        }
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note) {
            return note.innerHTML;
          } else {
            return "";
          }
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>